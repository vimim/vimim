<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>vimim.vim</title>
<meta name="Generator" content="Vim/7.2" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<style type="text/css">
<!--
.Error { color: #ffffff; background-color: #ff6060; font-weight: bold; }
.Type { color: #00ff00; }
.Special { color: #ff40ff; }
.PreProc { color: #ff40ff; }
.Folded { color: #8080ff; background-color: #ffffff; }
.Statement { color: #ffff00; }
.Identifier { color: #00ffff; }
.Comment { color: #8080ff; }
.Constant { color: #ff6060; }
pre { font-family: monospace; color: #000000; background-color: #ffffff; }
body { font-family: monospace; color: #000000; background-color: #ffffff; }
.lnr { color: #ffff00; }
.FoldColumn { color: #8080ff; background-color: #ffffff; }
.FoldColumn { text-decoration: none; }

.open-fold   .Folded      { display: none; }
.open-fold   .fulltext      { display: inline; }
.open-fold   .toggle-open   { display: none; }
.closed-fold .toggle-closed { display: inline; }

.closed-fold .fulltext      { display: none; }
.closed-fold .Folded      { display: inline; }
.closed-fold .toggle-open   { display: inline; }
.closed-fold .toggle-closed { display: none; }
-->
</style>

<script type='text/javascript'>
<!--
function toggleFold(objID)
{
  var fold;
  fold = document.getElementById(objID);
  if(fold.className == 'closed-fold')
  {
    fold.className = 'open-fold';
  }
  else if (fold.className == 'open-fold')
  {
    fold.className = 'closed-fold';
  }
}
-->
</script>
</head>
<body>
<pre>
<span class="FoldColumn">  </span><span class="lnr">   1 </span><span class="Comment">&quot; ==================================================</span>
<span class="FoldColumn">  </span><span class="lnr">   2 </span><span class="Comment">&quot;              </span><span class="Constant">&quot; VimIM —— Vim 中文输入法 &quot;</span>
<span class="FoldColumn">  </span><span class="lnr">   3 </span><span class="Comment">&quot; --------------------------------------------------</span>
<span class="FoldColumn">  </span><span class="lnr">   4 </span><span class="Comment">&quot;  VimIM -- Input Method by Vim, of Vim, for Vimmers</span>
<span class="FoldColumn">  </span><span class="lnr">   5 </span><span class="Comment">&quot; ==================================================</span>
<span class="FoldColumn">  </span><span class="lnr">   6 </span>
<span class="FoldColumn">  </span><span class="lnr">   7 </span><span class="Comment">&quot;</span> <span class="PreProc">URL:</span><span class="Comment">   <a href="http://vim.sourceforge.net/scripts/script.php?script_id=2506">http://vim.sourceforge.net/scripts/script.php?script_id=2506</a></span>
<span class="FoldColumn">  </span><span class="lnr">   8 </span><span class="Comment">&quot;</span> <span class="PreProc">Group:</span><span class="Comment"> <a href="http://groups.google.com/group/vimim">http://groups.google.com/group/vimim</a></span>
<span class="FoldColumn">  </span><span class="lnr">   9 </span><span class="Comment">&quot;</span> <span class="PreProc">Data:</span><span class="Comment">  <a href="http://code.google.com/p/vimim/downloads/list">http://code.google.com/p/vimim/downloads/list</a></span>
<span class="FoldColumn">  </span><span class="lnr">  10 </span><span class="Comment">&quot;</span> <span class="PreProc">Demo:</span><span class="Comment">  <a href="http://maxiangjiang.googlepages.com/vimim.html">http://maxiangjiang.googlepages.com/vimim.html</a></span>
<span class="FoldColumn">  </span><span class="lnr">  11 </span>
<span id='fold1' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold1")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold1")'>- </a><span class="Folded">  12 +-- 57 lines: ====  VimIM Introduction    ====
</span><span class='fulltext'><span class="lnr">  12 </span><span class="Comment">&quot; ====  VimIM Introduction    ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  13 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  14 </span><span class="Comment">&quot;</span>      <span class="PreProc">File:</span><span class="Comment"> vimim.vim</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  15 </span><span class="Comment">&quot;</span>    <span class="PreProc">Author:</span><span class="Comment"> vimim &lt;vimim@googlegroups.com&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  16 </span><span class="Comment">&quot;</span>   <span class="PreProc">License:</span><span class="Comment"> GNU Lesser General Public License</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  17 </span><span class="Comment">&quot;</span>    <span class="PreProc">Latest:</span><span class="Comment"> 20091117</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  18 </span><span class="Comment">&quot; -----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  19 </span><span class="Comment">&quot;</span>    <span class="PreProc">Readme:</span><span class="Comment"> VimIM is a Vim plugin designed as an independent IM</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  20 </span><span class="Comment">&quot;            (Input Method) to support the input of multi-byte.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  21 </span><span class="Comment">&quot;            It can be used as yet another way to input non-ascii</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  22 </span><span class="Comment">&quot;            using OneKey in addition to built-in i_&lt;C-V&gt; and i_&lt;C-K&gt;.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  23 </span><span class="Comment">&quot;            VimIM aims to complete the Vim as the greatest editor.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  24 </span><span class="Comment">&quot; -----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  25 </span><span class="Comment">&quot;</span>  <span class="PreProc">Features:</span><span class="Comment"> * </span><span class="Constant">&quot;Plug &amp; Play&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  26 </span><span class="Comment">&quot;            * It can be used as yet another way to input Unicode.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  27 </span><span class="Comment">&quot;            * It is independent of the Operating System.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  28 </span><span class="Comment">&quot;            * It is independent of Vim mbyte-XIM/mbyte-IME API.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  29 </span><span class="Comment">&quot;            * The </span><span class="Constant">&quot;OneKey&quot;</span><span class="Comment"> can input Chinese without mode change.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  30 </span><span class="Comment">&quot;            * The </span><span class="Constant">&quot;static&quot;</span><span class="Comment">  Chinese Input Mode smooths mixture input.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  31 </span><span class="Comment">&quot;            * The </span><span class="Constant">&quot;dynamic&quot;</span><span class="Comment"> Chinese Input Mode uses sexy input style.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  32 </span><span class="Comment">&quot;            * Support </span><span class="Constant">&quot;modeless&quot;</span><span class="Comment"> whole sentence input</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  33 </span><span class="Comment">&quot;            * Support </span><span class="Constant">&quot;Cloud Input&quot;</span><span class="Comment"> through Sougou Cloud Pinyin</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  34 </span><span class="Comment">&quot;            * Support </span><span class="Constant">&quot;Pin Yin&quot;</span><span class="Comment">, </span><span class="Constant">&quot;Wu Bi&quot;</span><span class="Comment">, </span><span class="Constant">&quot;Cang Jie&quot;</span><span class="Comment">, </span><span class="Constant">&quot;4Corner&quot;</span><span class="Comment">, etc</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  35 </span><span class="Comment">&quot;            * Support 5 different ways of doing accurate ShuangPin</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  36 </span><span class="Comment">&quot;            * Support all those Input Methods with one-to-many mapping</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  37 </span><span class="Comment">&quot;            * Support </span><span class="Constant">&quot;multi-byte search&quot;</span><span class="Comment"> using search key '/' or '?'.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  38 </span><span class="Comment">&quot;            * Support </span><span class="Constant">&quot;fuzzy search&quot;</span><span class="Comment"> and </span><span class="Constant">&quot;wildcard search&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  39 </span><span class="Comment">&quot;            * Support popup menu navigation using </span><span class="Constant">&quot;vi key&quot;</span><span class="Comment"> (hjkl)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  40 </span><span class="Comment">&quot;            * Support word matching on </span><span class="Constant">&quot;word segmentation&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  41 </span><span class="Comment">&quot;            * Support dynamical lookup of keycode and unicode</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  42 </span><span class="Comment">&quot;            * Support direct </span><span class="Constant">&quot;unicode input&quot;</span><span class="Comment"> using integer or hex</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  43 </span><span class="Comment">&quot;            * Support direct </span><span class="Constant">&quot;GBK input&quot;</span><span class="Comment"> and </span><span class="Constant">&quot;Big5 input&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  44 </span><span class="Comment">&quot;            * Support </span><span class="Constant">&quot;non-stop-typing&quot;</span><span class="Comment"> for Wubi</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  45 </span><span class="Comment">&quot;            * Support </span><span class="Constant">&quot;non-stop-typing&quot;</span><span class="Comment"> for 4Corner and Telegraph Code</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  46 </span><span class="Comment">&quot;            * Support dynamical creation and update of new entries</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  47 </span><span class="Comment">&quot;            * Support dynamical adjust menu order over usage frequency</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  48 </span><span class="Comment">&quot;            * Support auto processing a private datafile, if existed</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  49 </span><span class="Comment">&quot;            * Support intelligent editing keys (CTRL-H, BS, Enter)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  50 </span><span class="Comment">&quot;            * Support </span><span class="Constant">&quot;do it yourself&quot;</span><span class="Comment"> input method defined by users</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  51 </span><span class="Comment">&quot;            * Support Plug &amp; Play </span><span class="Constant">&quot;couple IM&quot;</span><span class="Comment"> using Pinyin and 4Corner</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  52 </span><span class="Comment">&quot;            * Support open, simple and flexible datafile format</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  53 </span><span class="Comment">&quot; -----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  54 </span><span class="Comment">&quot;</span>   <span class="PreProc">Install:</span><span class="Comment"> (1) download a datafile of your choice from Data link above</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  55 </span><span class="Comment">&quot;            (2) drop vimim.vim and the datafile to the plugin directory</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  56 </span><span class="Comment">&quot; -----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  57 </span><span class="Comment">&quot;</span> <span class="PreProc">EasterEgg:</span><span class="Comment"> (in Vim Insert Mode, type 4 chars:) vim&lt;C-\&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  58 </span><span class="Comment">&quot; -----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  59 </span><span class="Comment">&quot; Usage (1): [in Insert Mode] </span><span class="Constant">&quot;to insert/search Chinese ad hoc&quot;</span><span class="Comment">:</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  60 </span><span class="Comment">&quot;            # to insert: type keycode and hit &lt;C-\&gt; to trigger</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  61 </span><span class="Comment">&quot;            # to search: hit '/' or '?' from popup menu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  62 </span><span class="Comment">&quot; -----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  63 </span><span class="Comment">&quot; Usage (2): [in Insert Mode] </span><span class="Constant">&quot;to type Chinese continuously&quot;</span><span class="Comment">:</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  64 </span><span class="Comment">&quot;            # hit &lt;C-^&gt; to toggle to Chinese Input Mode:</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  65 </span><span class="Comment">&quot;            # just type any valid keycode and enjoy</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  66 </span><span class="Comment">&quot; -----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  67 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold1")'>| </a><span class="lnr">  68 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold2' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold2")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold2")'>- </a><span class="Folded">  69 +-- 48 lines: ====  VimIM Instruction     ====
</span><span class='fulltext'><span class="lnr">  69 </span><span class="Comment">&quot; ====  VimIM Instruction     ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  70 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  71 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  72 </span><span class="Comment">&quot; -------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  73 </span><span class="Comment">&quot; </span><span class="Constant">&quot;Design Goal&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  74 </span><span class="Comment">&quot; -------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  75 </span><span class="Comment">&quot; # Chinese can be input using Vim regardless of encoding</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  76 </span><span class="Comment">&quot; # Without negative impact to Vim when VimIM is not used</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  77 </span><span class="Comment">&quot; # No compromise for high speed and low memory usage</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  78 </span><span class="Comment">&quot; # Making the best use of Vim for popular input methods</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  79 </span><span class="Comment">&quot; # Most VimIM options are activated based on input methods</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  80 </span><span class="Comment">&quot; # All  VimIM options can be explicitly disabled at will</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  81 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  82 </span><span class="Comment">&quot; ---------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  83 </span><span class="Comment">&quot; </span><span class="Constant">&quot;VimIM Options&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  84 </span><span class="Comment">&quot; ---------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  85 </span><span class="Comment">&quot; Comprehensive usages of all options are from Demo URL above</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  86 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  87 </span><span class="Comment">&quot;   VimIM </span><span class="Constant">&quot;OneKey&quot;</span><span class="Comment">, without mode change</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  88 </span><span class="Comment">&quot;    - use OneKey to insert multi-byte candidates</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  89 </span><span class="Comment">&quot;    - use OneKey to search multi-byte using </span><span class="Constant">&quot;/&quot;</span><span class="Comment"> or </span><span class="Constant">&quot;?&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  90 </span><span class="Comment">&quot;    - use OneKey to insert Unicode/GBK/Big5, integer or hex</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  91 </span><span class="Comment">&quot;    - use OneKey to input Chinese sentence as we do for English</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  92 </span><span class="Comment">&quot;   The default key is &lt;C-\&gt; (Vim Insert Mode)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  93 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  94 </span><span class="Comment">&quot;   VimIM </span><span class="Constant">&quot;Chinese Input Mode&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  95 </span><span class="Comment">&quot;   - [dynamic mode] show dynamic menu as one types</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  96 </span><span class="Comment">&quot;   - [static mode] &lt;Space&gt; =&gt; Chinese  &lt;Enter&gt; =&gt; English</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  97 </span><span class="Comment">&quot;   - &lt;Esc&gt; key is in consistence with Vim</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  98 </span><span class="Comment">&quot;   The default key is &lt;C-^&gt; (Vim Insert Mode)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr">  99 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 100 </span><span class="Comment">&quot; ----------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 101 </span><span class="Comment">&quot; </span><span class="Constant">&quot;VimIM Datafile&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 102 </span><span class="Comment">&quot; ----------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 103 </span><span class="Comment">&quot; The datafile is assumed to be in order, otherwise, it is auto sorted.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 104 </span><span class="Comment">&quot; The basic datafile format is simple and flexible:</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 105 </span><span class="Comment">&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 106 </span><span class="Comment">&quot;     +------+--+-------+</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 107 </span><span class="Comment">&quot;     |&lt;key&gt; |  |&lt;value&gt;|</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 108 </span><span class="Comment">&quot;     |======|==|=======|</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 109 </span><span class="Comment">&quot;     | mali |  |  馬力 |</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 110 </span><span class="Comment">&quot;     +------+--+-------+</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 111 </span><span class="Comment">&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 112 </span><span class="Comment">&quot; The &lt;key&gt; is what is typed in alphabet, ready to be replaced.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 113 </span><span class="Comment">&quot; The &lt;value&gt;, separated by spaces, is what will be inserted.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 114 </span><span class="Comment">&quot; The 2nd and the 3rd column can be repeated without restriction.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 115 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold2")'>| </a><span class="lnr"> 116 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold3' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold3")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold3")'>- </a><span class="Folded"> 117 +--346 lines: ====  VimIM Initialization  ====
</span><span class='fulltext'><span class="lnr"> 117 </span><span class="Comment">&quot; ====  VimIM Initialization  ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 118 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 119 </span><span class="Statement">if</span> <span class="Identifier">exists</span><span class="Statement">(</span><span class="Constant">&quot;b:loaded_vimim&quot;</span><span class="Statement">)</span><span class=""> </span><span class="Statement">||</span><span class=""> &amp;</span><span class="Statement">cp</span><span class=""> </span><span class="Statement">||</span><span class=""> </span>v:version<span class=""> </span><span class="Statement">&lt;</span><span class=""> </span><span class="Constant">700</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 120 </span>    <span class="Statement">finish</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 121 </span><span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 122 </span><span class="Statement">let</span> b:loaded_vimim<span class="Statement">=</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 123 </span><span class="Statement">let</span> s:path<span class="Statement">=</span><span class="Identifier">expand</span><span class="Statement">(</span><span class="Constant">&quot;&lt;sfile&gt;:p:h&quot;</span><span class="Statement">).</span><span class="Constant">&quot;/&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 124 </span><span class="Statement">scriptencoding</span> utf<span class="Statement">-</span><span class="Constant">8</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 125 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 126 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 127 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialization</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 128 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 129 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_global<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 130 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_settings<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 131 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_session<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 132 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_debug<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 133 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 134 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_datafile_primary<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 135 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_www_sogou<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 136 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_datafile_privates<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 137 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 138 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_datafile_4corner<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 139 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_datafile_pinyin<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 140 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_diy_pinyin_4corner<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 141 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 142 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_shuangpin<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 143 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_datafile_erbi<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 144 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_datafile_wubi<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 145 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_valid_keys<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 146 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 147 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_color<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 148 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_encoding<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 149 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_punctuations<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 150 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_quantifiers<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 151 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 152 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 153 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 154 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 155 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_global</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 156 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 157 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>G<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 158 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_auto_spell&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 159 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_ctrl_space_as_ctrl_6&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 160 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_datafile&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 161 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_privates_txt&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 162 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_diy_pinyin_4corner&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 163 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_shuangpin_abc&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 164 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_shuangpin_microsoft&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 165 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_shuangpin_nature&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 166 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_shuangpin_plusplus&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 167 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_shuangpin_purple&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 168 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_dummy_shuangpin&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 169 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_fuzzy_search&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 170 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_latex_suite&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 171 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_match_word_after_word&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 172 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_custom_menu_color&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 173 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_custom_lcursor_color&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 174 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_menu_extra_text&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 175 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_number_as_navigation&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 176 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_reverse_pageup_pagedown&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 177 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_save_input_history_frequency&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 178 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_sexy_input_style&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 179 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_smart_punctuation&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 180 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_static_input_style&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 181 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_tab_for_one_key&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 182 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_unicode_lookup&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 183 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_wildcard_search&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 184 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_www_sogou&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 185 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_seamless_english_input&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 186 </span><span class="Comment">    &quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 187 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_set_global_default<span class="Statement">(</span>G, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 188 </span><span class="Comment">    &quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 189 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>G<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 190 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_auto_copy_clipboard&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 191 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_chinese_input_mode&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 192 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_chinese_punctuation&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 193 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_dynamic_mode_autocmd&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 194 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_do_search&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 195 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_english_input_on_enter&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 196 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_first_candidate_fix&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 197 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_internal_code_input&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 198 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_match_dot_after_dot&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 199 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_menu_label&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 200 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_one_key&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 201 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_punctuation_navigation&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 202 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_quick_key&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 203 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_save_new_entry&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 204 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>G, <span class="Constant">&quot;g:vimim_wubi_non_stop&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 205 </span><span class="Comment">    &quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 206 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_set_global_default<span class="Statement">(</span>G, <span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 207 </span><span class="Comment">    &quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 208 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 209 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 210 </span><span class="Comment">&quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 211 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_set_global_default</span><span class="Statement">(</span>options, default<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 212 </span><span class="Comment">&quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 213 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>variable<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">a:options</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 214 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s_variable<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>variable,<span class="Constant">&quot;g:&quot;</span><span class="vimOperParen">,</span><span class="Constant">&quot;s:&quot;</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 215 </span>        <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">exists</span><span class="Statement">(</span>variable<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 216 </span>            <span class="Statement">exe</span> <span class="Constant">'let '</span><span class="Statement">.</span><span class="vimExecute"> </span>s_variable<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'='</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="vimVar">a</span><span class="vimExecute">:</span><span class="vimVar">default</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 217 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 218 </span>            <span class="Statement">exe</span> <span class="Constant">'let '</span><span class="Statement">.</span><span class="vimExecute"> </span>s_variable<span class="vimExecute"> </span><span class="Statement">.</span><span class="Constant">'='</span><span class="Statement">.</span><span class="vimExecute"> </span><span class="vimVar">variable</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 219 </span>            <span class="Statement">exe</span> <span class="Constant">'unlet! '</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>variable
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 220 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 221 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 222 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 223 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 224 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 225 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_settings</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 226 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 227 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>saved_cpo<span class="Statement">=</span><span class="vimFuncBody">&amp;</span><span class="vimIsCommand">cpo</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 228 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>saved_lazyredraw<span class="Statement">=</span><span class="vimFuncBody">&amp;</span><span class="vimIsCommand">lazyredraw</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 229 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>saved_hlsearch<span class="Statement">=</span><span class="vimFuncBody">&amp;</span><span class="vimIsCommand">hlsearch</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 230 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>saved_pumheight<span class="Statement">=</span><span class="vimFuncBody">&amp;</span><span class="vimIsCommand">pumheight</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 231 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 232 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 233 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 234 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_session</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 235 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 236 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>wubi_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 237 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>erbi_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 238 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pinyin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 239 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>privates_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 240 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 241 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>english_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 242 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>www_executable<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 243 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 244 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 245 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_in_quanpin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 246 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_shuangpin_table<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 247 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 248 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 249 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_datafile_has_dot<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 250 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 251 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>start_row_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 252 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>start_column_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 253 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 254 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 255 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>menu_reverse<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 256 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 257 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>ecdict<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 258 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>unicode_prefix<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'u'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 259 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_insert_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 260 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_input_mode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 261 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_punctuation<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">(</span>s:vimim_chinese_punctuation<span class="Statement">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody">%</span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 262 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 263 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>insert_without_popup_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 264 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_sentence_input<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 265 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>onekey_loaded_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 266 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>trash_code_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 267 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 268 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>space<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 269 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>backspace<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 270 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 271 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_leading_zero<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 272 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_counts<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 273 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span><span class="Constant">''</span><span class="vimFuncBody">, </span><span class="Constant">''</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 274 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_wubi<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 275 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 276 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>start_positions<span class="vimFuncBody">   </span><span class="Statement">=</span><span class="vimFuncBody"> [</span><span class="Constant">0</span><span class="vimFuncBody">,</span><span class="Constant">0</span><span class="vimFuncBody">,</span><span class="Constant">1</span><span class="vimFuncBody">,</span><span class="Constant">0</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 277 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_positions<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span><span class="Constant">0</span><span class="vimFuncBody">,</span><span class="Constant">0</span><span class="vimFuncBody">,</span><span class="Constant">1</span><span class="vimFuncBody">,</span><span class="Constant">0</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 278 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>lines_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 279 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>alphabet_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 280 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 281 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>g:vimim_set_seamless<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 282 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 283 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 284 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 285 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 286 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_color</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 287 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 288 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_custom_menu_color<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 289 </span>        highlight<span class="vimFuncBody">! </span><span class="vimIsCommand">link</span><span class="vimFuncBody"> </span><span class="vimIsCommand">PmenuSel</span><span class="vimFuncBody">  </span><span class="vimIsCommand">Title</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 290 </span>        highlight<span class="vimFuncBody">! </span><span class="vimIsCommand">Pmenu</span><span class="vimFuncBody">          </span><span class="vimIsCommand">NONE</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 291 </span>        highlight<span class="vimFuncBody">! </span><span class="vimIsCommand">PmenuSbar</span><span class="vimFuncBody">      </span><span class="vimIsCommand">NONE</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 292 </span>        highlight<span class="vimFuncBody">! </span><span class="vimIsCommand">PmenuThumb</span><span class="vimFuncBody">     </span><span class="vimIsCommand">NONE</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 293 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_custom_menu_color</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 294 </span>            highlight<span class="vimFuncBody">! </span><span class="vimIsCommand">clear</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 295 </span>            highlight<span class="vimFuncBody">! </span><span class="vimIsCommand">PmenuSbar</span><span class="vimFuncBody">  </span><span class="vimIsCommand">NONE</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 296 </span>            highlight<span class="vimFuncBody">! </span><span class="vimIsCommand">PmenuThumb</span><span class="vimFuncBody"> </span><span class="vimIsCommand">NONE</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 297 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 298 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 299 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 300 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 301 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 302 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_datafile_primary</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 303 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 304 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">current_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 305 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 306 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>msg<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'no user-specified datafile'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 307 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 308 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 309 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 310 </span><span class="Comment">    &quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 311 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>input_methods<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 312 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;pinyin&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 313 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;pinyin_huge&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 314 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;pinyin_fcitx&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 315 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;pinyin_canton&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 316 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;pinyin_hongkong&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 317 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;wu&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 318 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;phonetic&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 319 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;yong&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 320 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;nature&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 321 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;cangjie&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 322 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;zhengma&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 323 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;xinhua&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 324 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;quick&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 325 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;array30&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 326 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;wubi&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 327 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;wubi98&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 328 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;wubijd&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 329 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;erbi&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 330 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;english&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 331 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;4corner&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 332 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;ctc&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 333 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;cns11643&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 334 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Special">&quot;1</span><span class="vimOperParen">2345&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 335 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;hangul&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 336 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">map</span><span class="Statement">(</span>input_methods, <span class="Constant">'&quot;vimim.&quot; . v:val . &quot;.txt&quot;'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 337 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>input_methods, <span class="Constant">&quot;privates.txt&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 338 </span><span class="Comment">    &quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 339 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span><span class="Statement">file</span><span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span>input_methods
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 340 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">path</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Statement">file</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 341 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">filereadable</span><span class="Statement">(</span>datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 342 </span>            <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 343 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 344 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 345 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 346 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 347 </span><span class="Comment">    &quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 348 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">filereadable</span><span class="Statement">(</span>datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 349 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'erbi'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 350 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>erbi_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 351 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'wubi'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 352 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>wubi_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 353 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'pinyin'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 354 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pinyin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 355 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'english'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 356 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>english_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 357 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'4corner'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 358 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 359 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'ctc'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 360 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 361 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'12345'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 362 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">5</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 363 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'privates'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 364 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>privates_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 365 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 366 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 367 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 368 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 369 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 370 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 371 </span><span class="Statement">function</span>! g:vimim_set_seamless<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 372 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 373 </span>    <span class="Statement">let</span><span class=""> </span>s:seamless_positions<span class=""> </span><span class="Statement">=</span><span class=""> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 374 </span>    <span class="Statement">if</span><span class=""> </span>s:vimim_seamless_english_input<span class=""> </span><span class="Statement">&gt;</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 375 </span>        <span class="Statement">let</span><span class=""> </span>s:seamless_positions<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">getpos</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 376 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 377 </span>    <span class="Statement">return</span><span class=""> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 378 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 379 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 380 </span><span class="Statement">let</span> s:translators<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 381 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 382 </span><span class="Statement">function</span>! s:translators.translate<span class="Statement">(</span>line<span class="Statement">)</span><span class=""> </span>dict
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 383 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 384 </span>    <span class="Statement">return</span><span class=""> </span><span class="Identifier">join</span><span class="Statement">(</span>map<span class="Statement">(</span><span class="vimOperParen">split</span><span class="Statement">(</span><span class="vimOperParen">a:line</span><span class="Statement">)</span><span class="vimOperParen">,</span><span class="Constant">'get(self.dict,tolower(v:val),v:val)'</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 385 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 386 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 387 </span><span class="Comment">&quot; -------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 388 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_expand_character_class</span><span class="Statement">(</span>character_class<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 389 </span><span class="Comment">&quot; -------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 390 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>character_string<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 391 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 392 </span>    <span class="Statement">while</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">256</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 393 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>x<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">nr2char</span><span class="Statement">(</span>i<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 394 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">x</span><span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Identifier">a:character_class</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 395 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>character_string<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Statement">x</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 396 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 397 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 398 </span>    <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 399 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>character_string
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 400 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 401 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 402 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 403 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_valid_keys</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 404 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 405 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[0-9a-zA-Z]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 406 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">current_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 407 </span><span class="Comment">    &quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 408 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'phonetic'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 409 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_datafile_has_dot<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 410 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[0-9a-z.,;/\-]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 411 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'array'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 412 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_datafile_has_dot<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 413 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[a-z.,;/]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 414 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'cns11643'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 415 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[0-9a-f]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 416 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'yong'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 417 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[a-z;'/]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 418 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'wu'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 419 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[a-z']&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 420 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'nature'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 421 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[a-z'.]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 422 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'zhengma'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 423 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[a-z.]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 424 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>input_method<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'cangjie'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 425 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[a-z.]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 426 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 427 </span><span class="Comment">    &quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 428 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:privates_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 429 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[0-9]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 430 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">erbi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 431 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_datafile_has_dot<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 432 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[a-z;,.'/]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 433 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 434 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'[a-zA-Z.]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 435 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 436 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'[0-9a-z.]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 437 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 438 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'[a-z;'</span><span class="vimFuncBody">]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 439 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">3</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 440 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'[0-9a-zA-Z.]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 441 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 442 </span><span class="Comment">    &quot; -----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 443 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_set_valid_key<span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 444 </span><span class="Comment">    &quot; -----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 445 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 446 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 447 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 448 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_set_valid_key</span><span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 449 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 450 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 451 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_wildcard_search</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:wubi_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 452 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>wildcard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'[*]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 453 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key_valid<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>key, <span class="Constant">1</span><span class="vimOperParen">, len</span><span class="Statement">(</span><span class="vimOperParen">key</span><span class="Statement">)-</span><span class="Constant">2</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 454 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key_wildcard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>wildcard, <span class="Constant">1</span><span class="vimOperParen">, len</span><span class="Statement">(</span><span class="vimOperParen">wildcard</span><span class="Statement">)-</span><span class="Constant">2</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 455 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'['</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>key_valid<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">key_wildcard</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">']'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 456 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 457 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>valid_key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 458 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_expand_character_class<span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 459 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>valid_keys<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>key, <span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 460 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 461 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold3")'>| </a><span class="lnr"> 462 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold4' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold4")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold4")'>- </a><span class="Folded"> 463 +--210 lines: ====  VimIM Easter Egg      ====
</span><span class='fulltext'><span class="lnr"> 463 </span><span class="Comment">&quot; ====  VimIM Easter Egg      ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 464 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 465 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 466 </span><span class="Comment">&quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 467 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_easter_egg</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 468 </span><span class="Comment">&quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 469 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>easter_eggs<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 470 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>easter_eggs<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> [</span><span class="Constant">&quot;vi    文本編輯器&quot;</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 471 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>easter_eggs<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> [</span><span class="Constant">&quot;vim   最牛文本編輯器&quot;</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 472 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>easter_eggs<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> [</span><span class="Constant">&quot;vim   精力 生氣&quot;</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 473 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>easter_eggs<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> [</span><span class="Constant">&quot;vimim 中文輸入法&quot;</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 474 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_pair_list<span class="Statement">(</span>easter_eggs<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 475 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 476 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 477 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 478 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 479 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_translator</span><span class="Statement">(</span>english<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 480 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 481 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:english</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\p'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 482 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 483 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 484 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:ecdict<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 485 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_initialize_e2c<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 486 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 487 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>english<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>a:english, <span class="Constant">'\A'</span><span class="vimOperParen">, </span><span class="Constant">' &amp; '</span><span class="vimOperParen">, </span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 488 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>english, <span class="Constant">'.'</span><span class="vimOperParen">, </span><span class="Constant">'&amp;\n'</span><span class="vimOperParen">, </span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 489 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:ecdict.translate<span class="Statement">(</span>english<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 490 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>chinese, <span class="Constant">&quot;[ ']&quot;</span><span class="vimOperParen">, </span><span class="Constant">''</span><span class="vimOperParen">, </span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 491 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>chinese, <span class="Constant">'\a\+'</span><span class="vimOperParen">, </span><span class="Constant">' &amp; '</span><span class="vimOperParen">, </span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 492 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>chinese
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 493 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 494 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 495 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 496 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_e2c</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 497 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 498 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:english_flag<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span><span class="vimOperParen">s:ecdict</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 499 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 500 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 501 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_datafile<span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 502 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 503 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 504 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 505 </span><span class="Comment">    &quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 506 </span><span class="Comment">    &quot; VimIM rule for entry of English Chinese dictionary</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 507 </span><span class="Comment">    &quot; example 例如 #</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 508 </span><span class="Comment">    &quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 509 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>english_pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;#$&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 510 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>matched_english_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, english_pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 511 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>matched_english_lines<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 512 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 513 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 514 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>dictionary_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>copy<span class="Statement">(</span><span class="vimOperParen">lines</span><span class="Statement">)</span><span class="vimOperParen">,</span><span class="Constant">'v:val=~english_pattern'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 515 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>dictionary_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 516 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 517 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 518 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>ecdict<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">copy</span><span class="Statement">(</span>s:translators<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 519 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>ecdict<span class="Statement">.</span><span class="vimIsCommand">dict</span><span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 520 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">dictionary_lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 521 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 522 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 523 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 524 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_i18n_read<span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 525 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>words<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 526 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>words<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 527 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 528 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 529 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>ecdict<span class="Statement">.</span><span class="vimIsCommand">dict</span><span class="vimFuncBody">[</span><span class="vimIsCommand">words</span><span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">]] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">words</span><span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 530 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 531 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 532 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 533 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 534 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_quantifiers</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 535 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 536 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 537 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:pinyin_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 538 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 539 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 540 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_shuangpin_abc<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 541 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 542 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 543 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'1'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'一壹㈠①⒈⑴甲'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 544 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'2'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'二贰㈡②⒉⑵乙'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 545 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'3'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'三叁㈢③⒊⑶丙'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 546 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'4'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'四肆㈣④⒋⑷丁'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 547 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'5'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'五伍㈤⑤⒌⑸戊'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 548 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'6'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'六陆㈥⑥⒍⑹己'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 549 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'7'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'七柒㈦⑦⒎⑺庚'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 550 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'8'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'八捌㈧⑧⒏⑻辛'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 551 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'9'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'九玖㈨⑨⒐⑼壬'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 552 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'0'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'〇零㈩⑩⒑⑽癸十拾'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 553 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'a'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'秒'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 554 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'b'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'百佰把班包杯本笔部'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 555 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'c'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'厘餐场串次处'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 556 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'d'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'第度点袋道滴碟顶栋堆对朵堵顿'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 557 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'e'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'亿'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 558 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'f'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'分份发封付副幅峰方服'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 559 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'g'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'个根股管'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 560 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'h'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'时毫行盒壶户回'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 561 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'i'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'毫'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 562 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'j'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'斤家具架间件节剂具捲卷茎记'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 563 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'k'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'克口块棵颗捆孔'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 564 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'l'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'里粒类辆列轮厘升领缕'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 565 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'m'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'米名枚面门'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 566 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'n'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'年'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 567 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'o'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'度'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 568 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'p'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'磅盆瓶排盘盆匹片篇撇喷'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 569 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'q'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'千仟群'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 570 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'r'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'日'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 571 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'s'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'十拾时升艘扇首双所束手'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 572 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'t'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'吨条头通堂台套桶筒贴趟'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 573 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'u'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'微'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 574 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'w'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'万位味碗窝'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 575 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'x'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'升席些项'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 576 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'y'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'月亿叶'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 577 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>quantifiers<span class="vimFuncBody">[</span><span class="Constant">'z'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'兆只张株支枝指盏座阵桩尊则种站幢宗'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 578 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 579 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 580 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 581 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_date_time</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 582 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 583 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_debug_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 584 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 585 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 586 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>time<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 587 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">==?</span><span class="vimFuncBody"> </span><span class="Constant">'itoday'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 588 </span><span class="Comment">        &quot; 2009 year February 22 day Wednesday</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 589 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>time<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strftime</span><span class="Statement">(</span><span class="Constant">&quot;%Y year %B %d day %A&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 590 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">==?</span><span class="vimFuncBody"> </span><span class="Constant">'inow'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 591 </span><span class="Comment">        &quot; Sunday AM 8 hour 8 minute 8 second</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 592 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>time<span class="Statement">=</span><span class="Identifier">strftime</span><span class="Statement">(</span><span class="Constant">&quot;%A %p %I hour %M minute %S second&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 593 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 594 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>time<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 595 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 596 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 597 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>time<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_translator<span class="Statement">(</span>time<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 598 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>time, <span class="Constant">'\ze'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 599 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>a:keyboard,<span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 600 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>time<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_get_chinese_number<span class="Statement">(</span>keyboards, i<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 601 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>time<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 602 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>insert_without_popup_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 603 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 604 </span>    <span class="Statement">return</span><span class="vimFuncBody"> [</span>time<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 605 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 606 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 607 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 608 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_chinese_number</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 609 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 610 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>a:keyboard,<span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 611 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'^\d\+'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 612 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">len</span><span class="Statement">(</span>substitute<span class="Statement">(</span><span class="vimOperParen">keyboard,</span><span class="Constant">'\d'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="Statement">))</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 613 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 614 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 615 </span><span class="Comment">    &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 616 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>digit_alpha<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 617 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'^\d*\l\{1}$'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 618 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>digit_alpha<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="vimOperParen">,len</span><span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 619 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'^\d*$'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 620 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>digit_alpha<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 621 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 622 </span><span class="Comment">    &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 623 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>digit_alpha, <span class="Constant">'\ze'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 624 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>a:keyboard,<span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 625 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_number<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_get_chinese_number<span class="Statement">(</span>keyboards, i<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 626 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>chinese_number<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 627 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 628 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 629 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span>chinese_number<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 630 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>last_char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,len<span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 631 </span>    <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">empty</span><span class="Statement">(</span>last_char<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span><span class="vimOperParen">s:quantifiers, last_char</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 632 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>quantifier<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">quantifiers</span><span class="vimFuncBody">[</span><span class="vimIsCommand">last_char</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 633 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>quantifiers<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>quantifier, <span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 634 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'^\d*\l\{1}$'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 635 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">map</span><span class="Statement">(</span>copy<span class="Statement">(</span><span class="vimOperParen">quantifiers</span><span class="Statement">)</span><span class="vimOperParen">, </span><span class="Constant">'chinese_number . v:val'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 636 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>last_char<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'d'</span><span class="vimFuncBody">  |&quot; </span><span class="vimIsCommand">i2d</span><span class="vimFuncBody"> </span><span class="Statement">=&gt;</span><span class="vimFuncBody"> 二第 </span><span class="Statement">=&gt;</span><span class="vimFuncBody"> 第二</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 637 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>reverse<span class="Statement">(</span><span class="vimOperParen">split</span><span class="Statement">(</span><span class="vimOperParen">chinese[</span><span class="Constant">0</span><span class="vimOperParen">],</span><span class="Constant">'\zs'</span><span class="Statement">))</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 638 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 639 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'^\d*$'</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboards<span class="Statement">)&lt;</span><span class="Constant">2</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">i</span><span class="Statement">==#</span><span class="Constant">'i'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 640 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>quantifiers
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 641 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 642 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 643 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>chinese<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 644 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>insert_without_popup_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 645 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 646 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>chinese
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 647 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 648 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 649 </span><span class="Comment">&quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 650 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_get_chinese_number</span><span class="Statement">(</span>keyboards, i<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 651 </span><span class="Comment">&quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 652 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:keyboards<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">a:i</span><span class="vimFuncBody"> </span><span class="Statement">!~?</span><span class="vimFuncBody"> </span><span class="Constant">'i'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 653 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 654 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 655 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_number<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 656 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboards</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 657 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>s:quantifiers, char<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 658 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>quantifier<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">quantifiers</span><span class="vimFuncBody">[</span><span class="vimIsCommand">char</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 659 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>quantifiers<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>quantifier,<span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 660 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:i</span><span class="vimFuncBody"> </span><span class="Statement">==#</span><span class="vimFuncBody"> </span><span class="Constant">'i'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 661 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_number<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>quantifiers,<span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 662 </span>            <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:i</span><span class="vimFuncBody"> </span><span class="Statement">==#</span><span class="vimFuncBody"> </span><span class="Constant">'I'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 663 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_number<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>quantifiers,<span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 664 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 665 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 666 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_number<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span>char
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 667 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 668 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 669 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>chinese_number
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 670 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 671 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold4")'>| </a><span class="lnr"> 672 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold5' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold5")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold5")'>- </a><span class="Folded"> 673 +--158 lines: ====  VimIM Unicode         ====
</span><span class='fulltext'><span class="lnr"> 673 </span><span class="Comment">&quot; ====  VimIM Unicode         ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 674 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 675 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 676 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 677 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_encoding</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 678 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 679 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>localization<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_localization<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 680 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>multibyte<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 681 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>max_ddddd<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">64928</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 682 </span>    <span class="Statement">if</span><span class="vimFuncBody"> &amp;</span>encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;utf-8&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 683 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>multibyte<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">3</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 684 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>max_ddddd<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">40869</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 685 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 686 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_unicode_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 687 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 688 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 689 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">localization</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 690 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_save_input_history_frequency<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 691 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 692 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 693 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 694 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 695 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_localization</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 696 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 697 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>localization<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 698 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>datafile_fenc_chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 699 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">current_datafile</span><span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">&quot;chinese&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 700 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>datafile_fenc_chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 701 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 702 </span><span class="Comment">    &quot; ------------ ----------------- ----</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 703 </span><span class="Comment">    &quot; vim encoding datafile encoding code</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 704 </span><span class="Comment">    &quot; ------------ ----------------- ----</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 705 </span><span class="Comment">    &quot;   utf-8          utf-8          0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 706 </span><span class="Comment">    &quot;   utf-8          chinese        1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 707 </span><span class="Comment">    &quot;   chinese        utf-8          2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 708 </span><span class="Comment">    &quot;   chinese        chinese        8</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 709 </span><span class="Comment">    &quot; ------------ ----------------- ----</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 710 </span>    <span class="Statement">if</span><span class="vimFuncBody"> &amp;</span>encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;utf-8&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 711 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>datafile_fenc_chinese<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 712 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>localization<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 713 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 714 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>datafile_fenc_chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 715 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>localization<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 716 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 717 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>localization
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 718 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 719 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 720 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 721 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_i18n_read_list</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 722 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 723 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 724 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 725 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 726 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 727 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:localization<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 728 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 729 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>a:lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 730 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">a:lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 731 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_i18n_read<span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 732 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>results, line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 733 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 734 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 735 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 736 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 737 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 738 </span><span class="Comment">&quot; -------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 739 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_i18n_read</span><span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 740 </span><span class="Comment">&quot; -------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 741 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:line</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 742 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">localization</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 743 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">iconv</span><span class="Statement">(</span>line, <span class="Constant">&quot;chinese&quot;</span><span class="vimOperParen">, </span><span class="Constant">&quot;utf-8&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 744 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">localization</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 745 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">iconv</span><span class="Statement">(</span>line, <span class="Constant">&quot;utf-8&quot;</span><span class="vimOperParen">, &amp;enc</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 746 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 747 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>line
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 748 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 749 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 750 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 751 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_i18n_write</span><span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 752 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 753 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:line</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 754 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">localization</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 755 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">iconv</span><span class="Statement">(</span>line, <span class="Constant">&quot;utf-8&quot;</span><span class="vimOperParen">, &amp;enc</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 756 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">localization</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 757 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">iconv</span><span class="Statement">(</span>line, &amp;enc, <span class="Constant">&quot;utf-8&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 758 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 759 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>line
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 760 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 761 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 762 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 763 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_hex_unicode</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 764 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 765 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_unicode_flag</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 766 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">match</span><span class="Statement">(</span>a:keyboard, <span class="Constant">'^\d\{4}$'</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 767 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 768 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 769 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>dddd<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">str2nr</span><span class="Statement">(</span>a:keyboard, <span class="Constant">16</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 770 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>dddd<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">max_ddddd</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 771 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 772 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 773 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>unicode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">nr2char</span><span class="Statement">(</span>dddd<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 774 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">unicode_prefix</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="Constant">'　'</span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">dddd</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 775 </span>    <span class="Statement">return</span><span class="vimFuncBody"> [</span><span class="Statement">menu</span><span class="Statement">.</span><span class="Constant">' '</span><span class="Statement">.</span>unicode<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 776 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 777 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 778 </span><span class="Comment">&quot; ------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 779 </span><span class="Statement">function</span>! CJK16<span class="Statement">(...)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 780 </span><span class="Comment">&quot; ------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 781 </span><span class="Comment">&quot; This function outputs unicode block by block as:</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 782 </span><span class="Comment">&quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 783 </span><span class="Comment">&quot;      0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 784 </span><span class="Comment">&quot; 4E00 #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  #</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 785 </span><span class="Comment">&quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 786 </span>    <span class="Statement">if</span><span class="vimFuncBody"> &amp;</span>encoding<span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;utf-8&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 787 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'Your Vim encoding has to be set as utf-8.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 788 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'[usage]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 789 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'(in .vimrc):      :set encoding=utf-8'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 790 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'(in Vim Command): :call CJK16()&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 791 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'(in Vim Command): :call CJK16(0x8000,16)&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 792 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 793 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>a<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0x4E00</span><span class="vimFuncBody">| </span><span class="Statement">let</span><span class="vimFuncBody"> </span><span class="vimVar">n</span><span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">112</span><span class="Statement">-</span><span class="Constant">24</span><span class="vimFuncBody">| </span><span class="Statement">let</span><span class="vimFuncBody"> </span><span class="vimVar">block</span><span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0x00F0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 794 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">(</span>a:<span class="Constant">0</span><span class="Statement">&gt;=</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody">| </span><span class="Statement">let</span><span class="vimFuncBody"> </span>a<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:1</span><span class="vimFuncBody">| </span><span class="Statement">let</span><span class="vimFuncBody"> </span><span class="vimVar">n</span><span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span><span class="vimFuncBody">| </span><span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 795 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">(</span>a:<span class="Constant">0</span><span class="Statement">==</span><span class="Constant">2</span><span class="Statement">)</span><span class="vimFuncBody">| </span><span class="Statement">let</span><span class="vimFuncBody"> </span>n<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:2</span><span class="vimFuncBody">| </span><span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 796 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>z<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>a<span class="vimFuncBody"> </span><span class="Statement">+</span><span class="vimFuncBody"> </span><span class="Statement">n</span><span class="vimFuncBody">*</span><span class="vimIsCommand">block</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="Constant">128</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 797 </span>        <span class="Statement">while</span><span class="vimFuncBody"> </span>a<span class="vimFuncBody"> </span><span class="Statement">&lt;=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">z</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 798 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a%<span class="Statement">(</span><span class="Constant">16</span><span class="vimOperParen">*</span><span class="Constant">16</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 799 </span>                $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'----------------------------------------------------'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 800 </span>                $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'     0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F '</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 801 </span>                $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'----------------------------------------------------'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 802 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 803 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>c<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'%04X '</span>,a<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 804 </span>            <span class="Statement">for</span><span class="vimFuncBody"> </span><span class="Statement">j</span><span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span><span class="Constant">16</span><span class="Statement">)</span><span class="vimFuncBody">|</span><span class="Statement">let</span><span class="vimFuncBody"> </span>c<span class="Statement">.=</span><span class="Identifier">nr2char</span><span class="Statement">(</span>a<span class="Statement">).</span><span class="Constant">' '</span><span class="vimFuncBody">|</span><span class="Statement">let</span><span class="vimFuncBody"> </span><span class="vimVar">a</span><span class="Statement">+=</span><span class="Constant">1</span><span class="vimFuncBody">|</span><span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 805 </span>            $<span class="Statement">put</span><span class="Statement">=</span><span class="Statement">c</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 806 </span>        <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 807 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 808 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 809 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 810 </span><span class="Comment">&quot; -------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 811 </span><span class="Statement">function</span>! CJK<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 812 </span><span class="Comment">&quot; -------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 813 </span><span class="Comment">&quot; This function outputs unicode as:</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 814 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 815 </span><span class="Comment">&quot;   decimal  hex    CJK</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 816 </span><span class="Comment">&quot;   39340    99ac    馬</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 817 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 818 </span>    <span class="Statement">if</span><span class="vimFuncBody"> &amp;</span>encoding<span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;utf-8&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 819 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'Your Vim encoding has to be set as utf-8.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 820 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'[usage]    :call CJK()&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 821 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 822 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>unicode_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">19968</span><span class="vimFuncBody">  </span><span class="Comment">&quot;| 一</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 823 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>unicode_end<span class="vimFuncBody">   </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">40869</span><span class="vimFuncBody">  </span><span class="Comment">&quot;| 龥</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 824 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span>unicode_start, unicode_end<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 825 </span>            $<span class="Statement">put</span><span class="Statement">=</span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'%d %x '</span>,i,i<span class="Statement">).</span><span class="Identifier">nr2char</span><span class="Statement">(</span><span class="vimOperParen">i</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 826 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 827 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 828 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 829 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold5")'>| </a><span class="lnr"> 830 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold6' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold6")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold6")'>- </a><span class="Folded"> 831 +-- 99 lines: ====  VimIM GBK             ====
</span><span class='fulltext'><span class="lnr"> 831 </span><span class="Comment">&quot; ====  VimIM GBK             ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 832 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 833 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 834 </span><span class="Comment">&quot; -------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 835 </span><span class="Statement">function</span>! GBK<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 836 </span><span class="Comment">&quot; -------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 837 </span><span class="Comment">&quot; This function outputs GBK as:</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 838 </span><span class="Comment">&quot; ----------------------------- gb=6763</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 839 </span><span class="Comment">&quot;   decimal  hex    GBK</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 840 </span><span class="Comment">&quot;   49901    c2ed    马</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 841 </span><span class="Comment">&quot; ----------------------------- gbk=883+21003=21886</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 842 </span>    <span class="Statement">if</span><span class="vimFuncBody">  &amp;</span>encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;chinese&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 843 </span><span class="Special">    \</span><span class="Statement">||</span> &amp;encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;cp936&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 844 </span><span class="Special">    \</span><span class="Statement">||</span> &amp;encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;gb2312&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 845 </span><span class="Special">    \</span><span class="Statement">||</span> &amp;encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;gbk&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 846 </span><span class="Special">    \</span><span class="Statement">||</span> &amp;encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;euc-cn&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 847 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">str2nr</span><span class="Statement">(</span><span class="Constant">'8140'</span>,<span class="Constant">16</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Comment">&quot;| 33088 丂</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 848 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span><span class="Constant">125</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 849 </span>            <span class="Statement">for</span><span class="vimFuncBody"> </span><span class="Statement">j</span><span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span>start, start<span class="Statement">+</span><span class="Constant">190</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 850 </span>                <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">j</span><span class="vimFuncBody"> </span><span class="Statement">&lt;=</span><span class="vimFuncBody"> </span><span class="Constant">64928</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Statement">j</span><span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Statement">start</span><span class="Statement">+</span><span class="Constant">63</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 851 </span>                    $<span class="Statement">put</span><span class="Statement">=</span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'%d %x '</span>,j,j<span class="Statement">).</span><span class="Identifier">nr2char</span><span class="Statement">(</span><span class="vimOperParen">j</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 852 </span>                <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 853 </span>            <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 854 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>start<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">16</span><span class="vimFuncBody">*</span><span class="Constant">16</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 855 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 856 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 857 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'Your Vim encoding has to be set as chinese.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 858 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'[usage]    :call GBK()&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 859 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 860 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 861 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 862 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 863 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_internal_code</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 864 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 865 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 866 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">strlen</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">5</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 867 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">strlen</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 868 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 869 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 870 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span>pumheight<span class="Statement">=</span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 871 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>unicode_menu_display_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 872 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>numbers<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 873 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 874 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>last_char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,len<span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 875 </span><span class="Comment">    &quot; support unicode popup menu, if ending with 'u'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 876 </span><span class="Comment">    &quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 877 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>last_char<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">unicode_prefix</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 878 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="vimOperParen">,len</span><span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 879 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'^\d\{4}$'</span><span class="vimFuncBody">        </span><span class="Comment">&quot;| 2222u</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 880 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>digit_ranges<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span><span class="Constant">10</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 881 </span>            <span class="Statement">for</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">digit_ranges</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 882 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">4</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>i
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 883 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>digit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">str2nr</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 884 </span>                <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>numbers, digit<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 885 </span>            <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 886 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'^\x\{3}$'</span><span class="vimFuncBody">    </span><span class="Comment">&quot;| 808u</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 887 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hex_ranges<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>range<span class="Statement">(</span><span class="Constant">10</span><span class="Statement">)</span><span class="vimOperParen">,[</span><span class="Constant">'a'</span><span class="vimOperParen">,</span><span class="Constant">'b'</span><span class="vimOperParen">,</span><span class="Constant">'c'</span><span class="vimOperParen">,</span><span class="Constant">'d'</span><span class="vimOperParen">,</span><span class="Constant">'e'</span><span class="vimOperParen">,</span><span class="Constant">'f'</span><span class="vimOperParen">]</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 888 </span>            <span class="Statement">for</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">hex_ranges</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 889 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">3</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>i
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 890 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>digit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">str2nr</span><span class="Statement">(</span>keyboard, <span class="Constant">16</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 891 </span>                <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>numbers, digit<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 892 </span>            <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 893 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 894 </span>    <span class="Statement">else</span><span class="vimFuncBody"> |&quot; </span>support<span class="vimFuncBody"> </span><span class="vimIsCommand">direct</span><span class="vimFuncBody"> </span><span class="vimIsCommand">unicode</span><span class="vimFuncBody"> </span><span class="vimIsCommand">insert</span><span class="vimFuncBody"> </span><span class="vimIsCommand">by</span><span class="vimFuncBody"> </span><span class="Constant">22221</span><span class="vimFuncBody"> </span><span class="vimIsCommand">or</span><span class="vimFuncBody"> </span><span class="vimIsCommand">u808f</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 895 </span><span class="Comment">    &quot; -----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 896 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'^\d\{5}$'</span><span class="vimFuncBody">     </span><span class="Comment">&quot;| 32911</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 897 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>numbers<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span><span class="Identifier">str2nr</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 898 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'\x\{4}$'</span><span class="vimFuncBody">  </span><span class="Comment">&quot;| 808f</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 899 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>four_hex<span class="vimFuncBody">   </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>keyboard, <span class="Constant">'^\x\{4}$'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 900 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>four_digit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>keyboard, <span class="Constant">'^\d\{4}$'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 901 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>four_hex<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span>four_digit<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 902 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">unicode_prefix</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 903 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 904 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">unicode_prefix</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 905 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 906 </span>            <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 907 </span>                <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 908 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 909 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>ddddd<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">str2nr</span><span class="Statement">(</span>keyboard, <span class="Constant">16</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 910 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>ddddd<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">max_ddddd</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 911 </span>                <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 912 </span>            <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 913 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>numbers<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span>ddddd<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 914 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 915 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 916 </span>            <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 917 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 918 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 919 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>internal_codes<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 920 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>digit<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">numbers</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 921 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>hex<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'%04x'</span>, digit<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 922 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'　'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>hex<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="Constant">'　'</span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">digit</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 923 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>internal_code<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span><span class="Statement">.</span><span class="Constant">' '</span><span class="Statement">.</span><span class="Identifier">nr2char</span><span class="Statement">(</span>digit<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 924 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>internal_codes, internal_code<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 925 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 926 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>internal_codes
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 927 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 928 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold6")'>| </a><span class="lnr"> 929 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold7' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold7")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold7")'>- </a><span class="Folded"> 930 +-- 33 lines: ====  VimIM BIG5            ====
</span><span class='fulltext'><span class="lnr"> 930 </span><span class="Comment">&quot; ====  VimIM BIG5            ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 931 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 932 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 933 </span><span class="Comment">&quot; --------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 934 </span><span class="Statement">function</span>! BIG5<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 935 </span><span class="Comment">&quot; --------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 936 </span><span class="Comment">&quot; This function outputs BIG5 as:</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 937 </span><span class="Comment">&quot; -----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 938 </span><span class="Comment">&quot;   decimal  hex    BIG5</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 939 </span><span class="Comment">&quot;   45224    b0a8    馬</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 940 </span><span class="Comment">&quot; ----------------------------- big5=408+5401+7652=13461</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 941 </span>    <span class="Statement">if</span><span class="vimFuncBody">  &amp;</span>encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;taiwan&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 942 </span><span class="Special">    \</span><span class="Statement">||</span> &amp;encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;cp950&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 943 </span><span class="Special">    \</span><span class="Statement">||</span> &amp;encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;big5&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 944 </span><span class="Special">    \</span><span class="Statement">||</span> &amp;encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;euc-tw&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 945 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">str2nr</span><span class="Statement">(</span><span class="Constant">'A440'</span>,<span class="Constant">16</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Comment">&quot;| 42048  一</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 946 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span><span class="Constant">86</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 947 </span>            <span class="Statement">for</span><span class="vimFuncBody"> </span><span class="Statement">j</span><span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span>start, start<span class="Statement">+(</span><span class="Constant">4</span><span class="vimOperParen">*</span><span class="Constant">16</span><span class="Statement">)-</span><span class="Constant">2</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 948 </span>                $<span class="Statement">put</span><span class="Statement">=</span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'%d %x '</span>,j,j<span class="Statement">).</span><span class="Identifier">nr2char</span><span class="Statement">(</span><span class="vimOperParen">j</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 949 </span>            <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 950 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>start2<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">start</span><span class="vimFuncBody"> </span><span class="Statement">+</span><span class="vimFuncBody"> </span><span class="Constant">6</span><span class="vimFuncBody">*</span><span class="Constant">16</span><span class="Statement">+</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 951 </span>            <span class="Statement">for</span><span class="vimFuncBody"> </span><span class="Statement">j</span><span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span>start2, start2<span class="Statement">+</span><span class="Constant">93</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 952 </span>                $<span class="Statement">put</span><span class="Statement">=</span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'%d %x '</span>,j,j<span class="Statement">).</span><span class="Identifier">nr2char</span><span class="Statement">(</span><span class="vimOperParen">j</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 953 </span>            <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 954 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>start<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">16</span><span class="vimFuncBody">*</span><span class="Constant">16</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 955 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 956 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 957 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'Your Vim encoding has to be set as taiwan.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 958 </span>        $<span class="Statement">put</span><span class="Statement">=</span><span class="Constant">'[usage]    :call BIG5()&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 959 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 960 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 961 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold7")'>| </a><span class="lnr"> 962 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold8' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold8")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold8")'>- </a><span class="Folded"> 963 +--219 lines: ====  VimIM OneKey          ====
</span><span class='fulltext'><span class="lnr"> 963 </span><span class="Comment">&quot; ====  VimIM OneKey          ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 964 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 965 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 966 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 967 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_insert_setting_on</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 968 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 969 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span>pumheight<span class="Statement">=</span><span class="Constant">9</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 970 </span>    <span class="Statement">set</span> <span class="PreProc">nolazyredraw</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 971 </span>    <span class="Statement">set</span> <span class="PreProc">hlsearch</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 972 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 973 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 974 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 975 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_insert_setting_off</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 976 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 977 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span>lazyredraw<span class="Statement">=</span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">saved_lazyredraw</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 978 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span>hlsearch<span class="Statement">=</span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">saved_hlsearch</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 979 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span>pumheight<span class="Statement">=</span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">saved_pumheight</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 980 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 981 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 982 </span><span class="Comment">&quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 983 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_onekey</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 984 </span><span class="Comment">&quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 985 </span>    <span class="Statement">set</span> <span class="PreProc">completefunc</span>=VimI<span class="vimSet">M</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 986 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_input_mode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 987 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_resume_shuangpin<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 988 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_hjkl_navigation_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 989 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_tab_for_one_key</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 990 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_insert_setting_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 991 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 992 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:onekey_loaded_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 993 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>onekey_loaded_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 994 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_label_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 995 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_punctuation_navigation_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 996 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 997 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>onekey<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 998 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr"> 999 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>onekey<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_keyboard_block_by_block<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1000 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1001 </span>        <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="Special">&lt;</span><span class="Special">Space</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">C-R</span><span class="Special">&gt;</span><span class="vimMapRhs">=g:vimim_smart_space_onekey()</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1002 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>onekey<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_smart_punctuation<span class="Statement">(</span>s:punctuations, <span class="Constant">&quot;\t&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1003 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>onekey<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1004 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>onekey<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_ctrl_x_ctrl_u()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1005 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1006 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1007 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>onekey<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1008 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1009 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1010 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1011 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_hjkl_navigation_on</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1012 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1013 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1014 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1015 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1016 </span><span class="Comment">    &quot; hjkl navigation for onekey, always</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1017 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span><span class="Constant">'hjklegGycxd'</span>, <span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1018 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>_<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">hjkl_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1019 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'inoremap&lt;silent&gt;&lt;expr&gt; '</span><span class="Statement">.</span>_<span class="Statement">.</span><span class="vimExecute">'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1020 </span><span class="Special">        \</span> <span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span>vimim_hjkl<span class="Statement">(</span><span class="Constant">&quot;'._.'&quot;</span><span class="Statement">)</span><span class="vimFuncBody">'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1021 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1022 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1023 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1024 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1025 </span><span class="Statement">function</span>! g:vimim_space_key_for_yes<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1026 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1027 </span>    <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1028 </span>    <span class="Statement">if</span><span class=""> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1029 </span>        <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_keyboard_block_by_block<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1030 </span>        <span class="Statement">if</span><span class=""> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:chinese_input_mode<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1031 </span>            <span class="Statement">sil</span><span class="">!</span><span class="Statement">call</span><span class=""> </span>s:vimim_insert_setting_off<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1032 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1033 </span>        <span class="Statement">sil</span><span class="">!</span><span class="Statement">call</span><span class=""> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1034 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1035 </span>        <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">' '</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1036 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1037 </span>    <span class="Statement">sil</span><span class="">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>space<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1038 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1039 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1040 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1041 </span><span class="Statement">function</span>! g:vimim_smart_space_onekey<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1042 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1043 </span>    <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">' '</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1044 </span>    <span class="Statement">if</span><span class=""> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1045 </span>        <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_keyboard_block_by_block<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1046 </span>        <span class="Statement">sil</span><span class="">!</span><span class="Statement">call</span><span class=""> </span>s:vimim_insert_setting_off<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1047 </span>        <span class="Statement">sil</span><span class="">!</span><span class="Statement">call</span><span class=""> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1048 </span>        <span class="Statement">sil</span><span class="">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>space<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1049 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1050 </span>        iunmap<span class=""> </span><span class="Special">&lt;</span><span class="Special">Space</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1051 </span>        <span class="Statement">let</span><span class=""> </span>s:backspace<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1052 </span>        <span class="Statement">if</span><span class=""> </span>s:insert_without_popup_flag<span class=""> </span><span class="Statement">&gt;</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1053 </span>            <span class="Statement">let</span><span class=""> </span>s:insert_without_popup_flag<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1054 </span>            <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1055 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1056 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1057 </span>    <span class="Statement">return</span><span class=""> </span>space
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1058 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1059 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1060 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1061 </span><span class="Statement">function</span>! g:vimim_smart_space_static<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1062 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1063 </span>    <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">' '</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1064 </span>    <span class="Statement">if</span><span class=""> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1065 </span>        <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_keyboard_block_by_block<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1066 </span>        <span class="Statement">call</span><span class=""> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1067 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1068 </span>        <span class="Statement">let</span><span class=""> </span>s:backspace<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1069 </span>        <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_smart_punctuation<span class="Statement">(</span>s:punctuations, space<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1070 </span>        <span class="Statement">if</span><span class=""> </span><span class="Identifier">empty</span><span class="Statement">(</span>space<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1071 </span>            <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_ctrl_x_ctrl_u()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1072 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1073 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1074 </span>    <span class="Statement">sil</span><span class="">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>space<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1075 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1076 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1077 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1078 </span><span class="Statement">function</span>! g:vimim_smart_space_dynamic<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1079 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1080 </span>    <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">' '</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1081 </span>    <span class="Statement">if</span><span class=""> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1082 </span>        <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">&quot;\&lt;C-Y&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1083 </span>        <span class="Statement">sil</span><span class="">!</span><span class="Statement">call</span><span class=""> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1084 </span>        <span class="Statement">sil</span><span class="">!</span><span class="Statement">call</span><span class=""> </span>g:vimim_set_seamless<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1085 </span>        <span class="Statement">sil</span><span class="">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>space<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1086 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1087 </span>        <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_smart_punctuation<span class="Statement">(</span>s:punctuations, space<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1088 </span>        <span class="Statement">if</span><span class=""> </span><span class="Identifier">empty</span><span class="Statement">(</span>space<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1089 </span>            <span class="Statement">let</span><span class=""> </span>space<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">' '</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1090 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1091 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1092 </span>    <span class="Statement">return</span><span class=""> </span>space
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1093 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1094 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1095 </span><span class="Comment">&quot; --------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1096 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_label_on</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1097 </span><span class="Comment">&quot; --------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1098 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_menu_label</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1099 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1100 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1101 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>_<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span><span class="Constant">0</span>,<span class="Constant">9</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1102 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span>'inoremap<span class="Statement">&lt;</span><span class="vimVar">silent</span><span class="Statement">&gt;</span><span class="vimExecute"> </span><span class="Constant">'._.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1103 </span><span class="Special">        \</span> <span class="Special">&lt;</span><span class="Special">C-R</span><span class="Special">&gt;</span><span class="vimFuncBody">=</span><span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span>vimim_label<span class="Statement">(</span><span class="Constant">&quot;'._.'&quot;</span><span class="Statement">)</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span><span class="vimFuncBody">'</span><span class="Statement">.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1104 </span><span class="Special">        \</span><span class="Constant">'&lt;C-R&gt;=g:vimim_reset_after_insert()&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1105 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1106 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1107 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1108 </span><span class="Comment">&quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1109 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_label</span><span class="Statement">(</span>n<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1110 </span><span class="Comment">&quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1111 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>n<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:n</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1112 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>label<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:n</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1113 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1114 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>n<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1115 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1116 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>label<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-E&gt;\&lt;C-R&gt;=g:vimim_ctrl_x_ctrl_u()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1117 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1118 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>counts<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1119 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>yes<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1120 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_number_as_navigation<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1121 </span>                <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:chinese_input_mode<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1122 </span>                    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_insert_setting_off<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1123 </span>                <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1124 </span>                <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">n</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1125 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>n<span class="vimFuncBody"> </span><span class="Statement">-=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1126 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>counts<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">repeat</span><span class="Statement">(</span><span class="Constant">&quot;\&lt;Down&gt;&quot;</span>, n<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1127 </span>                <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1128 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1129 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>yes<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_keyboard_block_by_block<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1130 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>label<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>counts<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">yes</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1131 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1132 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1133 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>backspace<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1134 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>seamless_positions<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1135 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1136 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>label<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1137 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1138 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1139 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1140 </span><span class="Statement">function</span>! g:vimim_d_delete_trash<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1141 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1142 </span>    <span class="Statement">let</span><span class=""> </span>d<span class="">  </span><span class="Statement">=</span><span class=""> </span><span class="Constant">'d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1143 </span>    <span class="Statement">if</span><span class=""> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1144 </span>        <span class="Statement">call</span><span class=""> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1145 </span>        <span class="Statement">let</span><span class=""> </span>s:trash_code_flag<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1146 </span>        <span class="Statement">let</span><span class=""> </span>d<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">'\&lt;C-E&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1147 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1148 </span>    <span class="Statement">sil</span><span class="">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>d<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1149 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1150 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1151 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1152 </span><span class="Statement">function</span>! g:vimim_copy_popup_word<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1153 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1154 </span>    <span class="Statement">let</span><span class=""> </span>word<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_popup_word<span class="Statement">(</span>s:start_column_before<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1155 </span>    <span class="Statement">return</span><span class=""> </span>s:vimim_clipboard_register<span class="Statement">(</span>word<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1156 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1157 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1158 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1159 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_clipboard_register</span><span class="Statement">(</span>word<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1160 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1161 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>a:word<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1162 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_auto_copy_clipboard</span><span class="Statement">&gt;</span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">has</span><span class="Statement">(</span><span class="Constant">&quot;gui_running&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1163 </span>            <span class="Statement">let</span><span class="vimFuncBody"> @</span><span class="Statement">+</span><span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:word</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1164 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1165 </span>            <span class="Statement">let</span><span class="vimFuncBody"> @</span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:word</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1166 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1167 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1168 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;Esc&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1169 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1170 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1171 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1172 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_popup_word</span><span class="Statement">(</span>column_start<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1173 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1174 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>column_end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">col</span><span class="Statement">(</span><span class="Constant">'.'</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1175 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>range<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>column_end<span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="Identifier">a:column_start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1176 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1177 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>word<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>current_line, a:column_start, range<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1178 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>word
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1179 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1180 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold8")'>| </a><span class="lnr">1181 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold9' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold9")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold9")'>- </a><span class="Folded">1182 +--183 lines: ====  VimIM Chinese Mode    ====
</span><span class='fulltext'><span class="lnr">1182 </span><span class="Comment">&quot; ====  VimIM Chinese Mode    ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1183 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1184 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1185 </span><span class="Comment">&quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1186 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_toggle</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1187 </span><span class="Comment">&quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1188 </span>    <span class="Statement">set</span> <span class="PreProc">nopaste</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1189 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_insert_flag</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1190 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_chinese_mode_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1191 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1192 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_chinese_mode_off<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1193 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1194 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_dynamic_mode_autocmd</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">has</span><span class="Statement">(</span><span class="Constant">&quot;autocmd&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1195 </span>        <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">exists</span><span class="Statement">(</span><span class="Constant">&quot;s:dynamic_mode_autocmd_loaded&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1196 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>dynamic_mode_autocmd_loaded<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1197 </span>            <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">au</span><span class="vimFuncBody"> </span><span class="Type">InsertEnter</span> sil!call<span class="vimFuncBody"> </span>s:vimim_chinese_mode_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1198 </span>            <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">au</span><span class="vimFuncBody"> </span><span class="Type">InsertLeave</span> sil!call<span class="vimFuncBody"> </span>s:vimim_chinese_mode_off<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1199 </span>            <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">au</span><span class="vimFuncBody"> </span><span class="Type">BufUnload</span>   autocmd!<span class="vimFuncBody"> </span>InsertEnter<span class="vimFuncBody">,</span><span class="vimIsCommand">InsertLeave</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1200 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1201 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1202 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;C-O&gt;:redraw\&lt;CR&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1203 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1204 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1205 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1206 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_alphabet_auto_select</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1207 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1208 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1209 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1210 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1211 </span><span class="Comment">    &quot; always do alphabet auto selection for static</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1212 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>a<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">char2nr</span><span class="Statement">(</span><span class="Constant">'a'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1213 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>z<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">char2nr</span><span class="Statement">(</span><span class="Constant">'z'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1214 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>az_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">map</span><span class="Statement">(</span>range<span class="Statement">(</span><span class="vimOperParen">a,z</span><span class="Statement">)</span><span class="vimOperParen">,</span><span class="Constant">&quot;nr2char(&quot;</span><span class="Statement">.</span><span class="Constant">'v:val'</span><span class="Statement">.</span><span class="Constant">&quot;)&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1215 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">az_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1216 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'inoremap &lt;silent&gt; '</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>char<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> '</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1217 </span><span class="Special">        \</span> <span class="Special">&lt;</span><span class="Special">C-R</span><span class="Special">&gt;</span><span class="vimFuncBody">=</span><span class="Identifier">pumvisible</span><span class="Statement">()</span><span class="vimFuncBody">?</span><span class="Constant">&quot;\&lt;lt&gt;C-Y&gt;&quot;</span><span class="vimFuncBody">:&quot;&quot;</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span><span class="vimFuncBody">'</span><span class="Statement">.</span><span class="vimFuncBody"> </span>char
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1218 </span>     <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1219 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1220 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1221 </span><span class="Comment">&quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1222 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_hjkl</span><span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1223 </span><span class="Comment">&quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1224 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1225 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1226 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'e'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1227 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-E&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1228 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'y'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1229 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_space_key_for_yes()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1230 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'h'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1231 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;PageUp&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1232 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'j'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1233 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;Down&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1234 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'k'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1235 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;Up&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1236 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'l'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1237 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;PageDown&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1238 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'c'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1239 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_space_key_for_yes()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1240 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_copy_popup_word()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1241 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1242 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_d_delete_trash()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1243 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-X&gt;\&lt;C-U&gt;\&lt;BS&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1244 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==?</span><span class="vimFuncBody"> </span><span class="Constant">'g'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1245 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>menu_reverse<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1246 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==#</span><span class="vimFuncBody"> </span><span class="Constant">'G'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1247 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>menu_reverse<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1248 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1249 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1250 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-E&gt;\&lt;C-R&gt;=g:vimim_ctrl_x_ctrl_u()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1251 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1252 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1253 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>hjkl<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1254 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1255 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1256 </span><span class="Comment">&quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1257 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_insert_for_both_static_dynamic</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1258 </span><span class="Comment">&quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1259 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_insert_setting_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1260 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>g:vimim_set_seamless<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1261 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_label_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1262 </span>    <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;&lt;</span><span class="Special">expr</span><span class="Special">&gt;</span><span class="Special">&lt;</span><span class="Special">C-</span><span class="Special">\&gt;</span> <span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span><span class="vimMapRhs">vimim_toggle_punctuation()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1263 </span>    <span class="Statement">return</span><span class="vimFuncBody">  </span><span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span>vimim_toggle_punctuation<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1264 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1265 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1266 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1267 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_chinese_mode_on</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1268 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1269 </span>    <span class="Statement">set</span> <span class="PreProc">cpo</span><span class="PreProc">&amp;vim</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1270 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>completefunc<span class="Statement">=</span><span class="vimFuncBody">&amp;</span><span class="Statement">l</span><span class="vimFuncBody">:</span><span class="vimIsCommand">completefunc</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1271 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span><span class="Statement">l</span><span class="vimFuncBody">:</span>completefunc<span class="Statement">=</span><span class="Constant">&quot;VimIM&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1272 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span><span class="Statement">l</span><span class="vimFuncBody">:</span>iminsert<span class="Statement">=</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1273 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_insert_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1274 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_custom_lcursor_color<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1275 </span>        highlight<span class="vimFuncBody">! </span><span class="vimIsCommand">lCursor</span><span class="vimFuncBody"> </span><span class="vimIsCommand">guifg</span><span class="Statement">=</span><span class="vimIsCommand">bg</span><span class="vimFuncBody"> </span><span class="vimIsCommand">guibg</span><span class="Statement">=</span><span class="vimIsCommand">green</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1276 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1277 </span><span class="Comment">    &quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1278 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_static_input_style</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1279 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_input_mode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span><span class="vimFuncBody"> |&quot; </span>static_input<span class="vimFuncBody"> </span><span class="Statement">(</span>default off<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1280 </span><span class="Comment">        &quot; ============================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1281 </span>        <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">Space</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">C-R</span><span class="Special">&gt;</span><span class="vimMapRhs">=g:vimim_smart_space_static()</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1282 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_resume_shuangpin<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1283 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_alphabet_auto_select<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1284 </span><span class="Comment">        &quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1285 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1286 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_input_mode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">2</span><span class="vimFuncBody"> |&quot; </span>dynamic_input<span class="vimFuncBody"> </span><span class="Statement">(</span>default on<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1287 </span><span class="Comment">        &quot; ============================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1288 </span>        <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="Special">&lt;</span><span class="Special">Space</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">C-R</span><span class="Special">&gt;</span><span class="vimMapRhs">=g:vimim_smart_space_dynamic()</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1289 </span><span class="Comment">        &quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1290 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>valid_keys<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">copy</span><span class="Statement">(</span>s:valid_keys<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1291 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>valid_keys, match<span class="Statement">(</span><span class="vimOperParen">valid_keys,</span><span class="Constant">'[.]'</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1292 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">valid_keys</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1293 </span>            <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'inoremap&lt;silent&gt; '</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>char<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> '</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1294 </span><span class="Special">            \</span> <span class="Special">&lt;</span><span class="Special">C-R</span><span class="Special">&gt;</span><span class="vimFuncBody">=</span><span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span>vimim_dynamic_End<span class="Statement">()</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span><span class="vimFuncBody">'</span><span class="Statement">.</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1295 </span><span class="Special">            \</span><span class="Constant">'&lt;C-R&gt;=g:vimim_ctrl_x_ctrl_u()&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1296 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1297 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1298 </span><span class="Comment">    &quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1299 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_one_key_mapping_off<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1300 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_insert_for_both_static_dynamic<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1301 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1302 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1303 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1304 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_chinese_mode_off</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1305 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1306 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span>cpo<span class="Statement">=</span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">saved_cpo</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1307 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span><span class="Statement">l</span><span class="vimFuncBody">:</span>iminsert<span class="Statement">=</span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1308 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span><span class="Statement">l</span><span class="vimFuncBody">:</span>completefunc<span class="Statement">=</span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">completefunc</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1309 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>onekey_loaded_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1310 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_input_mode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1311 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_insert_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1312 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_custom_lcursor_color<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1313 </span>        highlight<span class="vimFuncBody"> </span><span class="vimIsCommand">lCursor</span><span class="vimFuncBody"> </span><span class="vimIsCommand">NONE</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1314 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1315 </span><span class="Comment">    &quot; ---------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1316 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_auto_copy_clipboard</span><span class="Statement">&gt;</span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">has</span><span class="Statement">(</span><span class="Constant">&quot;gui_running&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1317 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">':%y +'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1318 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1319 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1320 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_iunmap<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1321 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_insert_setting_off<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1322 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_one_key_mapping_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1323 </span><span class="Comment">    &quot; ------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1324 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">exists</span><span class="Statement">(</span><span class="Constant">'*Fixcp'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1325 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>FixAcp<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1326 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1327 </span><span class="Comment">    &quot; ------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1328 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1329 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1330 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1331 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_dynamic_End</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1332 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1333 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1334 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1335 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;C-E&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1336 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1337 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_wubi_non_stop</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1338 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">empty</span><span class="Statement">(</span>len<span class="Statement">(</span><span class="vimOperParen">s:keyboard_wubi</span><span class="Statement">)</span><span class="vimOperParen">%</span><span class="Constant">4</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1339 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;C-Y&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1340 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1341 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1342 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>end<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1343 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1344 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1345 </span><span class="Comment">&quot; ------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1346 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_iunmap</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1347 </span><span class="Comment">&quot; ------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1348 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>unmap_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">range</span><span class="Statement">(</span><span class="Constant">0</span>,<span class="Constant">9</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1349 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>unmap_list, s:valid_keys<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1350 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>unmap_list, keys<span class="Statement">(</span><span class="vimOperParen">s:punctuations</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1351 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>unmap_list, [<span class="Constant">'&lt;CR&gt;'</span><span class="vimOperParen">, </span><span class="Constant">'&lt;BS&gt;'</span><span class="vimOperParen">, </span><span class="Constant">'&lt;Space&gt;'</span><span class="vimOperParen">]</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1352 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>_<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">unmap_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1353 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'iunmap '</span><span class="Statement">.</span><span class="vimExecute"> </span>_
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1354 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1355 </span><span class="Comment">    &quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1356 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>unmap_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span><span class="Constant">'&lt;C-W&gt;'</span><span class="vimFuncBody">, </span><span class="Constant">'&lt;C-U&gt;'</span><span class="vimFuncBody">, </span><span class="Constant">'&lt;C-H&gt;'</span><span class="vimFuncBody">])</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1357 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>_<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">unmap_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1358 </span>        <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">hasmapto</span><span class="Statement">(</span><span class="Constant">'_'</span>, <span class="Constant">'i'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1359 </span>            <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'iunmap '</span><span class="Statement">.</span><span class="vimExecute"> </span>_
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1360 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1361 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1362 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1363 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold9")'>| </a><span class="lnr">1364 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold10' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold10")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold10")'>- </a><span class="Folded">1365 +--179 lines: ====  VimIM Punctuations    ====
</span><span class='fulltext'><span class="lnr">1365 </span><span class="Comment">&quot; ====  VimIM Punctuations    ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1366 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1367 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1368 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1369 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_punctuations</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1370 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1371 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1372 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'&amp;'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'※'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1373 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'&amp;'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'、'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1374 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'#'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'＃'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1375 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'%'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'％'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1376 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'$'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'￥'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1377 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'!'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'！'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1378 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'~'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'～'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1379 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'+'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'＋'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1380 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'*'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'﹡'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1381 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'@'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'・'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1382 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">':'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'：'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1383 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'('</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'（'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1384 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">')'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'）'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1385 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'{'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'〖'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1386 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'}'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'〗'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1387 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'['</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'【'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1388 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">']'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'】'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1389 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'^'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'……'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1390 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'_'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'——'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1391 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'&lt;'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'《'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1392 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'&gt;'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'》'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1393 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'-'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'－'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1394 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'='</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'＝'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1395 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">';'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'；'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1396 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">','</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'，'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1397 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'.'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'。'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1398 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_latex_suite<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1399 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">&quot;'&quot;</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">&quot;“”&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1400 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'`'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'‘’'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1401 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1402 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_do_search<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1403 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'?'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">'？'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1404 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1405 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations_all<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">copy</span><span class="Statement">(</span>s:punctuations<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1406 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">valid_keys</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1407 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>s:punctuations, char<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">'.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1408 </span>            <span class="Statement">unlet</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>punctuations<span class="vimFuncBody">[</span><span class="vimIsCommand">char</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1409 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1410 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1411 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1412 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1413 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1414 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_toggle_punctuation</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1415 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1416 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>chinese_punctuation<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">(</span>s:chinese_punctuation<span class="Statement">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody">%</span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1417 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_punctuation_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1418 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_punctuation_navigation_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1419 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1420 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1421 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1422 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1423 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_punctuation_on</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1424 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1425 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>punctuations<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">punctuations</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1426 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">erbi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1427 </span>        <span class="Statement">unlet</span><span class="vimFuncBody"> </span>punctuations<span class="vimFuncBody">[</span><span class="Constant">','</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1428 </span>        <span class="Statement">unlet</span><span class="vimFuncBody"> </span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'.'</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1429 </span>        <span class="Statement">unlet</span><span class="vimFuncBody"> </span>punctuations<span class="vimFuncBody">[</span><span class="Constant">'/'</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1430 </span>        <span class="Statement">unlet</span><span class="vimFuncBody"> </span>punctuations<span class="vimFuncBody">[</span><span class="Constant">';'</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1431 </span>        <span class="Statement">unlet</span><span class="vimFuncBody"> </span>punctuations<span class="vimFuncBody">[</span><span class="Constant">&quot;'&quot;</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1432 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1433 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>_<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">keys</span><span class="Statement">(</span>punctuations<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1434 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'inoremap&lt;silent&gt;&lt;expr&gt; '</span><span class="Statement">.</span>_<span class="Statement">.</span><span class="vimExecute">'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1435 </span><span class="Special">        \</span> <span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span>vimim_punctuation_mapping<span class="Statement">(</span><span class="Constant">&quot;'._.'&quot;</span><span class="Statement">)</span><span class="vimFuncBody">'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1436 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1437 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1438 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1439 </span><span class="Comment">&quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1440 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_punctuation_navigation_on</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1441 </span><span class="Comment">&quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1442 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_punctuation_navigation<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1443 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1444 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1445 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span><span class="Constant">',.=-;[]'</span>,<span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1446 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_do_search</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1447 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>hjkl_list, <span class="Constant">'/'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1448 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>hjkl_list, <span class="Constant">'?'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1449 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1450 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>_<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">hjkl_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1451 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'inoremap&lt;silent&gt;&lt;expr&gt; '</span><span class="Statement">.</span>_<span class="Statement">.</span><span class="vimExecute">'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1452 </span><span class="Special">        \</span> <span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span>vimim_punctuations_navigation<span class="Statement">(</span><span class="Constant">&quot;'._.'&quot;</span><span class="Statement">)</span><span class="vimFuncBody">'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1453 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1454 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1455 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1456 </span><span class="Comment">&quot; -----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1457 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_punctuations_navigation</span><span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1458 </span><span class="Comment">&quot; -----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1459 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1460 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1461 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1462 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-E&gt;\&lt;C-X&gt;\&lt;C-U&gt;\&lt;Down&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1463 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_space_key_for_yes()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1464 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1465 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_left_bracket()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1466 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1467 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_right_bracket()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1468 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;/&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1469 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_search_forward()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1470 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;?&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1471 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_search_backward()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1472 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[,.=\-]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1473 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">','</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'-'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1474 </span>                <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_reverse_pageup_pagedown</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1475 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1476 </span>                <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1477 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">-=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1478 </span>                <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1479 </span>            <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'.'</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">'='</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1480 </span>                <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_reverse_pageup_pagedown</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1481 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">-=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1482 </span>                <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1483 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1484 </span>                <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1485 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1486 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-E&gt;\&lt;C-R&gt;=g:vimim_ctrl_x_ctrl_u()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1487 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1488 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1489 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1490 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>hjkl<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_get_chinese_punctuation<span class="Statement">(</span>hjkl<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1491 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1492 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1493 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>hjkl<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1494 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1495 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1496 </span><span class="Comment">&quot; ------------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1497 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_get_chinese_punctuation</span><span class="Statement">(</span>english_punctuation<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1498 </span><span class="Comment">&quot; ------------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1499 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>value<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:english_punctuation</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1500 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_punctuation</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1501 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">has_key</span><span class="Statement">(</span>s:punctuations, value<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1502 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>current_positions<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getpos</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1503 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>start_column<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_positions<span class="vimFuncBody">[</span><span class="Constant">2</span><span class="vimFuncBody">]</span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1504 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span>current_positions[<span class="Constant">1</span><span class="vimOperParen">]</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1505 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody">[</span><span class="vimIsCommand">start_column</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1506 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1507 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>value<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">punctuations</span><span class="vimFuncBody">[</span><span class="vimIsCommand">value</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1508 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1509 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1510 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>value
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1511 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1512 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1513 </span><span class="Comment">&quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1514 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_punctuation_mapping</span><span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1515 </span><span class="Comment">&quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1516 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1517 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>value<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_get_chinese_punctuation<span class="Statement">(</span>a:key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1518 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1519 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>value<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;C-Y&gt;&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>value
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1520 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1521 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>value<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1522 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1523 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1524 </span><span class="Comment">&quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1525 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_smart_punctuation</span><span class="Statement">(</span>punctuations, key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1526 </span><span class="Comment">&quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1527 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1528 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>current_positions<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getpos</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1529 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>start_column<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_positions<span class="vimFuncBody">[</span><span class="Constant">2</span><span class="vimFuncBody">]</span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1530 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span>current_positions[<span class="Constant">1</span><span class="vimOperParen">]</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1531 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody">[</span><span class="vimIsCommand">start_column</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1532 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>char_before_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody">[</span><span class="vimIsCommand">start_column</span><span class="Statement">-</span><span class="Constant">2</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1533 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">(</span>char_before_before <span class="Statement">=~</span><span class="vimOperParen"> </span><span class="Constant">'\W'</span><span class="vimOperParen"> </span><span class="Statement">||</span><span class="vimOperParen"> char_before_before </span><span class="Statement">==</span><span class="vimOperParen"> </span><span class="Constant">''</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1534 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">has_key</span><span class="Statement">(</span>a:punctuations, char_before<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1535 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>replacement<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:punctuations</span><span class="vimFuncBody">[</span>char_before<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1536 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;BS&gt;&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>replacement
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1537 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">valid_key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1538 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1539 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1540 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>key
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1541 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1542 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold10")'>| </a><span class="lnr">1543 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold11' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold11")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold11")'>- </a><span class="Folded">1544 +--248 lines: ====  VimIM Smart Keys      ====
</span><span class='fulltext'><span class="lnr">1544 </span><span class="Comment">&quot; ====  VimIM Smart Keys      ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1545 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1546 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1547 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1548 </span><span class="Statement">function</span>! g:vimim_search_forward<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1549 </span><span class="Comment">&quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1550 </span>    <span class="Statement">return</span><span class=""> </span>s:vimim_search<span class="Statement">(</span><span class="Constant">&quot;/&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1551 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1552 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1553 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1554 </span><span class="Statement">function</span>! g:vimim_search_backward<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1555 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1556 </span>    <span class="Statement">return</span><span class=""> </span>s:vimim_search<span class="Statement">(</span><span class="Constant">&quot;?&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1557 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1558 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1559 </span><span class="Comment">&quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1560 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_search</span><span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1561 </span><span class="Comment">&quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1562 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_do_search<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1563 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1564 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1565 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>slash<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1566 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1567 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>slash<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_space_key_for_yes()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1568 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>slash<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_slash_search()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1569 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>slash<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1570 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1571 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>slash<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1572 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1573 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1574 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1575 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_first_char_current_line</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1576 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1577 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1578 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1579 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>line_no_leading_space<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>current_line,<span class="Constant">'^\s\+'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1580 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>first_non_blank_character<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>line_no_leading_space<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1581 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>second_character<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>line_no_leading_space<span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1582 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>first_non_blank_character<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'[/?]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1583 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">char2nr</span><span class="Statement">(</span>second_character<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">127</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1584 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>first_non_blank_character
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1585 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1586 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>char
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1587 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1588 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1589 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1590 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_slash_register</span><span class="Statement">(</span>chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1591 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1592 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1593 </span>        <span class="Statement">let</span><span class="vimFuncBody"> @/ </span><span class="Statement">=</span><span class="vimFuncBody"> @</span>_
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1594 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1595 </span>        <span class="Statement">let</span><span class="vimFuncBody"> @/ </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:chinese</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1596 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1597 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;Esc&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1598 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1599 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1600 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1601 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_remove_popup_word</span><span class="Statement">(</span>word<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1602 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1603 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:word<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">char2nr</span><span class="Statement">(</span><span class="vimOperParen">a:word</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">127</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1604 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1605 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1606 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>repeat_times<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>a:word<span class="Statement">)</span><span class="vimFuncBody">/</span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">multibyte</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1607 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>row_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">start_row_before</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1608 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>row_end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">line</span><span class="Statement">(</span><span class="Constant">'.'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1609 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>delete_chars<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1610 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>repeat_times<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">row_end</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="vimIsCommand">row_start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1611 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>delete_chars<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">repeat</span><span class="Statement">(</span><span class="Constant">&quot;\&lt;BS&gt;&quot;</span>, repeat_times<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1612 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1613 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>slash<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>delete_chars<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;Esc&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1614 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>slash<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1615 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1616 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1617 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1618 </span><span class="Statement">function</span>! g:vimim_slash_search<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1619 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1620 </span>    <span class="Statement">let</span><span class=""> </span>slash<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_first_char_current_line<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1621 </span>    <span class="Statement">if</span><span class=""> </span><span class="Identifier">empty</span><span class="Statement">(</span>slash<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1622 </span><span class="Comment">        &quot;-- case 1: search from popup menu, all modes</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1623 </span>        <span class="Statement">let</span><span class=""> </span>word<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_popup_word<span class="Statement">(</span>s:start_column_before<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1624 </span>        <span class="Statement">call</span><span class=""> </span>s:vimim_slash_register<span class="Statement">(</span>word<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1625 </span>        <span class="Statement">return</span><span class=""> </span>s:vimim_remove_popup_word<span class="Statement">(</span>word<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1626 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1627 </span><span class="Comment">        &quot;-- case 2: search by Enter with leading / or ?</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1628 </span>        <span class="Statement">let</span><span class=""> </span>current_line<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">getline</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1629 </span>        <span class="Statement">let</span><span class=""> </span>column_start<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">match</span><span class="Statement">(</span>current_line,<span class="Constant">'[/?]'</span><span class="Statement">)</span><span class=""> </span><span class="Statement">+</span><span class=""> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1630 </span>        <span class="Statement">let</span><span class=""> </span>word<span class=""> </span><span class="Statement">=</span><span class=""> </span>s:vimim_popup_word<span class="Statement">(</span>column_start<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1631 </span>        <span class="Statement">call</span><span class=""> </span>s:vimim_slash_register<span class="Statement">(</span>word<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1632 </span>        <span class="Statement">let</span><span class=""> </span>slash<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">&quot;\&lt;End&gt;\&lt;C-U&gt;\&lt;Esc&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1633 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1634 </span>    <span class="Statement">sil</span><span class="">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>slash<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1635 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1636 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1637 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1638 </span><span class="Statement">function</span>! g:vimim_left_bracket<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1639 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1640 </span>    <span class="Statement">return</span><span class=""> </span>s:vimim_square_bracket<span class="Statement">(</span><span class="Constant">&quot;[&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1641 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1642 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1643 </span><span class="Comment">&quot; -------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1644 </span><span class="Statement">function</span>! g:vimim_right_bracket<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1645 </span><span class="Comment">&quot; -------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1646 </span>    <span class="Statement">return</span><span class=""> </span>s:vimim_square_bracket<span class="Statement">(</span><span class="Constant">&quot;]&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1647 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1648 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1649 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1650 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_square_bracket</span><span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1651 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1652 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>bracket<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1653 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1654 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1655 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>left<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1656 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>right<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1657 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>bracket<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1658 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1659 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>left<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;Left&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1660 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>right<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;Right&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1661 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1662 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>backspace<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_bracket_backspace('</span><span class="Statement">.</span>i<span class="Statement">.</span><span class="Constant">')\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1663 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>yes<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_space_key_for_yes()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1664 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>bracket<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>yes<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Statement">left</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">backspace</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Statement">right</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1665 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1666 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>bracket<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1667 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1668 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1669 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1670 </span><span class="Statement">function</span>! g:vimim_bracket_backspace<span class="Statement">(</span>offset<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1671 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1672 </span>    <span class="Statement">let</span><span class=""> </span>column_end<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">col</span><span class="Statement">(</span><span class="Constant">'.'</span><span class="Statement">)-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1673 </span>    <span class="Statement">let</span><span class=""> </span>column_start<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="vimVar">s:start_column_before</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1674 </span>    <span class="Statement">let</span><span class=""> </span>range<span class=""> </span><span class="Statement">=</span><span class=""> </span>column_end<span class=""> </span><span class="Statement">-</span><span class=""> </span><span class="vimIsCommand">column_start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1675 </span>    <span class="Statement">let</span><span class=""> </span>repeat_times<span class=""> </span><span class="Statement">=</span><span class=""> </span>range<span class="">/</span><span class="vimVar">s:multibyte</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1676 </span>    <span class="Statement">let</span><span class=""> </span>repeat_times<span class=""> </span><span class="Statement">+=</span><span class=""> </span><span class="vimVar">a:offset</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1677 </span>    <span class="Statement">let</span><span class=""> </span>row_end<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">line</span><span class="Statement">(</span><span class="Constant">'.'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1678 </span>    <span class="Statement">let</span><span class=""> </span>row_start<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="vimVar">s:start_row_before</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1679 </span>    <span class="Statement">let</span><span class=""> </span>delete_char<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1680 </span>    <span class="Statement">if</span><span class=""> </span>repeat_times<span class=""> </span><span class="Statement">&gt;</span><span class=""> </span><span class="Constant">0</span><span class=""> </span><span class="Statement">&amp;&amp;</span><span class=""> </span><span class="vimIsCommand">row_end</span><span class=""> </span><span class="Statement">==</span><span class=""> </span><span class="vimIsCommand">row_start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1681 </span>        <span class="Statement">let</span><span class=""> </span>delete_char<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">repeat</span><span class="Statement">(</span><span class="Constant">&quot;\&lt;BS&gt;&quot;</span>, repeat_times<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1682 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1683 </span>    <span class="Statement">if</span><span class=""> </span>repeat_times<span class=""> </span><span class="Statement">&lt;</span><span class=""> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1684 </span>        <span class="Statement">let</span><span class=""> </span>current_line<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">getline</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1685 </span>        <span class="Statement">let</span><span class=""> </span>chinese<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">strpart</span><span class="Statement">(</span>current_line, column_start, s:multibyte<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1686 </span>        <span class="Statement">let</span><span class=""> </span>delete_char<span class=""> </span><span class="Statement">=</span><span class=""> </span>chinese
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1687 </span>        <span class="Statement">if</span><span class=""> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:offset<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1688 </span>            <span class="Statement">let</span><span class=""> </span>delete_char<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">&quot;\&lt;Right&gt;\&lt;BS&gt;【&quot;</span><span class="Statement">.</span>chinese<span class="Statement">.</span><span class="Constant">&quot;】\&lt;Left&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1689 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1690 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1691 </span>    <span class="Statement">return</span><span class=""> </span>delete_char
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1692 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1693 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1694 </span><span class="Comment">&quot; --------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1695 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">smart_enter</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1696 </span><span class="Comment">&quot; --------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1697 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1698 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_do_search</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:chinese_input_mode<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1699 </span><span class="Comment">        &quot; first check if line starting with / or ?</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1700 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>first_slash<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_first_char_current_line<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1701 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>first_slash<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1702 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_slash_search()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1703 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span>first_slash<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1704 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:chinese_input_mode<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1705 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1706 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1707 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1708 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;CR&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1709 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1710 </span>            <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>key<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1711 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1712 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1713 </span><span class="Comment">    &quot; do smart Enter for Chinese Input Mode</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1714 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>g:vimim_set_seamless<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1715 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1716 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;C-E&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1717 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_seamless_english_input<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1718 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">&quot; &quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1719 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1720 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1721 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span><span class="vimFuncBody">[</span><span class="Identifier">col</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)-</span><span class="Constant">2</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1722 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'\w'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1723 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>space<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1724 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1725 </span><span class="Comment">        &quot;-- the 1st Enter: seamless Chinese input</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1726 </span><span class="Comment">        &quot;-- the 2nd Enter: Enter as is</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1727 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">space</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1728 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_set_seamless()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1729 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">space</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1730 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>space<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1731 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;CR&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1732 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1733 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1734 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>key<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1735 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1736 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1737 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1738 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_smart_ctrl_h</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1739 </span><span class="Comment">&quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1740 </span><span class="Comment">    &quot; support intelligent sentence match for wozuixihuandeliulanqi</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1741 </span><span class="Comment">    &quot; first try maximum-match, after &lt;C-H&gt;, try minimum match</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1742 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;BS&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1743 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:chinese_input_mode<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1744 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>backspace<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1745 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">backspace</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1746 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-E&gt;\&lt;C-R&gt;=g:vimim_ctrl_x_ctrl_u()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1747 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">backspace</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1748 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>backspace<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1749 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;C-E&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1750 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1751 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1752 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>key<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1753 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1754 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1755 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1756 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_smart_backspace</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1757 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1758 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1759 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1760 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1761 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-E&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1762 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>trash_code_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1763 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span>g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1764 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1765 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span><span class="vimFuncBody">[</span><span class="Identifier">col</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)-</span><span class="Constant">2</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1766 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">valid_key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1767 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>trash_code_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1768 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;BS&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1769 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1770 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1771 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1772 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;BS&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1773 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1774 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>key<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1775 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1776 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1777 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1778 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_ctrl_x_ctrl_u_bs</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1779 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1780 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1781 </span>    <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">pumvisible</span><span class="Statement">()</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="Statement">&gt;</span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1782 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">trash_code_flag</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1783 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>trash_code_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1784 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1785 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-X&gt;\&lt;C-U&gt;\&lt;BS&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1786 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1787 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1788 </span>    <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>key<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1789 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1790 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold11")'>| </a><span class="lnr">1791 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold12' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold12")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold12")'>- </a><span class="Folded">1792 +--349 lines: ====  VimIM Popup Menu      ====
</span><span class='fulltext'><span class="lnr">1792 </span><span class="Comment">&quot; ====  VimIM Popup Menu      ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1793 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1794 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1795 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1796 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_pair_list</span><span class="Statement">(</span>matched_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1797 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1798 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>matched_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:matched_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1799 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>s:private_matches<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1800 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>matched_list, s:private_matches, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1801 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>private_matches<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1802 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1803 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>matched_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1804 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1805 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1806 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>pair_matched_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1807 </span><span class="Comment">    &quot; ----------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1808 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">matched_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1809 </span><span class="Comment">    &quot; ----------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1810 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>line<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1811 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1812 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1813 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">english_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1814 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>line,<span class="Constant">'#'</span><span class="vimOperParen">,</span><span class="Constant">' '</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1815 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1816 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">localization</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1817 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_i18n_read<span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1818 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1819 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>oneline_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>line, <span class="Constant">'\s\+'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1820 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>oneline_list, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1821 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">oneline_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1822 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>pair_matched_list, menu <span class="Statement">.</span><span class="Constant">' '</span><span class="Statement">.</span><span class="vimOperParen"> chinese</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1823 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1824 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1825 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>pair_matched_list
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1826 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1827 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1828 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1829 </span><span class="Statement">function</span>! g:vimim_reset_after_insert<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1830 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1831 </span>    <span class="Statement">let</span><span class=""> </span>s:seamless_positions<span class=""> </span><span class="Statement">=</span><span class=""> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1832 </span>    <span class="Statement">let</span><span class=""> </span>s:pageup_pagedown<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1833 </span>    <span class="Statement">let</span><span class=""> </span>s:menu_reverse<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1834 </span>    <span class="Statement">let</span><span class=""> </span>s:keyboard_wubi<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1835 </span>    <span class="Statement">return</span><span class=""> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1836 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1837 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1838 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1839 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_pageup_pagedown</span><span class="Statement">(</span>matched_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1840 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1841 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>matched_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:matched_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1842 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>page<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> &amp;</span>pumheight<span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1843 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>page<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1844 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>page<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">8</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1845 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1846 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:pageup_pagedown<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span><span class="vimOperParen">matched_list</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span>page<span class="Statement">+</span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1847 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1848 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>matched_list
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1849 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1850 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>shift<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pageup_pagedown</span><span class="vimFuncBody"> * </span><span class="vimIsCommand">page</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1851 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>matched_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1852 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">page</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1853 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>shift<span class="vimFuncBody"> </span><span class="Statement">&gt;=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">length</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="vimIsCommand">shift</span><span class="vimFuncBody">*</span><span class="Statement">(-</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">length</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1854 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1855 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>matched_list
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1856 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1857 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>partition<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>shift
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1858 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>shift<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1859 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>partition<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">+</span><span class="vimFuncBody"> </span><span class="vimIsCommand">shift</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1860 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1861 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>A<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>matched_list<span class="vimFuncBody">[: </span><span class="vimIsCommand">partition</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1862 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>B<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>matched_list<span class="vimFuncBody">[</span><span class="vimIsCommand">partition</span><span class="vimFuncBody"> :]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1863 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>matched_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>B<span class="vimFuncBody"> </span><span class="Statement">+</span><span class="vimFuncBody"> </span><span class="vimIsCommand">A</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1864 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1865 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>matched_list
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1866 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1867 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1868 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1869 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_popupmenu_list</span><span class="Statement">(</span>matched_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1870 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1871 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>matched_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:matched_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1872 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>matched_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1873 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1874 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1875 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">menu_reverse</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1876 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>matched_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">reverse</span><span class="Statement">(</span>matched_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1877 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1878 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>matched_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_pageup_pagedown<span class="Statement">(</span>matched_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1879 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>label<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1880 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_number_as_navigation<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1881 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>label<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1882 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1883 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>popupmenu_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1884 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1885 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">keyboard_leading_zero</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1886 </span><span class="Comment">    &quot; ----------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1887 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>pair<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">matched_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1888 </span><span class="Comment">    &quot; ----------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1889 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>complete_items<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1890 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>pairs<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>pair<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1891 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>pairs<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1892 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1893 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1894 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>pairs, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1895 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">unicode_menu_display_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1896 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>complete_items<span class="vimFuncBody">[</span><span class="Constant">&quot;menu&quot;</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1897 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1898 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>pairs, <span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1899 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_menu_extra_text</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1900 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>extra_text<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1901 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_unicode_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1902 </span><span class="Special">            \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">empty</span><span class="Statement">(</span>match<span class="Statement">(</span><span class="vimOperParen">extra_text, </span><span class="Constant">'^\d\{4}$'</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1903 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>unicode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'u%04x'</span>, char2nr<span class="Statement">(</span><span class="vimOperParen">chinese</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1904 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>extra_text<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span><span class="Statement">.</span><span class="Constant">'　'</span><span class="Statement">.</span>unicode
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1905 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1906 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>complete_items<span class="vimFuncBody">[</span><span class="Constant">&quot;menu&quot;</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span>extra_text
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1907 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1908 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_menu_label</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1909 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>abbr<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'%2s'</span>,label<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\t&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>chinese
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1910 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>complete_items<span class="vimFuncBody">[</span><span class="Constant">&quot;abbr&quot;</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span>abbr
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1911 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1912 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>tail<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1913 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'[.]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1914 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>dot<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">stridx</span><span class="Statement">(</span>keyboard, <span class="Constant">'.'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1915 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>tail<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, dot<span class="Statement">+</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1916 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1917 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>tail<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, len<span class="Statement">(</span><span class="vimOperParen">menu</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1918 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1919 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">!=#</span><span class="vimFuncBody"> </span><span class="Constant">'vim'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1920 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody">  </span>tail
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1921 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1922 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>complete_items<span class="vimFuncBody">[</span><span class="Constant">&quot;word&quot;</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span>chinese
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1923 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>complete_items<span class="vimFuncBody">[</span><span class="Constant">&quot;dup&quot;</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1924 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>label<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1925 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>popupmenu_list, complete_items<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1926 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1927 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboards<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1928 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>label<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1929 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span><span class="Constant">''</span><span class="vimFuncBody">,</span><span class="Constant">''</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1930 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1931 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>popupmenu_list
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1932 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1933 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1934 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1935 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_datafile_range</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1936 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1937 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_datafile<span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1938 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span><span class="vimOperParen">a:keyboard</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1939 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1940 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1941 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>ranges<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_search_boundary<span class="Statement">(</span>lines, a:keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1942 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>ranges<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1943 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1944 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>ranges<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1945 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>ranges<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_search_boundary<span class="Statement">(</span>sort<span class="Statement">(</span><span class="vimOperParen">lines</span><span class="Statement">)</span><span class="vimOperParen">, a:keyboard</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1946 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>ranges<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1947 </span>            <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1948 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1949 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_update_datafile<span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1950 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_save_datafile<span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1951 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1952 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1953 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody">[</span><span class="Identifier">get</span><span class="Statement">(</span>ranges,<span class="Constant">0</span><span class="Statement">)</span><span class="vimFuncBody"> : </span><span class="Identifier">get</span><span class="Statement">(</span><span class="vimOperParen">ranges,</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1954 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1955 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1956 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1957 </span><span class="Comment">&quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1958 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_search_boundary</span><span class="Statement">(</span>lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1959 </span><span class="Comment">&quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1960 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span><span class="vimOperParen">a:keyboard</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1961 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1962 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1963 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>first_char_typed<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>a:keyboard,<span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1964 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">current_datafile_has_dot</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">first_char_typed</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;.&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1965 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>first_char_typed<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1966 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1967 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>first_char_typed
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1968 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:lines, patterns<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1969 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1970 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1971 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1972 </span><span class="Comment">    &quot; add boundary to datafile search by exact one letter</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1973 </span><span class="Comment">    &quot; ---------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1974 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>ranges<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1975 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>ranges, match_start<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1976 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_next<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>match_start
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1977 </span><span class="Comment">    &quot; allow empty lines at the end of datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1978 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>last_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:lines</span><span class="vimFuncBody">[</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1979 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>len_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1980 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>solid_last_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>last_line,<span class="Constant">'\s'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1981 </span>    <span class="Statement">while</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>solid_last_line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1982 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>len_lines<span class="vimFuncBody"> </span><span class="Statement">-=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1983 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>last_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:lines</span><span class="vimFuncBody">[</span>len_lines<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1984 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>solid_last_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>last_line,<span class="Constant">'\s'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1985 </span>    <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1986 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>first_char_last_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>last_line,<span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1987 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>first_char_typed<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="vimIsCommand">first_char_last_line</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1988 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>match_next<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>a:lines<span class="Statement">)-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1989 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1990 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern_next<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^[^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>first_char_typed<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">']'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1991 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:lines, pattern_next, match_start<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1992 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1993 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>match_next<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>result
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1994 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1995 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1996 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>ranges, match_next<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1997 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">match_next</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1998 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>ranges<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span><span class="Constant">'the_datafile_is_not_sorted_well'</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">1999 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2000 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>ranges
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2001 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2002 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2003 </span><span class="Comment">&quot; ---------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2004 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_exact_match</span><span class="Statement">(</span>lines, keyboard, start<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2005 </span><span class="Comment">&quot; ---------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2006 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2007 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2008 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2009 </span><span class="Special">    \</span><span class="Statement">||</span> keyboard<span class="vimFuncBody"> </span><span class="Statement">!=#</span><span class="vimFuncBody"> </span><span class="Identifier">tolower</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2010 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2011 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2012 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>words_limit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">128</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2013 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2014 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>match_start
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2015 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^\('</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>keyboard<span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\)\@!'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2016 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:lines, patterns, match_start<span class="Statement">)-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2017 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="vimIsCommand">match_start</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2018 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:lines</span><span class="vimFuncBody">[</span>match_start<span class="vimFuncBody"> : </span><span class="vimIsCommand">match_end</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2019 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2020 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_quick_key</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2021 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>list_length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="vimIsCommand">match_start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2022 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>do_search_on_word<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2023 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>quick_limit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2024 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span>quick_limit
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2025 </span><span class="Special">        \</span><span class="Statement">||</span> list_length<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">words_limit</span><span class="vimFuncBody">*</span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2026 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>do_search_on_word<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2027 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2028 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>a:lines[match_start : result],<span class="Constant">''</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2029 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>chinese,<span class="Constant">'\p\+'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2030 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>chinese<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span>words_limit<span class="vimFuncBody">*</span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2031 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>do_search_on_word<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2032 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2033 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2034 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>do_search_on_word<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2035 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^\('</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&gt;\)\@!'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2036 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:lines, patterns, match_start<span class="Statement">)-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2037 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2038 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2039 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>result<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2040 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>match_end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>match_start
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2041 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">result</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">match_start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2042 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>match_end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>result
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2043 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>match_end<span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="vimIsCommand">match_start</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">words_limit</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2044 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>match_end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">+</span><span class="vimFuncBody"> </span><span class="vimIsCommand">words_limit</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2045 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2046 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:lines</span><span class="vimFuncBody">[</span>match_start<span class="vimFuncBody"> : </span><span class="vimIsCommand">match_end</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2047 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2048 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2049 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2050 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2051 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_fuzzy_match</span><span class="Statement">(</span>lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2052 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2053 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2054 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2055 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2056 </span><span class="Special">    \</span><span class="Statement">||</span> keyboard<span class="vimFuncBody"> </span><span class="Statement">!=#</span><span class="vimFuncBody"> </span><span class="Identifier">tolower</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2057 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2058 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2059 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_fuzzy_pattern<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2060 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>a:lines, <span class="Constant">'v:val =~ patterns'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2061 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">english_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2062 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>results, <span class="Constant">'v:val !~ &quot;#$&quot;'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2063 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2064 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2065 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_filter<span class="Statement">(</span>results, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2066 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2067 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2068 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2069 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2070 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2071 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_fuzzy_pattern</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2072 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2073 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2074 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzy<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\l\+'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2075 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s:vimim_dummy_shuangpin<span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2076 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzy<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'.*'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2077 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2078 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,len<span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">==#</span><span class="vimFuncBody"> </span><span class="Constant">'.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2079 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="vimOperParen">,len</span><span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2080 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzy<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'.*'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2081 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2082 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2083 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzies<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>split<span class="Statement">(</span><span class="vimOperParen">keyboard,</span><span class="Constant">'\ze'</span><span class="Statement">)</span><span class="vimOperParen">, fuzzy</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2084 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>fuzzy<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\d\='</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2085 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">start</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>fuzzies<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Statement">end</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2086 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>patterns
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2087 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2088 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2089 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2090 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_filter</span><span class="Statement">(</span>results, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2091 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2092 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:results</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2093 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">((</span>substitute<span class="Statement">(</span><span class="vimOperParen">a:keyboard,</span><span class="Constant">'\A'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="Statement">)))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2094 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>length<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> &amp;</span>encoding<span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;utf-8&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2095 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:results</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2096 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2097 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>filter_length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2098 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s:vimim_dummy_shuangpin<span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2099 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>filter_length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody">/</span><span class="Constant">2</span><span class="vimFuncBody"> |&quot; </span><span class="Constant">4</span><span class="vimFuncBody">_char </span><span class="Statement">=&gt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span><span class="vimFuncBody">_chinese</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2100 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">5</span><span class="vimFuncBody">                |&quot; </span><span class="Constant">4</span><span class="vimFuncBody">_char </span><span class="Statement">=&gt;</span><span class="vimFuncBody"> </span><span class="Constant">4</span><span class="vimFuncBody">_chinese</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2101 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>filter_length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>length
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2102 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2103 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>filter_length<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2104 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'\s\+.\{'</span><span class="Statement">.</span><span class="vimFuncBody"> </span>filter_length<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="Constant">'}$'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2105 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>results, <span class="Constant">'v:val =~ patterns'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2106 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2107 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2108 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2109 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2110 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2111 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_dummy_shuangpin</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2112 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2113 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_dummy_shuangpin<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2114 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>s:pinyin_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2115 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2116 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2117 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2118 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>sheng_mu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[aeiouv]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2119 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>dummy_shuangpin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2120 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>a:keyboard, <span class="Constant">'\(..\)\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2121 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboards</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2122 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>key<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2123 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2124 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2125 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>split<span class="Statement">(</span><span class="vimOperParen">key,</span><span class="Constant">'\zs'</span><span class="Statement">)</span><span class="vimOperParen">,</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2126 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="vimIsCommand">sheng_mu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2127 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>dummy_shuangpin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2128 </span>            <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2129 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2130 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>split<span class="Statement">(</span><span class="vimOperParen">key,</span><span class="Constant">'\zs'</span><span class="Statement">)</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2131 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="vimIsCommand">sheng_mu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2132 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>dummy_shuangpin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2133 </span>            <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2134 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2135 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>dummy_shuangpin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2136 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2137 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>dummy_shuangpin
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2138 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2139 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold12")'>| </a><span class="lnr">2140 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold13' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold13")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold13")'>- </a><span class="Folded">2141 +--159 lines: ====  VimIM Sentence Match  ====
</span><span class='fulltext'><span class="lnr">2141 </span><span class="Comment">&quot; ====  VimIM Sentence Match  ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2142 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2143 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2144 </span><span class="Comment">&quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2145 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_keyboard_analysis</span><span class="Statement">(</span>lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2146 </span><span class="Comment">&quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2147 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;enjoy.1010.2523.4498.7429.girl&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2148 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2149 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2150 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2151 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">current_datafile_has_dot</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2152 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">privates_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2153 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>s:private_matches<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2154 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2155 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2156 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2157 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>blocks<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2158 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'[.]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2159 </span><span class="Comment">        &quot; step 1: try to break up dot-separated sentence</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2160 </span><span class="Comment">        &quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2161 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>blocks<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_keyboard_dot_by_dot<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2162 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>blocks<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2163 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>blocks, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2164 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2165 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2166 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:lines, <span class="Constant">'^'</span><span class="Statement">.</span><span class="vimOperParen">keyboard</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2167 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2168 </span><span class="Comment">        &quot; step 2: try to match DIY 4corner || pinyin+4corner</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2169 </span><span class="Comment">        &quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2170 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2171 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>blocks<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_wubi_whole_match<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2172 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2173 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>blocks<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_4corner_whole_match<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2174 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2175 </span><span class="Comment">        &quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2176 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>blocks<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2177 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>blocks<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_whole_match<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2178 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2179 </span><span class="Comment">        &quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2180 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>blocks<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2181 </span><span class="Comment">            &quot; step 3: try to break up long whole sentence</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2182 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>blocks<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_sentence_whole_match<span class="Statement">(</span>a:lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2183 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2184 </span><span class="Comment">        &quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2185 </span>        <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">empty</span><span class="Statement">(</span>blocks<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2186 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>blocks, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2187 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2188 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2189 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2190 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2191 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2192 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2193 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_keyboard_dot_by_dot</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2194 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2195 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_match_dot_after_dot<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2196 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2197 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2198 </span><span class="Comment">    &quot; --------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2199 </span><span class="Comment">    &quot; demo meet.teacher.say.hello.sssjj.zdolo.hhyy.sloso.nfofo</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2200 </span><span class="Comment">    &quot; --------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2201 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>a:keyboard, <span class="Constant">'[.]'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2202 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboards<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2203 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2204 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2205 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboards
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2206 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2207 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2208 </span><span class="Comment">&quot; -----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2209 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_sentence_whole_match</span><span class="Statement">(</span>lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2210 </span><span class="Comment">&quot; -----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2211 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_match_word_after_word<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2212 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2213 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2214 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'\d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2215 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">5</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2216 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2217 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2218 </span><span class="Comment">    &quot; ---------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2219 </span><span class="Comment">    &quot; demo jiandaolaoshiwenshenghao wozuixihuandeliulanqi</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2220 </span><span class="Comment">    &quot; ---------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2221 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2222 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2223 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:lines, pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2224 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2225 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2226 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2227 </span><span class="Comment">    &quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2228 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>min<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2229 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>max<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2230 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>block<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2231 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>last_part<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2232 </span><span class="Comment">    &quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2233 </span>    <span class="Statement">while</span><span class="vimFuncBody"> </span>max<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">min</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2234 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>max<span class="vimFuncBody"> </span><span class="Statement">-=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2235 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>max
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2236 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">backspace</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2237 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>min<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2238 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>min
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2239 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2240 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>block<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, <span class="Constant">0</span><span class="vimOperParen">, position</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2241 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>block<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2242 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:lines, pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2243 </span>        <span class="Statement">if</span><span class="vimFuncBody">  </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2244 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>last_part<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, position<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2245 </span>            <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2246 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2247 </span>    <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2248 </span><span class="Comment">    &quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2249 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>blocks<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2250 </span>    <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">empty</span><span class="Statement">(</span>block<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2251 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> !<span class="Identifier">empty</span><span class="Statement">(</span>last_part<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2252 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> block<span class="Statement">.</span><span class="vimIsCommand">last_part</span><span class="vimFuncBody"> </span><span class="Statement">==#</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2253 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>blocks, block<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2254 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>blocks, last_part<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2255 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2256 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>blocks
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2257 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2258 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2259 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2260 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_keyboard_block_by_block</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2261 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2262 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\&lt;C-Y&gt;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2263 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2264 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>key
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2265 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2266 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>backspace<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2267 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_ctrl_x_ctrl_u()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2268 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>key
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2269 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2270 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2271 </span><span class="Comment">&quot; -------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2272 </span><span class="Statement">function</span>! g:vimim_ctrl_x_ctrl_u<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2273 </span><span class="Comment">&quot; -------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2274 </span>    <span class="Statement">let</span><span class=""> </span>key<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2275 </span>    <span class="Statement">let</span><span class=""> </span>char_before<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Identifier">getline</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span><span class="">[</span><span class="Identifier">col</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)-</span><span class="Constant">2</span><span class="">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2276 </span>    <span class="Statement">if</span><span class=""> </span>char_before<span class=""> </span><span class="Statement">=~</span><span class=""> </span>s:valid_key
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2277 </span>        <span class="Statement">let</span><span class=""> </span>key<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">'\&lt;C-X&gt;\&lt;C-U&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2278 </span>        <span class="Statement">if</span><span class=""> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_sexy_input_style<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2279 </span>            <span class="Statement">let</span><span class=""> </span>key<span class=""> </span><span class="Statement">.=</span><span class=""> </span><span class="Constant">'\&lt;C-R&gt;=g:vimim_menu_select()\&lt;CR&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2280 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2281 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2282 </span>    <span class="Statement">sil</span><span class="">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>key<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2283 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2284 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2285 </span><span class="Comment">&quot; -----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2286 </span><span class="Statement">function</span>! g:vimim_menu_select<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2287 </span><span class="Comment">&quot; -----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2288 </span>    <span class="Statement">let</span><span class=""> </span>select_not_insert<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2289 </span>    <span class="Statement">if</span><span class=""> </span><span class="Identifier">pumvisible</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2290 </span>        <span class="Statement">let</span><span class=""> </span>select_not_insert<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">'\&lt;C-P&gt;\&lt;Down&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2291 </span>        <span class="Statement">if</span><span class=""> </span>s:insert_without_popup_flag<span class=""> </span><span class="Statement">&gt;</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2292 </span>           <span class="Statement">let</span><span class=""> </span>s:insert_without_popup_flag<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2293 </span>           <span class="Statement">let</span><span class=""> </span>select_not_insert<span class=""> </span><span class="Statement">=</span><span class=""> </span><span class="Constant">'\&lt;C-Y&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2294 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2295 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2296 </span>    <span class="Statement">sil</span><span class="">!</span><span class="Statement">exe</span> <span class="Constant">'sil!return &quot;'</span><span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span>select_not_insert<span class="vimExecute"> </span><span class="Statement">.</span><span class="vimExecute"> </span><span class="Constant">'&quot;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2297 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2298 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold13")'>| </a><span class="lnr">2299 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold14' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold14")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold14")'>- </a><span class="Folded">2300 +--381 lines: ====  VimIM Datafile Update ====
</span><span class='fulltext'><span class="lnr">2300 </span><span class="Comment">&quot; ====  VimIM Datafile Update ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2301 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2302 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2303 </span><span class="Comment">&quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2304 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_chinese_before</span><span class="Statement">(</span>row, column<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2305 </span><span class="Comment">&quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2306 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>start_row_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">start_row_before</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2307 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>char_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">start_column_before</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2308 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>start_row<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:row</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2309 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>start_column<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:column</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2310 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>char_end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>start_column<span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2311 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2312 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>start_row_before<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="vimIsCommand">start_row</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">char_end</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">char_start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2313 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span>start_row<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2314 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody">[</span><span class="vimIsCommand">char_start</span><span class="vimFuncBody"> : </span><span class="vimIsCommand">char_end</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2315 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>start_row<span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="vimIsCommand">start_row_before</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2316 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>previous_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span>start_row_before<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2317 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char_end<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>previous_line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2318 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>previous_line<span class="vimFuncBody">[</span><span class="vimIsCommand">char_start</span><span class="vimFuncBody"> : </span><span class="vimIsCommand">char_end</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2319 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2320 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>s:keyboards, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2321 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>key<span class="Statement">)&gt;</span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'\l'</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span><span class="vimOperParen">chinese</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2322 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>chinese,<span class="Constant">'\p\+'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2323 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2324 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>chinese
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2325 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2326 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2327 </span><span class="Comment">&quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2328 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_new_order_in_memory</span><span class="Statement">(</span>keyboards<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2329 </span><span class="Comment">&quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2330 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_datafile<span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2331 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>a:keyboards,<span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2332 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>a:keyboards,<span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2333 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2334 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">char2nr</span><span class="Statement">(</span>chinese<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">127</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2335 </span><span class="Special">    \</span><span class="Statement">||</span> keyboard<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">valid_key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2336 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2337 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2338 </span><span class="Comment">    &quot;&quot;&quot; step 1/6: modify datafile in memory based on usage</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2339 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2340 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, patterns<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2341 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2342 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2343 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2344 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>insert_index<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>matched
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2345 </span><span class="Comment">    &quot;&quot;&quot; step 2/6: save the first item which is to be set fixed</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2346 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>first_matched_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>lines, matched<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2347 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>first_fixed_item<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>split<span class="Statement">(</span><span class="vimOperParen">first_matched_line</span><span class="Statement">)</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2348 </span><span class="Comment">    &quot;&quot;&quot; step 3/6: remove all entries matching key from datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2349 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>one_line_chinese_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2350 </span>    <span class="Statement">while</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2351 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>old_item<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>lines, matched<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2352 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>values<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>old_item<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2353 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>one_line_chinese_list, values[<span class="Constant">1</span><span class="vimOperParen">:]</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2354 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, patterns, insert_index<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2355 </span>    <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2356 </span><span class="Comment">    &quot;&quot;&quot; step 4/6: make a new order list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2357 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2358 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>used<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>one_line_chinese_list, chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2359 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>used<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2360 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>head<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>one_line_chinese_list, used<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2361 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">insert</span><span class="Statement">(</span>one_line_chinese_list, head<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2362 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2363 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>one_line_chinese_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2364 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2365 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2366 </span><span class="Comment">    &quot;&quot;&quot; step 5/6: made the first candidate fixed</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2367 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_first_candidate_fix</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2368 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>index<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>one_line_chinese_list, first_fixed_item<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2369 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>first_fixed_item<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>one_line_chinese_list, index<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2370 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">insert</span><span class="Statement">(</span>one_line_chinese_list, first_fixed_item<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2371 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2372 </span><span class="Comment">    &quot;&quot;&quot; step 6/6: insert the new order list into memory</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2373 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>new_item<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="Constant">' '</span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>one_line_chinese_list<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2374 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">insert</span><span class="Statement">(</span>lines, new_item, insert_index<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2375 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>lines
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2376 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2377 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2378 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2379 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_load_datafile</span><span class="Statement">(</span>reload_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2380 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2381 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:lines_datafile<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">a:reload_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2382 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>s:current_datafile<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2383 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">filereadable</span><span class="Statement">(</span>s:current_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2384 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>lines_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">readfile</span><span class="Statement">(</span>s:current_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2385 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2386 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>s:four_corner_datafile<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2387 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:lines_4corner_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2388 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>lines_4corner_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_4corner<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2389 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2390 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>s:lines_4corner_datafile<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2391 </span><span class="Special">            \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">len</span><span class="Statement">(</span>s:lines_datafile<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2392 </span>                <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>s:lines_datafile, s:lines_4corner_datafile, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2393 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_diy_pinyin_4corner<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">999</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2394 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2395 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2396 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2397 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">lines_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2398 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2399 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2400 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2401 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_save_input_history</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2402 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2403 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>frequency<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_save_input_history_frequency</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2404 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>frequency<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2405 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>frequency<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">(</span>frequency<span class="Statement">&lt;</span><span class="Constant">12</span><span class="Statement">)</span><span class="vimFuncBody"> ? </span><span class="Constant">12</span><span class="vimFuncBody"> : </span>frequency
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2406 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">keyboard_counts</span><span class="Statement">&gt;</span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:keyboard_counts % frequency<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2407 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_save_datafile<span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2408 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2409 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2410 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2411 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2412 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2413 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_save_datafile</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2414 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2415 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2416 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>s:lines_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2417 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_diy_pinyin_4corner</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">999</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2418 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2419 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2420 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">filewritable</span><span class="Statement">(</span>s:current_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2421 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">writefile</span><span class="Statement">(</span>a:lines, s:current_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2422 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2423 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:localization<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_save_input_history_frequency</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2424 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>warning<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'performance hit if &amp;encoding &amp; datafile differs!'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2425 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2426 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2427 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2428 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2429 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_update_datafile</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2430 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2431 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span><span class="vimOperParen">s:lines_datafile</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2432 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2433 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2434 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>lines_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2435 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2436 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2437 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2438 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2439 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_save</span><span class="Statement">(</span>entry<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2440 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2441 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:entry<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2442 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2443 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2444 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>entries<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2445 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>entry_split_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>a:entry,<span class="Constant">'\n'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2446 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>entry<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">entry_split_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2447 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>has_space<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>entry, <span class="Constant">'\s'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2448 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>has_space<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2449 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2450 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2451 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>words<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>entry<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2452 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>words<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2453 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2454 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2455 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>words, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2456 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">menu</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">valid_key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2457 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2458 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2459 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">char2nr</span><span class="Statement">(</span>get<span class="Statement">(</span><span class="vimOperParen">words,</span><span class="Constant">0</span><span class="Statement">))</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">128</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2460 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2461 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2462 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="Constant">' '</span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>words, <span class="Constant">' '</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2463 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_i18n_write<span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2464 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>entries, line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2465 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2466 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_insert_entry<span class="Statement">(</span>s:vimim_load_datafile<span class="Statement">(</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimOperParen">, entries</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2467 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_update_datafile<span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2468 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_save_datafile<span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2469 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2470 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2471 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2472 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_insert_entry</span><span class="Statement">(</span>lines, entries<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2473 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2474 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2475 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>len_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2476 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span><span class="vimOperParen">a:entries</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2477 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2478 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2479 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>sort_before_save<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2480 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2481 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>entry<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">a:entries</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2482 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>entry<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'$'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2483 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2484 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2485 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2486 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2487 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>split<span class="Statement">(</span><span class="vimOperParen">entry</span><span class="Statement">)</span><span class="vimOperParen">,</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2488 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>menu<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2489 </span>        <span class="Statement">while</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2490 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>one_less<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>menu, <span class="Constant">0</span><span class="vimOperParen">, length</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2491 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">-=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2492 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, <span class="Constant">'^'</span><span class="Statement">.</span><span class="vimOperParen">one_less</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2493 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2494 </span>                <span class="Statement">if</span><span class="vimFuncBody"> </span>length<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2495 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>only_char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>one_less, <span class="Constant">0</span><span class="vimOperParen">, </span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2496 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">char2nr</span><span class="Statement">(</span>only_char<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2497 </span>                    while<span class="vimFuncBody"> </span><span class="Statement">(</span>char <span class="Statement">&gt;=</span><span class="vimOperParen"> char2nr</span><span class="Statement">(</span><span class="Constant">'a'</span><span class="Statement">)</span><span class="vimOperParen"> </span><span class="Statement">&amp;&amp;</span><span class="vimOperParen"> char </span><span class="Statement">&lt;</span><span class="vimOperParen"> char2nr</span><span class="Statement">(</span><span class="Constant">'z'</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2498 </span>                        <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Identifier">nr2char</span><span class="Statement">(</span>char<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2499 </span>                        <span class="Statement">let</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, patterns<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2500 </span>                        <span class="Statement">let</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">-=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2501 </span>                        <span class="Statement">if</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2502 </span>                            <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^\('</span><span class="Statement">.</span><span class="Identifier">nr2char</span><span class="Statement">(</span>char<span class="Statement">+</span><span class="Constant">1</span><span class="Statement">).</span><span class="Constant">'\)\@!'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2503 </span>                            <span class="Statement">let</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>position
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2504 </span>                            <span class="Statement">let</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, pattern, matched<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2505 </span>                            <span class="Statement">if</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2506 </span>                                <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2507 </span>                            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2508 </span>                        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2509 </span>                    <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2510 </span>                <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2511 </span>                <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2512 </span>            <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2513 </span>                <span class="Statement">if</span><span class="vimFuncBody"> </span>length<span class="Statement">+</span><span class="Constant">1</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>menu<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2514 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Statement">menu</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'.\&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2515 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>next<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, patterns, matched<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2516 </span>                    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">next</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2517 </span>                        <span class="Statement">for</span><span class="vimFuncBody"> </span>i<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">reverse</span><span class="Statement">(</span>range<span class="Statement">(</span><span class="vimOperParen">matched, next</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2518 </span>                            <span class="Statement">let</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>i
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2519 </span>                            <span class="Statement">if</span><span class="vimFuncBody"> </span>position<span class="Statement">&lt;</span><span class="vimIsCommand">len_lines</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">entry</span><span class="Statement">&lt;</span><span class="vimIsCommand">lines</span><span class="vimFuncBody">[</span><span class="vimIsCommand">position</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2520 </span>                                <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2521 </span>                            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2522 </span>                        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2523 </span>                        <span class="Statement">if</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">matched</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2524 </span>                            <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2525 </span>                        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2526 </span>                    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2527 </span>                <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2528 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^\('</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>one_less<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\)\@!'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2529 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, patterns, matched<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2530 </span>                <span class="Statement">if</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2531 </span>                    <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2532 </span>                <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2533 </span>                    <span class="Statement">let</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>matched<span class="Statement">+</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2534 </span>                    <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2535 </span>                <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2536 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2537 </span>        <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2538 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>position<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2539 </span><span class="Special">        \</span><span class="Statement">||</span> <span class="Statement">(</span>position<span class="Statement">-</span><span class="Constant">1</span><span class="Statement">&lt;</span><span class="vimOperParen">len_lines </span><span class="Statement">&amp;&amp;</span><span class="vimOperParen"> lines[position</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimOperParen">]</span><span class="Statement">&gt;</span><span class="vimOperParen">entry</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2540 </span><span class="Special">        \</span><span class="Statement">||</span> <span class="Statement">(</span>position<span class="Statement">-</span><span class="Constant">1</span><span class="Statement">&lt;</span><span class="vimOperParen">len_lines </span><span class="Statement">&amp;&amp;</span><span class="vimOperParen"> entry</span><span class="Statement">&gt;</span><span class="vimOperParen">lines[position</span><span class="Statement">+</span><span class="Constant">1</span><span class="vimOperParen">]</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2541 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>sort_before_save<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2542 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2543 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">insert</span><span class="Statement">(</span>lines, entry, position<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2544 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2545 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span>len_lines
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2546 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2547 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2548 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>sort_before_save<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2549 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">sort</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2550 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2551 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>lines
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2552 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2553 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2554 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2555 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_build_reverse_cache</span><span class="Statement">(</span>chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2556 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2557 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_datafile<span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2558 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2559 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2560 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2561 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:alphabet_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2562 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>first_line_index<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2563 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>index<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, <span class="Constant">'^a'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2564 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>index<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2565 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>first_line_index<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>index
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2566 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2567 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>last_line_index<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2568 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>alphabet_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">lines</span><span class="vimFuncBody">[</span><span class="vimIsCommand">first_line_index</span><span class="vimFuncBody"> : </span><span class="vimIsCommand">last_line_index</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2569 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> |&quot; </span><span class="vimIsCommand">one</span><span class="vimFuncBody"> </span><span class="Statement">to</span><span class="vimFuncBody"> </span><span class="vimIsCommand">many</span><span class="vimFuncBody"> </span><span class="vimIsCommand">relationship</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2570 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>pinyin_with_tone<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^\a\+\d\s\+'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2571 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>s:alphabet_lines, <span class="Constant">'v:val =~ pinyin_with_tone'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2572 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2573 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2574 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:alphabet_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2575 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2576 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2577 </span><span class="Comment">    &quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2578 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>alphabet_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2579 </span>    <span class="Statement">if</span><span class="vimFuncBody"> &amp;</span>encoding<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;utf-8&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2580 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>alphabet_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">copy</span><span class="Statement">(</span>s:alphabet_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2581 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2582 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">alphabet_lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2583 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'^v\d\s\+'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2584 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_i18n_read<span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2585 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2586 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>alphabet_lines, line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2587 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2588 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2589 </span><span class="Comment">    &quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2590 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>characters<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>a:chinese,<span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2591 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>character<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>characters,<span class="Constant">'\|'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2592 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>alphabet_lines, <span class="Constant">'v:val =~ character'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2593 </span><span class="Comment">    &quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2594 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>cache<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2595 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">alphabet_lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2596 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2597 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2598 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2599 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>words<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2600 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>words<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2601 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2602 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2603 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>words, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2604 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2605 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>menu,<span class="Constant">'\d'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2606 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2607 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">words</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2608 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>characters, char<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2609 </span>                <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2610 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2611 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>cache,char<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Statement">menu</span><span class="Statement">!=</span>cache<span class="vimFuncBody">[</span><span class="vimIsCommand">char</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2612 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>cache<span class="vimFuncBody">[</span>char<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="Constant">'|'</span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">cache</span><span class="vimFuncBody">[</span><span class="vimIsCommand">char</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2613 </span>            <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2614 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>cache<span class="vimFuncBody">[</span>char<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2615 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2616 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2617 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2618 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>cache
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2619 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2620 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2621 </span><span class="Comment">&quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2622 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_make_one_entry</span><span class="Statement">(</span>cache, chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2623 </span><span class="Comment">&quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2624 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:chinese<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span><span class="vimOperParen">a:cache</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2625 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2626 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2627 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>characters<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>a:chinese, <span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2628 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>items<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2629 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">characters</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2630 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>a:cache, char<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2631 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:cache</span><span class="vimFuncBody">[</span>char<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2632 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>items, menu<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2633 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2634 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2635 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>items
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2636 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2637 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2638 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2639 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_reverse_lookup</span><span class="Statement">(</span>chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2640 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2641 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>a:chinese,<span class="Constant">'\s\+\|\w\|\n'</span><span class="vimOperParen">,</span><span class="Constant">''</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2642 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_characters<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>chinese,<span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2643 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_char<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>chinese_characters, <span class="Constant">'   '</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2644 </span><span class="Comment">    &quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2645 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>result_unicode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2646 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>items<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2647 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_unicode_lookup</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2648 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">chinese_characters</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2649 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>unicode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">printf</span><span class="Statement">(</span><span class="Constant">'%04x'</span>,char2nr<span class="Statement">(</span><span class="vimOperParen">char</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2650 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>items, unicode<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2651 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2652 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>unicode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>items, <span class="Constant">' '</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2653 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>result_unicode<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>unicode<span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\n&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">chinese_char</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2654 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2655 </span><span class="Comment">    &quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2656 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>result_4corner<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2657 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2658 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>cache_4corner<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_build_4corner_cache<span class="Statement">(</span>chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2659 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>items<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_make_one_entry<span class="Statement">(</span>cache_4corner, chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2660 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>result_4corner<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>items,<span class="Constant">' '</span><span class="Statement">).</span><span class="Constant">&quot;\n&quot;</span><span class="Statement">.</span>chinese_char
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2661 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2662 </span><span class="Comment">    &quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2663 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>cache_pinyin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_build_reverse_cache<span class="Statement">(</span>chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2664 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>items<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_make_one_entry<span class="Statement">(</span>cache_pinyin, chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2665 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>result_pinyin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">join</span><span class="Statement">(</span>items,<span class="Constant">''</span><span class="Statement">).</span><span class="Constant">&quot; &quot;</span><span class="Statement">.</span>chinese
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2666 </span><span class="Comment">    &quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2667 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2668 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>result_unicode<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2669 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\n&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>result_unicode
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2670 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2671 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>result_4corner<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2672 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\n&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>result_4corner
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2673 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2674 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>result_pinyin<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'\a'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2675 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\n&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span>result_pinyin
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2676 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2677 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>result
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2678 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2679 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold14")'>| </a><span class="lnr">2680 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold15' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold15")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold15")'>- </a><span class="Folded">2681 +-- 64 lines: ====  VimIM Private Data    ====
</span><span class='fulltext'><span class="lnr">2681 </span><span class="Comment">&quot; ====  VimIM Private Data    ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2682 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2683 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2684 </span><span class="Comment">&quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2685 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_datafile_privates</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2686 </span><span class="Comment">&quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2687 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>privates_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2688 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>lines_privates_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2689 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>private_matches<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2690 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">privates_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2691 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2692 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2693 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">path</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;privates.txt&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2694 </span>    <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_privates_txt<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2695 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">filereadable</span><span class="Statement">(</span>s:vimim_privates_txt<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2696 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>privates_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_privates_txt</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2697 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">filereadable</span><span class="Statement">(</span>datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2698 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>privates_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2699 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2700 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:privates_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2701 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2702 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2703 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>privates_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2704 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2705 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2706 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2707 </span><span class="Comment">&quot; -----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2708 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_search_vimim_privates</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2709 </span><span class="Comment">&quot; -----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2710 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_privates<span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2711 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>len_privates_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2712 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>len_privates_lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span><span class="vimOperParen">a:keyboard</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">3</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2713 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2714 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2715 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2716 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2717 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>matches<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2718 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>matched<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2719 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>matches<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_fuzzy_match<span class="Statement">(</span>lines, a:keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2720 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2721 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>matches<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_exact_match<span class="Statement">(</span>lines, a:keyboard, matched<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2722 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2723 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span>len_privates_lines
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2724 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_load_privates<span class="Statement">(</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2725 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2726 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>matches
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2727 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2728 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2729 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2730 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_load_privates</span><span class="Statement">(</span>reload_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2731 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2732 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:privates_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2733 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2734 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2735 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:lines_privates_datafile<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">a:reload_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2736 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">privates_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2737 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">filereadable</span><span class="Statement">(</span>datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2738 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>lines_privates_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">readfile</span><span class="Statement">(</span>datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2739 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2740 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2741 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">lines_privates_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2742 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2743 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold15")'>| </a><span class="lnr">2744 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold16' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold16")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold16")'>- </a><span class="Folded">2745 +--133 lines: ====  VimIM Four Corner     ====
</span><span class='fulltext'><span class="lnr">2745 </span><span class="Comment">&quot; ====  VimIM Four Corner     ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2746 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2747 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2748 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2749 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_datafile_4corner</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2750 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2751 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2752 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>lines_4corner_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2753 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2754 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_unicode_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2755 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>unicode_menu_display_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2756 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_debug_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2757 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2758 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2759 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2760 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_fuzzy_search<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2761 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_static_input_style<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2762 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2763 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2764 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">path</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;vimim.4corner.txt&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2765 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">filereadable</span><span class="Statement">(</span>datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2766 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2767 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2768 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2769 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2770 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2771 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2772 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2773 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2774 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_load_4corner</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2775 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2776 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:four_corner_flag<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_debug_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2777 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2778 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2779 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:lines_4corner_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2780 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2781 </span>        <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">empty</span><span class="Statement">(</span>datafile<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">filereadable</span><span class="Statement">(</span><span class="vimOperParen">datafile</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2782 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>lines_4corner_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">readfile</span><span class="Statement">(</span>datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2783 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2784 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2785 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">lines_4corner_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2786 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2787 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2788 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2789 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_4corner_whole_match</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2790 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2791 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2792 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2793 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody">%</span><span class="Constant">4</span><span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2794 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2795 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2796 </span><span class="Comment">    &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2797 </span><span class="Comment">    &quot; demo sijiaohaoma == 6021272260021762</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2798 </span><span class="Comment">    &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2799 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>a:keyboard, <span class="Constant">'\(.\{4}\)\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2800 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboards
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2801 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2802 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2803 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2804 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_diy_keyboard2number</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2805 </span><span class="Comment">&quot; ---------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2806 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2807 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_diy_pinyin_4corner<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2808 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2809 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">5</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2810 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">6</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2811 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2812 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2813 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>alphabet_length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2814 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">5</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span><span class="vimOperParen">keyboard,</span><span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2815 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>alphabet_length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2816 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">6</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span><span class="vimOperParen">keyboard,</span><span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">2</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2817 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>alphabet_length<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2818 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2819 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2820 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2821 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, <span class="Constant">0</span><span class="vimOperParen">, alphabet_length</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2822 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\l'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2823 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2824 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2825 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>four_corner<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, alphabet_length<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2826 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>four_corner<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\D'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2827 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2828 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2829 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>char<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>four_corner, <span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2830 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>s:digit_keyboards, char<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2831 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>digit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">digit_keyboards</span><span class="vimFuncBody">[</span><span class="vimIsCommand">char</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2832 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>result<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span>digit
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2833 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2834 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2835 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2836 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2837 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>result
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2838 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2839 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2840 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2841 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_build_4corner_cache</span><span class="Statement">(</span>chinese<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2842 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2843 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_datafile<span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2844 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2845 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2846 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2847 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:four_corner_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2848 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>first_non_digit_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2849 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>index<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, <span class="Constant">'^\D'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2850 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>index<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2851 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>first_non_digit_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>index
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2852 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2853 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">lines</span><span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody"> : </span><span class="vimIsCommand">first_non_digit_line</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2854 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2855 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:four_corner_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2856 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2857 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2858 </span><span class="Comment">    &quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2859 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">copy</span><span class="Statement">(</span>s:four_corner_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2860 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>characters<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>a:chinese, <span class="Constant">'\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2861 </span><span class="Comment">    &quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2862 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>cache<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2863 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2864 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_i18n_read<span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2865 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>words<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2866 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>value<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">remove</span><span class="Statement">(</span>words, <span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2867 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">words</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2868 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>characters, key<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2869 </span>                <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2870 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2871 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>cache<span class="vimFuncBody">[</span>key<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">value</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2872 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2873 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2874 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>cache
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2875 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2876 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold16")'>| </a><span class="lnr">2877 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold17' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold17")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold17")'>- </a><span class="Folded">2878 +-- 58 lines: ====  VimIM Pinyin Special  ====
</span><span class='fulltext'><span class="lnr">2878 </span><span class="Comment">&quot; ====  VimIM Pinyin Special  ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2879 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2880 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2881 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2882 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_datafile_pinyin</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2883 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2884 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2885 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_fuzzy_search<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2886 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_match_word_after_word<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2887 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_save_input_history_frequency<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2888 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_seamless_english_input<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2889 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2890 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2891 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2892 </span><span class="Comment">&quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2893 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_auto_spell</span><span class="Statement">(</span>lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2894 </span><span class="Comment">&quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2895 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:pinyin_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2896 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_auto_spell<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2897 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>a:lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2898 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2899 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2900 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2901 </span><span class="Comment">    &quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2902 </span><span class="Comment">    &quot; to guess user's intention using auto_spell</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2903 </span><span class="Comment">    &quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2904 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_auto_spell_rule<span class="Statement">(</span>a:keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2905 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:lines, <span class="Constant">'^'</span><span class="Statement">.</span><span class="vimOperParen">key</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2906 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>match_start
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2907 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2908 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2909 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2910 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_auto_spell_rule</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2911 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2912 </span><span class="Comment">    &quot; A demo rule for auto spelling</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2913 </span><span class="Comment">    &quot;    tign =&gt; tign</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2914 </span><span class="Comment">    &quot;     yve =&gt; yue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2915 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2916 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2917 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="Constant">'ign'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'ing'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2918 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="Constant">'iou'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'iu'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2919 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="Constant">'uei'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'ui'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2920 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="Constant">'uen'</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'un'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2921 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="Constant">'mg'</span><span class="vimFuncBody">]  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'ng'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2922 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="Constant">'ve'</span><span class="vimFuncBody">]  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'ue'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2923 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2924 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2925 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">keys</span><span class="Statement">(</span>rules<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2926 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>new_key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="vimIsCommand">key</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2927 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="vimIsCommand">key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2928 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>pattern, key, new_key, <span class="Constant">''</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2929 </span>            <span class="Statement">break</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2930 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2931 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2932 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>pattern
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2933 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2934 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold17")'>| </a><span class="lnr">2935 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold18' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold18")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold18")'>- </a><span class="Folded">2936 +--271 lines: ====  VimIM Shuang Pin      ====
</span><span class='fulltext'><span class="lnr">2936 </span><span class="Comment">&quot; ====  VimIM Shuang Pin      ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2937 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2938 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2939 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2940 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_shuangpin</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2941 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2942 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:pinyin_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2943 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2944 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2945 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_shuangpin_microsoft<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2946 </span><span class="Special">        \</span> <span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_shuangpin_purple<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2947 </span><span class="Special">        \</span> <span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_shuangpin_abc<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2948 </span><span class="Special">        \</span> <span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_shuangpin_nature<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2949 </span><span class="Special">        \</span> <span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_shuangpin_plusplus<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2950 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2951 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2952 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pinyin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2953 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2954 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_static_input_style<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2955 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_shuangpin_generic<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2956 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_shuangpin_microsoft</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2957 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_shuangpin_microsoft<span class="Statement">(</span>rules<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2958 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_shuangpin_abc</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2959 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_shuangpin_abc<span class="Statement">(</span>rules<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2960 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_shuangpin_nature</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2961 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_shuangpin_nature<span class="Statement">(</span>rules<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2962 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_shuangpin_purple</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2963 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_shuangpin_purple<span class="Statement">(</span>rules<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2964 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_shuangpin_plusplus</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2965 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_shuangpin_plusplus<span class="Statement">(</span>rules<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2966 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2967 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_shuangpin_table<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_create_shuangpin_table<span class="Statement">(</span>rules<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2968 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2969 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2970 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2971 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_resume_shuangpin</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2972 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2973 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:shuangpin_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2974 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2975 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_in_quanpin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2976 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2977 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2978 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2979 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2980 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_shuangpin_transform</span><span class="Statement">(</span>keyb<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2981 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2982 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:shuangpin_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2983 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyb</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2984 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2985 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>size<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strlen</span><span class="Statement">(</span>a:keyb<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2986 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>ptr<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2987 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2988 </span>    <span class="Statement">while</span><span class="vimFuncBody"> </span><span class="Statement">ptr</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span>size
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2989 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyb</span><span class="vimFuncBody">[</span><span class="Statement">ptr</span><span class="vimFuncBody">] </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[a-z;]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2990 </span><span class="Comment">            &quot; bypass all non-characters, i.e. 0-9 and A-Z are bypassed</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2991 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyb</span><span class="vimFuncBody">[</span><span class="Statement">ptr</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2992 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>ptr<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2993 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2994 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>sp1<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyb</span><span class="vimFuncBody">[</span><span class="Statement">ptr</span><span class="vimFuncBody">]</span><span class="Statement">.</span><span class="Identifier">a:keyb</span><span class="vimFuncBody">[</span><span class="Statement">ptr</span><span class="Statement">+</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2995 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>s:vimim_shuangpin_table, sp1<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2996 </span><span class="Comment">                &quot; the last odd shuangpin code are output as only shengmu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2997 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_shuangpin_table</span><span class="vimFuncBody">[</span><span class="vimIsCommand">sp1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2998 </span>            <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">2999 </span><span class="Comment">                &quot; invalid shuangpin code are preserved</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3000 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">.=</span><span class="vimFuncBody"> </span>sp1
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3001 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3002 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>ptr<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3003 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3004 </span>    <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3005 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>output
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3006 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3007 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3008 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3009 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_create_shuangpin_table</span><span class="Statement">(</span>rule<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3010 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3011 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:rule</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3012 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>sptable<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3013 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>pinyin_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3014 </span><span class="Special">    \</span><span class="Constant">'''a'</span>,<span class="Constant">'''ai'</span><span class="vimFuncBody">,</span><span class="Constant">'''an'</span><span class="vimFuncBody">,</span><span class="Constant">'''ang'</span><span class="vimFuncBody">,</span><span class="Constant">'''ao'</span><span class="vimFuncBody">,</span><span class="Constant">'b</span><span class="vimFuncBody">a',</span><span class="Constant">'b</span><span class="vimFuncBody">ai',</span><span class="Constant">'b</span><span class="vimFuncBody">an',</span><span class="Constant">'b</span><span class="vimFuncBody">ang',</span><span class="Constant">'b</span><span class="vimFuncBody">ao',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3015 </span><span class="Special">    \</span><span class="Constant">'bei'</span>,<span class="Constant">'b</span><span class="vimFuncBody">en',</span><span class="Constant">'b</span><span class="vimFuncBody">eng',</span><span class="Constant">'b</span><span class="vimFuncBody">i',</span><span class="Constant">'b</span><span class="vimFuncBody">ian',</span><span class="Constant">'b</span><span class="vimFuncBody">iao',</span><span class="Constant">'b</span><span class="vimFuncBody">ie',</span><span class="Constant">'b</span><span class="vimFuncBody">in',</span><span class="Constant">'b</span><span class="vimFuncBody">ing',</span><span class="Constant">'b</span><span class="vimFuncBody">o',</span><span class="Constant">'b</span><span class="vimFuncBody">u',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3016 </span><span class="Special">    \</span><span class="Constant">'ca'</span>,<span class="Constant">'c</span><span class="vimFuncBody">ai',</span><span class="Constant">'c</span><span class="vimFuncBody">an',</span><span class="Constant">'c</span><span class="vimFuncBody">ang',</span><span class="Constant">'c</span><span class="vimFuncBody">ao',</span><span class="Constant">'c</span><span class="vimFuncBody">e',</span><span class="Constant">'c</span><span class="vimFuncBody">en',</span><span class="Constant">'c</span><span class="vimFuncBody">eng',</span><span class="Constant">'c</span><span class="vimFuncBody">ha',</span><span class="Constant">'c</span><span class="vimFuncBody">hai',</span><span class="Constant">'c</span><span class="vimFuncBody">han',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3017 </span><span class="Special">    \</span><span class="Constant">'chang'</span>,<span class="Constant">'c</span><span class="vimFuncBody">hao',</span><span class="Constant">'c</span><span class="vimFuncBody">he',</span><span class="Constant">'c</span><span class="vimFuncBody">hen',</span><span class="Constant">'c</span><span class="vimFuncBody">heng',</span><span class="Constant">'c</span><span class="vimFuncBody">hi',</span><span class="Constant">'c</span><span class="vimFuncBody">hong',</span><span class="Constant">'c</span><span class="vimFuncBody">hou',</span><span class="Constant">'c</span><span class="vimFuncBody">hu',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3018 </span><span class="Special">    \</span><span class="Constant">'chua'</span>,<span class="Constant">'c</span><span class="vimFuncBody">huai',</span><span class="Constant">'c</span><span class="vimFuncBody">huan',</span><span class="Constant">'c</span><span class="vimFuncBody">huang',</span><span class="Constant">'c</span><span class="vimFuncBody">hui',</span><span class="Constant">'c</span><span class="vimFuncBody">hun',</span><span class="Constant">'c</span><span class="vimFuncBody">huo',</span><span class="Constant">'c</span><span class="vimFuncBody">i',</span><span class="Constant">'c</span><span class="vimFuncBody">ong',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3019 </span><span class="Special">    \</span><span class="Constant">'cou'</span>,<span class="Constant">'c</span><span class="vimFuncBody">u',</span><span class="Constant">'c</span><span class="vimFuncBody">uan',</span><span class="Constant">'c</span><span class="vimFuncBody">ui',</span><span class="Constant">'c</span><span class="vimFuncBody">un',</span><span class="Constant">'c</span><span class="vimFuncBody">uo',</span><span class="Constant">'d</span><span class="vimFuncBody">a',</span><span class="Constant">'d</span><span class="vimFuncBody">ai',</span><span class="Constant">'d</span><span class="vimFuncBody">an',</span><span class="Constant">'d</span><span class="vimFuncBody">ang',</span><span class="Constant">'d</span><span class="vimFuncBody">ao',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3020 </span><span class="Special">    \</span><span class="Constant">'de'</span>,<span class="Constant">'d</span><span class="vimFuncBody">ei',</span><span class="Constant">'d</span><span class="vimFuncBody">eng',</span><span class="Constant">'d</span><span class="vimFuncBody">i',</span><span class="Constant">'d</span><span class="vimFuncBody">ia',</span><span class="Constant">'d</span><span class="vimFuncBody">ian',</span><span class="Constant">'d</span><span class="vimFuncBody">iao',</span><span class="Constant">'d</span><span class="vimFuncBody">ie',</span><span class="Constant">'d</span><span class="vimFuncBody">ing',</span><span class="Constant">'d</span><span class="vimFuncBody">iu',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3021 </span><span class="Special">    \</span><span class="Constant">'dong'</span>,<span class="Constant">'d</span><span class="vimFuncBody">ou',</span><span class="Constant">'d</span><span class="vimFuncBody">u',</span><span class="Constant">'d</span><span class="vimFuncBody">uan',</span><span class="Constant">'d</span><span class="vimFuncBody">ui',</span><span class="Constant">'d</span><span class="vimFuncBody">un',</span><span class="Constant">'d</span><span class="vimFuncBody">uo',</span><span class="Constant">'''</span><span class="Statement">e</span><span class="vimFuncBody">',</span><span class="Constant">'''ei'</span><span class="vimFuncBody">,</span><span class="Constant">'''en'</span><span class="vimFuncBody">,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3022 </span><span class="Special">    \</span><span class="Constant">'''er'</span>,<span class="Constant">'f</span><span class="vimFuncBody">a',</span><span class="Constant">'f</span><span class="vimFuncBody">an',</span><span class="Constant">'f</span><span class="vimFuncBody">ang',</span><span class="Constant">'f</span><span class="vimFuncBody">e',</span><span class="Constant">'f</span><span class="vimFuncBody">ei',</span><span class="Constant">'f</span><span class="vimFuncBody">en',</span><span class="Constant">'f</span><span class="vimFuncBody">eng',</span><span class="Constant">'f</span><span class="vimFuncBody">iao',</span><span class="Constant">'f</span><span class="vimFuncBody">o',</span><span class="Constant">'f</span><span class="vimFuncBody">ou',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3023 </span><span class="Special">    \</span><span class="Constant">'fu'</span>,<span class="Constant">'g</span><span class="vimFuncBody">a',</span><span class="Constant">'g</span><span class="vimFuncBody">ai',</span><span class="Constant">'g</span><span class="vimFuncBody">an',</span><span class="Constant">'g</span><span class="vimFuncBody">ang',</span><span class="Constant">'g</span><span class="vimFuncBody">ao',</span><span class="Constant">'g</span><span class="vimFuncBody">e',</span><span class="Constant">'g</span><span class="vimFuncBody">ei',</span><span class="Constant">'g</span><span class="vimFuncBody">en',</span><span class="Constant">'g</span><span class="vimFuncBody">eng',</span><span class="Constant">'g</span><span class="vimFuncBody">ong',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3024 </span><span class="Special">    \</span><span class="Constant">'gou'</span>,<span class="Constant">'g</span><span class="vimFuncBody">u',</span><span class="Constant">'g</span><span class="vimFuncBody">ua',</span><span class="Constant">'g</span><span class="vimFuncBody">uai',</span><span class="Constant">'g</span><span class="vimFuncBody">uan',</span><span class="Constant">'g</span><span class="vimFuncBody">uang',</span><span class="Constant">'g</span><span class="vimFuncBody">ui',</span><span class="Constant">'g</span><span class="vimFuncBody">un',</span><span class="Constant">'g</span><span class="vimFuncBody">uo',</span><span class="Constant">'h</span><span class="vimFuncBody">a',</span><span class="Constant">'h</span><span class="vimFuncBody">ai',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3025 </span><span class="Special">    \</span><span class="Constant">'han'</span>,<span class="Constant">'h</span><span class="vimFuncBody">ang',</span><span class="Constant">'h</span><span class="vimFuncBody">ao',</span><span class="Constant">'h</span><span class="vimFuncBody">e',</span><span class="Constant">'h</span><span class="vimFuncBody">ei',</span><span class="Constant">'h</span><span class="vimFuncBody">en',</span><span class="Constant">'h</span><span class="vimFuncBody">eng',</span><span class="Constant">'h</span><span class="vimFuncBody">ong',</span><span class="Constant">'h</span><span class="vimFuncBody">ou',</span><span class="Constant">'h</span><span class="vimFuncBody">u',</span><span class="Constant">'h</span><span class="vimFuncBody">ua',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3026 </span><span class="Special">    \</span><span class="Constant">'huai'</span>,<span class="Constant">'h</span><span class="vimFuncBody">uan',</span><span class="Constant">'h</span><span class="vimFuncBody">uang',</span><span class="Constant">'h</span><span class="vimFuncBody">ui',</span><span class="Constant">'h</span><span class="vimFuncBody">un',</span><span class="Constant">'h</span><span class="vimFuncBody">uo',</span><span class="Constant">'''</span>i<span class="vimFuncBody">',</span><span class="Constant">'j</span><span class="vimFuncBody">i',</span><span class="Constant">'j</span><span class="vimFuncBody">ia',</span><span class="Constant">'j</span><span class="vimFuncBody">ian',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3027 </span><span class="Special">    \</span><span class="Constant">'jiang'</span>,<span class="Constant">'j</span><span class="vimFuncBody">iao',</span><span class="Constant">'j</span><span class="vimFuncBody">ie',</span><span class="Constant">'j</span><span class="vimFuncBody">in',</span><span class="Constant">'j</span><span class="vimFuncBody">ing',</span><span class="Constant">'j</span><span class="vimFuncBody">iong',</span><span class="Constant">'j</span><span class="vimFuncBody">iu',</span><span class="Constant">'j</span><span class="vimFuncBody">u',</span><span class="Constant">'j</span><span class="vimFuncBody">uan',</span><span class="Constant">'j</span><span class="vimFuncBody">ue',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3028 </span><span class="Special">    \</span><span class="Constant">'jun'</span>,<span class="Constant">'k</span><span class="vimFuncBody">a',</span><span class="Constant">'k</span><span class="vimFuncBody">ai',</span><span class="Constant">'k</span><span class="vimFuncBody">an',</span><span class="Constant">'k</span><span class="vimFuncBody">ang',</span><span class="Constant">'k</span><span class="vimFuncBody">ao',</span><span class="Constant">'k</span><span class="vimFuncBody">e',</span><span class="Constant">'k</span><span class="vimFuncBody">en',</span><span class="Constant">'k</span><span class="vimFuncBody">eng',</span><span class="Constant">'k</span><span class="vimFuncBody">ong',</span><span class="Constant">'k</span><span class="vimFuncBody">ou',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3029 </span><span class="Special">    \</span><span class="Constant">'ku'</span>,<span class="Constant">'k</span><span class="vimFuncBody">ua',</span><span class="Constant">'k</span><span class="vimFuncBody">uai',</span><span class="Constant">'k</span><span class="vimFuncBody">uan',</span><span class="Constant">'k</span><span class="vimFuncBody">uang',</span><span class="Constant">'k</span><span class="vimFuncBody">ui',</span><span class="Constant">'k</span><span class="vimFuncBody">un',</span><span class="Constant">'k</span><span class="vimFuncBody">uo',</span><span class="Constant">'l</span><span class="vimFuncBody">a',</span><span class="Constant">'l</span><span class="vimFuncBody">ai',</span><span class="Constant">'l</span><span class="vimFuncBody">an',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3030 </span><span class="Special">    \</span><span class="Constant">'lang'</span>,<span class="Constant">'l</span><span class="vimFuncBody">ao',</span><span class="Constant">'l</span><span class="vimFuncBody">e',</span><span class="Constant">'l</span><span class="vimFuncBody">ei',</span><span class="Constant">'l</span><span class="vimFuncBody">eng',</span><span class="Constant">'l</span><span class="vimFuncBody">i',</span><span class="Constant">'l</span><span class="vimFuncBody">ia',</span><span class="Constant">'l</span><span class="vimFuncBody">ian',</span><span class="Constant">'l</span><span class="vimFuncBody">iang',</span><span class="Constant">'l</span><span class="vimFuncBody">iao',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3031 </span><span class="Special">    \</span><span class="Constant">'lie'</span>,<span class="Constant">'l</span><span class="vimFuncBody">in',</span><span class="Constant">'l</span><span class="vimFuncBody">ing',</span><span class="Constant">'l</span><span class="vimFuncBody">iu',</span><span class="Constant">'l</span><span class="vimFuncBody">ong',</span><span class="Constant">'l</span><span class="vimFuncBody">ou',</span><span class="Constant">'l</span><span class="vimFuncBody">u',</span><span class="Constant">'l</span><span class="vimFuncBody">uan',</span><span class="Constant">'l</span><span class="vimFuncBody">ue',</span><span class="Constant">'l</span><span class="vimFuncBody">un',</span><span class="Constant">'l</span><span class="vimFuncBody">uo',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3032 </span><span class="Special">    \</span><span class="Constant">'lv'</span>,<span class="Constant">'m</span><span class="vimFuncBody">a',</span><span class="Constant">'m</span><span class="vimFuncBody">ai',</span><span class="Constant">'m</span><span class="vimFuncBody">an',</span><span class="Constant">'m</span><span class="vimFuncBody">ang',</span><span class="Constant">'m</span><span class="vimFuncBody">ao',</span><span class="Constant">'m</span><span class="vimFuncBody">e',</span><span class="Constant">'m</span><span class="vimFuncBody">ei',</span><span class="Constant">'m</span><span class="vimFuncBody">en',</span><span class="Constant">'m</span><span class="vimFuncBody">eng',</span><span class="Constant">'m</span><span class="vimFuncBody">i',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3033 </span><span class="Special">    \</span><span class="Constant">'mian'</span>,<span class="Constant">'m</span><span class="vimFuncBody">iao',</span><span class="Constant">'m</span><span class="vimFuncBody">ie',</span><span class="Constant">'m</span><span class="vimFuncBody">in',</span><span class="Constant">'m</span><span class="vimFuncBody">ing',</span><span class="Constant">'m</span><span class="vimFuncBody">iu',</span><span class="Constant">'m</span><span class="vimFuncBody">o',</span><span class="Constant">'m</span><span class="vimFuncBody">ou',</span><span class="Constant">'m</span><span class="vimFuncBody">u',</span><span class="Constant">'n</span><span class="vimFuncBody">a',</span><span class="Constant">'n</span><span class="vimFuncBody">ai',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3034 </span><span class="Special">    \</span><span class="Constant">'nan'</span>,<span class="Constant">'n</span><span class="vimFuncBody">ang',</span><span class="Constant">'n</span><span class="vimFuncBody">ao',</span><span class="Constant">'n</span><span class="vimFuncBody">e',</span><span class="Constant">'n</span><span class="vimFuncBody">ei',</span><span class="Constant">'n</span><span class="vimFuncBody">en',</span><span class="Constant">'n</span><span class="vimFuncBody">eng',</span><span class="Constant">'''</span>ng<span class="vimFuncBody">',</span><span class="Constant">'n</span><span class="vimFuncBody">i',</span><span class="Constant">'n</span><span class="vimFuncBody">ian',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3035 </span><span class="Special">    \</span><span class="Constant">'niang'</span>,<span class="Constant">'n</span><span class="vimFuncBody">iao',</span><span class="Constant">'n</span><span class="vimFuncBody">ie',</span><span class="Constant">'n</span><span class="vimFuncBody">in',</span><span class="Constant">'n</span><span class="vimFuncBody">ing',</span><span class="Constant">'n</span><span class="vimFuncBody">iu',</span><span class="Constant">'n</span><span class="vimFuncBody">ong',</span><span class="Constant">'n</span><span class="vimFuncBody">ou',</span><span class="Constant">'n</span><span class="vimFuncBody">u',</span><span class="Constant">'n</span><span class="vimFuncBody">uan',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3036 </span><span class="Special">    \</span><span class="Constant">'nue'</span>,<span class="Constant">'n</span><span class="vimFuncBody">uo',</span><span class="Constant">'n</span><span class="vimFuncBody">v',</span><span class="Constant">'''</span><span class="Statement">o</span><span class="vimFuncBody">',</span><span class="Constant">'''ou'</span><span class="vimFuncBody">,</span><span class="Constant">'p</span><span class="vimFuncBody">a',</span><span class="Constant">'p</span><span class="vimFuncBody">ai',</span><span class="Constant">'p</span><span class="vimFuncBody">an',</span><span class="Constant">'p</span><span class="vimFuncBody">ang',</span><span class="Constant">'p</span><span class="vimFuncBody">ao',</span><span class="Constant">'p</span><span class="vimFuncBody">ei',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3037 </span><span class="Special">    \</span><span class="Constant">'pen'</span>,<span class="Constant">'p</span><span class="vimFuncBody">eng',</span><span class="Constant">'p</span><span class="vimFuncBody">i',</span><span class="Constant">'p</span><span class="vimFuncBody">ian',</span><span class="Constant">'p</span><span class="vimFuncBody">iao',</span><span class="Constant">'p</span><span class="vimFuncBody">ie',</span><span class="Constant">'p</span><span class="vimFuncBody">in',</span><span class="Constant">'p</span><span class="vimFuncBody">ing',</span><span class="Constant">'p</span><span class="vimFuncBody">o',</span><span class="Constant">'p</span><span class="vimFuncBody">ou',</span><span class="Constant">'p</span><span class="vimFuncBody">u',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3038 </span><span class="Special">    \</span><span class="Constant">'qi'</span>,<span class="Constant">'q</span><span class="vimFuncBody">ia',</span><span class="Constant">'q</span><span class="vimFuncBody">ian',</span><span class="Constant">'q</span><span class="vimFuncBody">iang',</span><span class="Constant">'q</span><span class="vimFuncBody">iao',</span><span class="Constant">'q</span><span class="vimFuncBody">ie',</span><span class="Constant">'q</span><span class="vimFuncBody">in',</span><span class="Constant">'q</span><span class="vimFuncBody">ing',</span><span class="Constant">'q</span><span class="vimFuncBody">iong',</span><span class="Constant">'q</span><span class="vimFuncBody">iu',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3039 </span><span class="Special">    \</span><span class="Constant">'qu'</span>,<span class="Constant">'q</span><span class="vimFuncBody">uan',</span><span class="Constant">'q</span><span class="vimFuncBody">ue',</span><span class="Constant">'q</span><span class="vimFuncBody">un',</span><span class="Constant">'r</span><span class="vimFuncBody">an',</span><span class="Constant">'r</span><span class="vimFuncBody">ang',</span><span class="Constant">'r</span><span class="vimFuncBody">ao',</span><span class="Constant">'r</span><span class="vimFuncBody">e',</span><span class="Constant">'r</span><span class="vimFuncBody">en',</span><span class="Constant">'r</span><span class="vimFuncBody">eng',</span><span class="Constant">'r</span><span class="vimFuncBody">i',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3040 </span><span class="Special">    \</span><span class="Constant">'rong'</span>,<span class="Constant">'r</span><span class="vimFuncBody">ou',</span><span class="Constant">'r</span><span class="vimFuncBody">u',</span><span class="Constant">'r</span><span class="vimFuncBody">uan',</span><span class="Constant">'r</span><span class="vimFuncBody">ui',</span><span class="Constant">'r</span><span class="vimFuncBody">un',</span><span class="Constant">'r</span><span class="vimFuncBody">uo',</span><span class="Constant">'s</span><span class="vimFuncBody">a',</span><span class="Constant">'s</span><span class="vimFuncBody">ai',</span><span class="Constant">'s</span><span class="vimFuncBody">an',</span><span class="Constant">'s</span><span class="vimFuncBody">ang',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3041 </span><span class="Special">    \</span><span class="Constant">'sao'</span>,<span class="Constant">'s</span><span class="vimFuncBody">e',</span><span class="Constant">'s</span><span class="vimFuncBody">en',</span><span class="Constant">'s</span><span class="vimFuncBody">eng',</span><span class="Constant">'s</span><span class="vimFuncBody">ha',</span><span class="Constant">'s</span><span class="vimFuncBody">hai',</span><span class="Constant">'s</span><span class="vimFuncBody">han',</span><span class="Constant">'s</span><span class="vimFuncBody">hang',</span><span class="Constant">'s</span><span class="vimFuncBody">hao',</span><span class="Constant">'s</span><span class="vimFuncBody">he',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3042 </span><span class="Special">    \</span><span class="Constant">'shei'</span>,<span class="Constant">'s</span><span class="vimFuncBody">hen',</span><span class="Constant">'s</span><span class="vimFuncBody">heng',</span><span class="Constant">'s</span><span class="vimFuncBody">hi',</span><span class="Constant">'s</span><span class="vimFuncBody">hou',</span><span class="Constant">'s</span><span class="vimFuncBody">hu',</span><span class="Constant">'s</span><span class="vimFuncBody">hua',</span><span class="Constant">'s</span><span class="vimFuncBody">huai',</span><span class="Constant">'s</span><span class="vimFuncBody">huan',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3043 </span><span class="Special">    \</span><span class="Constant">'shuang'</span>,<span class="Constant">'s</span><span class="vimFuncBody">hui',</span><span class="Constant">'s</span><span class="vimFuncBody">hun',</span><span class="Constant">'s</span><span class="vimFuncBody">huo',</span><span class="Constant">'s</span><span class="vimFuncBody">i',</span><span class="Constant">'s</span><span class="vimFuncBody">ong',</span><span class="Constant">'s</span><span class="vimFuncBody">ou',</span><span class="Constant">'s</span><span class="vimFuncBody">u',</span><span class="Constant">'s</span><span class="vimFuncBody">uan',</span><span class="Constant">'s</span><span class="vimFuncBody">ui',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3044 </span><span class="Special">    \</span><span class="Constant">'sun'</span>,<span class="Constant">'s</span><span class="vimFuncBody">uo',</span><span class="Constant">'t</span><span class="vimFuncBody">a',</span><span class="Constant">'t</span><span class="vimFuncBody">ai',</span><span class="Constant">'t</span><span class="vimFuncBody">an',</span><span class="Constant">'t</span><span class="vimFuncBody">ang',</span><span class="Constant">'t</span><span class="vimFuncBody">ao',</span><span class="Constant">'t</span><span class="vimFuncBody">e',</span><span class="Constant">'t</span><span class="vimFuncBody">eng',</span><span class="Constant">'t</span><span class="vimFuncBody">i',</span><span class="Constant">'t</span><span class="vimFuncBody">ian',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3045 </span><span class="Special">    \</span><span class="Constant">'tiao'</span>,<span class="Constant">'t</span><span class="vimFuncBody">ie',</span><span class="Constant">'t</span><span class="vimFuncBody">ing',</span><span class="Constant">'t</span><span class="vimFuncBody">ong',</span><span class="Constant">'t</span><span class="vimFuncBody">ou',</span><span class="Constant">'t</span><span class="vimFuncBody">u',</span><span class="Constant">'t</span><span class="vimFuncBody">uan',</span><span class="Constant">'t</span><span class="vimFuncBody">ui',</span><span class="Constant">'t</span><span class="vimFuncBody">un',</span><span class="Constant">'t</span><span class="vimFuncBody">uo',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3046 </span><span class="Special">    \</span><span class="Constant">'''u'</span>,<span class="Constant">'''v'</span><span class="vimFuncBody">,</span><span class="Constant">'w</span><span class="vimFuncBody">a',</span><span class="Constant">'w</span><span class="vimFuncBody">ai',</span><span class="Constant">'w</span><span class="vimFuncBody">an',</span><span class="Constant">'w</span><span class="vimFuncBody">ang',</span><span class="Constant">'w</span><span class="vimFuncBody">ei',</span><span class="Constant">'w</span><span class="vimFuncBody">en',</span><span class="Constant">'w</span><span class="vimFuncBody">eng',</span><span class="Constant">'w</span><span class="vimFuncBody">o',</span><span class="Constant">'w</span><span class="vimFuncBody">u',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3047 </span><span class="Special">    \</span><span class="Constant">'xi'</span>,<span class="Constant">'x</span><span class="vimFuncBody">ia',</span><span class="Constant">'x</span><span class="vimFuncBody">ian',</span><span class="Constant">'x</span><span class="vimFuncBody">iang',</span><span class="Constant">'x</span><span class="vimFuncBody">iao',</span><span class="Constant">'x</span><span class="vimFuncBody">ie',</span><span class="Constant">'x</span><span class="vimFuncBody">in',</span><span class="Constant">'x</span><span class="vimFuncBody">ing',</span><span class="Constant">'x</span><span class="vimFuncBody">iong',</span><span class="Constant">'x</span><span class="vimFuncBody">iu',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3048 </span><span class="Special">    \</span><span class="Constant">'xu'</span>,<span class="Constant">'x</span><span class="vimFuncBody">uan',</span><span class="Constant">'x</span><span class="vimFuncBody">ue',</span><span class="Constant">'x</span><span class="vimFuncBody">un',</span><span class="Constant">'y</span><span class="vimFuncBody">a',</span><span class="Constant">'y</span><span class="vimFuncBody">an',</span><span class="Constant">'y</span><span class="vimFuncBody">ang',</span><span class="Constant">'y</span><span class="vimFuncBody">ao',</span><span class="Constant">'y</span><span class="vimFuncBody">e',</span><span class="Constant">'y</span><span class="vimFuncBody">i',</span><span class="Constant">'y</span><span class="vimFuncBody">in',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3049 </span><span class="Special">    \</span><span class="Constant">'ying'</span>,<span class="Constant">'y</span><span class="vimFuncBody">o',</span><span class="Constant">'y</span><span class="vimFuncBody">ong',</span><span class="Constant">'y</span><span class="vimFuncBody">ou',</span><span class="Constant">'y</span><span class="vimFuncBody">u',</span><span class="Constant">'y</span><span class="vimFuncBody">uan',</span><span class="Constant">'y</span><span class="vimFuncBody">ue',</span><span class="Constant">'y</span><span class="vimFuncBody">un',</span><span class="Constant">'z</span><span class="vimFuncBody">a',</span><span class="Constant">'z</span><span class="vimFuncBody">ai',</span><span class="Constant">'z</span><span class="vimFuncBody">an',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3050 </span><span class="Special">    \</span><span class="Constant">'zang'</span>,<span class="Constant">'z</span><span class="vimFuncBody">ao',</span><span class="Constant">'z</span><span class="vimFuncBody">e',</span><span class="Constant">'z</span><span class="vimFuncBody">ei',</span><span class="Constant">'z</span><span class="vimFuncBody">en',</span><span class="Constant">'z</span><span class="vimFuncBody">eng',</span><span class="Constant">'z</span><span class="vimFuncBody">ha',</span><span class="Constant">'z</span><span class="vimFuncBody">hai',</span><span class="Constant">'z</span><span class="vimFuncBody">han',</span><span class="Constant">'z</span><span class="vimFuncBody">hang',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3051 </span><span class="Special">    \</span><span class="Constant">'zhao'</span>,<span class="Constant">'z</span><span class="vimFuncBody">he',</span><span class="Constant">'z</span><span class="vimFuncBody">hen',</span><span class="Constant">'z</span><span class="vimFuncBody">heng',</span><span class="Constant">'z</span><span class="vimFuncBody">hi',</span><span class="Constant">'z</span><span class="vimFuncBody">hong',</span><span class="Constant">'z</span><span class="vimFuncBody">hou',</span><span class="Constant">'z</span><span class="vimFuncBody">hu',</span><span class="Constant">'z</span><span class="vimFuncBody">hua',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3052 </span><span class="Special">    \</span><span class="Constant">'zhuai'</span>,<span class="Constant">'z</span><span class="vimFuncBody">huan',</span><span class="Constant">'z</span><span class="vimFuncBody">huang',</span><span class="Constant">'z</span><span class="vimFuncBody">hui',</span><span class="Constant">'z</span><span class="vimFuncBody">hun',</span><span class="Constant">'z</span><span class="vimFuncBody">huo',</span><span class="Constant">'z</span><span class="vimFuncBody">i',</span><span class="Constant">'z</span><span class="vimFuncBody">ong',</span><span class="Constant">'z</span><span class="vimFuncBody">ou',</span><span class="Constant">'z</span><span class="vimFuncBody">u',</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3053 </span><span class="Special">    \</span><span class="Constant">'zuan'</span>,<span class="Constant">'z</span><span class="vimFuncBody">ui',</span><span class="Constant">'z</span><span class="vimFuncBody">un',</span><span class="Constant">'z</span><span class="vimFuncBody">uo']</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3054 </span><span class="Comment">    &quot; generate table for shengmu-yunmu pairs match</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3055 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">pinyin_list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3056 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">&quot;['a-z]*&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3057 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3058 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3059 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">] </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;h&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3060 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>shengmu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody">[:</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3061 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>yunmu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody">[</span><span class="Constant">2</span><span class="vimFuncBody">:]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3062 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3063 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>shengmu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3064 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>yunmu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">:]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3065 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3066 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>rules[<span class="Constant">0</span><span class="vimOperParen">], shengmu</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3067 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>shuangpin_shengmu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">][</span><span class="vimIsCommand">shengmu</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3068 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3069 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3070 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3071 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>rules[<span class="Constant">1</span><span class="vimOperParen">], yunmu</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3072 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>shuangpin_yunmu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>rules<span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">][</span><span class="vimIsCommand">yunmu</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3073 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3074 </span>            <span class="Statement">continue</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3075 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3076 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>sp1<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>shuangpin_shengmu<span class="Statement">.</span><span class="vimIsCommand">shuangpin_yunmu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3077 </span>        <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">has_key</span><span class="Statement">(</span>sptable, sp1<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3078 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">] </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;'&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3079 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">:]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3080 </span>            <span class="Statement">end</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3081 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>sptable<span class="vimFuncBody">[</span>sp1<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3082 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3083 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3084 </span><span class="Comment">    &quot; the jxqy+v special case handling</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3085 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">(</span>s:vimim_shuangpin_abc<span class="Statement">&gt;</span><span class="Constant">0</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Statement">(</span><span class="vimOperParen">s:vimim_shuangpin_purple</span><span class="Statement">&gt;</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3086 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>sptable, <span class="Special">{</span><span class="Constant">&quot;jv&quot;</span><span class="vimOperParen">:&quot;ju&quot;,</span><span class="Constant">&quot;qv&quot;</span><span class="vimOperParen">:&quot;qu&quot;,</span><span class="Constant">&quot;xv&quot;</span><span class="vimOperParen">:&quot;xu&quot;,</span><span class="Constant">&quot;yv&quot;</span><span class="vimOperParen">:&quot;yu&quot;</span><span class="Special">}</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3087 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_shuangpin_microsoft</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3088 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>sptable, <span class="Special">{</span><span class="Constant">&quot;jv&quot;</span><span class="vimOperParen">:&quot;jue&quot;,</span><span class="Constant">&quot;qv&quot;</span><span class="vimOperParen">:&quot;que&quot;,</span><span class="Constant">&quot;xv&quot;</span><span class="vimOperParen">:&quot;xue&quot;,</span><span class="Constant">&quot;yv&quot;</span><span class="vimOperParen">:&quot;yue&quot;</span><span class="Special">}</span><span class="vimOperParen"> </span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3089 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3090 </span><span class="Comment">    &quot; generate table for shengmu-only match</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3091 </span>    <span class="Statement">for</span><span class="vimFuncBody"> [</span>key<span class="vimFuncBody">, </span><span class="vimIsCommand">value</span><span class="vimFuncBody">] </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">items</span><span class="Statement">(</span>rules[<span class="Constant">0</span><span class="vimOperParen">]</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3092 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">] </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">&quot;'&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3093 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>sptable<span class="vimFuncBody">[</span>value<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3094 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3095 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>sptable<span class="vimFuncBody">[</span>value<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3096 </span>        <span class="Statement">end</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3097 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3098 </span><span class="Comment">    &quot; free the list</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3099 </span>    <span class="Statement">unlet</span><span class="vimFuncBody"> </span>pinyin_list
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3100 </span><span class="Comment">    &quot; finished init sptable, will use in s:vimim_shuangpin_transform</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3101 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>sptable
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3102 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3103 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3104 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3105 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_shuangpin_generic</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3106 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3107 </span><span class="Comment">&quot; generate the default value of shuangpin table</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3108 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>shengmu_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3109 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>shengmu<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> [</span><span class="Constant">&quot;b&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;p&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;m&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;f&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;d&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;t&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;l&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;n&quot;</span><span class="vimFuncBody">,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3110 </span><span class="Special">                \</span><span class="Constant">&quot;g&quot;</span>,<span class="Constant">&quot;k&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;h&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;j&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;q&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;x&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;r&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;z&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;c&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;s&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;y&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;w&quot;</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3111 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>shengmu_list<span class="vimFuncBody">[</span>shengmu<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">shengmu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3112 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3113 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>shengmu_list<span class="vimFuncBody">[</span><span class="Constant">&quot;'&quot;</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;o&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3114 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>yunmu_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3115 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>yunmu<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> [</span><span class="Constant">&quot;a&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;o&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;e&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;i&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;u&quot;</span><span class="vimFuncBody">,</span><span class="Constant">&quot;v&quot;</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3116 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>yunmu_list<span class="vimFuncBody">[</span>yunmu<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">yunmu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3117 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3118 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_rule<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span><span class="vimIsCommand">shengmu_list</span><span class="vimFuncBody">, </span><span class="vimIsCommand">yunmu_list</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3119 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">shuangpin_rule</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3120 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3121 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3122 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3123 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_shuangpin_abc</span><span class="Statement">(</span>rule<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3124 </span><span class="Comment">&quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3125 </span><span class="Comment">    &quot; vtpc         =&gt; shuang pin       =&gt; double pinyin</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3126 </span><span class="Comment">    &quot; womfdbzlaeli =&gt; womendouzaizheli =&gt; we are all here</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3127 </span><span class="Comment">    &quot; woybyigemg   =&gt; woyouyigemeng    =&gt; i have a dream</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3128 </span><span class="Comment">    &quot; ---------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3129 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>a:rule[<span class="Constant">0</span><span class="vimOperParen">],</span><span class="Special">{</span><span class="vimOperParen"> </span><span class="Constant">&quot;zh&quot;</span><span class="vimOperParen">:&quot;a&quot;,</span><span class="Constant">&quot;ch&quot;</span><span class="vimOperParen">:&quot;e&quot;,</span><span class="Constant">&quot;sh&quot;</span><span class="vimOperParen">:&quot;v&quot; </span><span class="Special">}</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3130 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="vimFuncBody">(</span><span class="Identifier">a:rule</span><span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">],{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3131 </span><span class="Special">                \</span><span class="Constant">&quot;an&quot;</span>:&quot;<span class="Statement">j</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ao&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">k</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ai&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">l</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">h</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3132 </span><span class="Special">                \</span><span class="Constant">&quot;ong&quot;</span>:&quot;<span class="Statement">s</span><span class="Special">&quot;</span>,<span class="Special">&quot;</span>ou<span class="Special">&quot;</span><span class="Error">:&quot;b&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3133 </span><span class="Special">                \</span><span class="Constant">&quot;en&quot;</span>:&quot;<span class="Statement">f</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;er&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">r</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ei&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">q</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;eng&quot;</span><span class="vimFuncBody">:&quot;</span>g<span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="vimIsCommand">g</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3134 </span><span class="Special">                \</span><span class="Constant">&quot;ia&quot;</span>:&quot;<span class="Statement">d</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iu&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">r</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ie&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">x</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;in&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">c</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ing&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">y</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3135 </span><span class="Special">                \</span><span class="Constant">&quot;iao&quot;</span>:&quot;z<span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ian&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">w</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">t</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iong&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">s</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3136 </span><span class="Special">                \</span><span class="Constant">&quot;un&quot;</span>:&quot;<span class="Statement">n</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ua&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">d</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uo&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">o</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ue&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">m</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ui&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">m</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3137 </span><span class="Special">                \</span><span class="Constant">&quot;uai&quot;</span>:&quot;<span class="Statement">c</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uan&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">p</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">t</span><span class="vimFuncBody">&quot; } )</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3138 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:rule</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3139 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3140 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3141 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3142 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_shuangpin_microsoft</span><span class="Statement">(</span>rule<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3143 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3144 </span><span class="Comment">    &quot; vi=&gt;zhi ii=&gt;chi ui=&gt;shi keng=&gt;keneng</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3145 </span><span class="Comment">    &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3146 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>a:rule[<span class="Constant">0</span><span class="vimOperParen">],</span><span class="Special">{</span><span class="vimOperParen"> </span><span class="Constant">&quot;zh&quot;</span><span class="vimOperParen">:&quot;v&quot;,</span><span class="Constant">&quot;ch&quot;</span><span class="vimOperParen">:&quot;i&quot;,</span><span class="Constant">&quot;sh&quot;</span><span class="vimOperParen">:&quot;u&quot; </span><span class="Special">}</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3147 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="vimFuncBody">(</span><span class="Identifier">a:rule</span><span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">],{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3148 </span><span class="Special">                \</span><span class="Constant">&quot;an&quot;</span>:&quot;<span class="Statement">j</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ao&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">k</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ai&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">l</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">h</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3149 </span><span class="Special">                \</span><span class="Constant">&quot;ong&quot;</span>:&quot;<span class="Statement">s</span><span class="Special">&quot;</span>,<span class="Special">&quot;</span>ou<span class="Special">&quot;</span><span class="Error">:&quot;b&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3150 </span><span class="Special">                \</span><span class="Constant">&quot;en&quot;</span>:&quot;<span class="Statement">f</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;er&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">r</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ei&quot;</span><span class="vimFuncBody">:&quot;</span>z<span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;eng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="vimIsCommand">g</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="vimIsCommand">g</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3151 </span><span class="Special">                \</span><span class="Constant">&quot;ia&quot;</span>:&quot;<span class="Statement">w</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iu&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">q</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ie&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">x</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;in&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">n</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ing&quot;</span><span class="vimFuncBody">:&quot;;&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3152 </span><span class="Special">                \</span><span class="Constant">&quot;iao&quot;</span>:&quot;<span class="Statement">c</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ian&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">m</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">d</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iong&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">s</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3153 </span><span class="Special">                \</span><span class="Constant">&quot;un&quot;</span>:&quot;<span class="Statement">p</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ua&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">w</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uo&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">o</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ue&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">t</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ui&quot;</span><span class="vimFuncBody">:&quot;</span>v<span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3154 </span><span class="Special">                \</span><span class="Constant">&quot;uai&quot;</span>:&quot;<span class="Statement">y</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uan&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">r</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">d</span><span class="vimFuncBody">&quot; ,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3155 </span><span class="Special">                \</span><span class="Constant">&quot;v&quot;</span>:&quot;<span class="Statement">y</span><span class="vimFuncBody">&quot;} )</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3156 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:rule</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3157 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3158 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3159 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3160 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_shuangpin_nature</span><span class="Statement">(</span>rule<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3161 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3162 </span><span class="Comment">    &quot; goal: 'woui' =&gt; wo shi =&gt; i am</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3163 </span><span class="Comment">    &quot; -------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3164 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>a:rule[<span class="Constant">0</span><span class="vimOperParen">],</span><span class="Special">{</span><span class="vimOperParen"> </span><span class="Constant">&quot;zh&quot;</span><span class="vimOperParen">:&quot;v&quot;,</span><span class="Constant">&quot;ch&quot;</span><span class="vimOperParen">:&quot;i&quot;,</span><span class="Constant">&quot;sh&quot;</span><span class="vimOperParen">:&quot;u&quot; </span><span class="Special">}</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3165 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="vimFuncBody">(</span><span class="Identifier">a:rule</span><span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">],{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3166 </span><span class="Special">                \</span><span class="Constant">&quot;an&quot;</span>:&quot;<span class="Statement">j</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ao&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">k</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ai&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">l</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">h</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3167 </span><span class="Special">                \</span><span class="Constant">&quot;ong&quot;</span>:&quot;<span class="Statement">s</span><span class="Special">&quot;</span>,<span class="Special">&quot;</span>ou<span class="Special">&quot;</span><span class="Error">:&quot;b&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3168 </span><span class="Special">                \</span><span class="Constant">&quot;en&quot;</span>:&quot;<span class="Statement">f</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;er&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">r</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ei&quot;</span><span class="vimFuncBody">:&quot;</span>z<span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;eng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="vimIsCommand">g</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="vimIsCommand">g</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3169 </span><span class="Special">                \</span><span class="Constant">&quot;ia&quot;</span>:&quot;<span class="Statement">w</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iu&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">q</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ie&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">x</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;in&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">n</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ing&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">y</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3170 </span><span class="Special">                \</span><span class="Constant">&quot;iao&quot;</span>:&quot;<span class="Statement">c</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ian&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">m</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">d</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iong&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">s</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3171 </span><span class="Special">                \</span><span class="Constant">&quot;un&quot;</span>:&quot;<span class="Statement">p</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ua&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">w</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uo&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">o</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ue&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">t</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ui&quot;</span><span class="vimFuncBody">:&quot;</span>v<span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3172 </span><span class="Special">                \</span><span class="Constant">&quot;uai&quot;</span>:&quot;<span class="Statement">y</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uan&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">r</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">d</span><span class="vimFuncBody">&quot; } )</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3173 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:rule</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3174 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3175 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3176 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3177 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_shuangpin_plusplus</span><span class="Statement">(</span>rule<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3178 </span><span class="Comment">&quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3179 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>a:rule[<span class="Constant">0</span><span class="vimOperParen">],</span><span class="Special">{</span><span class="vimOperParen"> </span><span class="Constant">&quot;zh&quot;</span><span class="vimOperParen">:&quot;v&quot;,</span><span class="Constant">&quot;ch&quot;</span><span class="vimOperParen">:&quot;u&quot;,</span><span class="Constant">&quot;sh&quot;</span><span class="vimOperParen">:&quot;i&quot; </span><span class="Special">}</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3180 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="vimFuncBody">(</span><span class="Identifier">a:rule</span><span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">],{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3181 </span><span class="Special">                \</span><span class="Constant">&quot;an&quot;</span>:&quot;<span class="Statement">f</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ao&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">d</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ai&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">s</span><span class="Special">&quot;</span>,<span class="Special">&quot;</span>ang<span class="Special">&quot;</span><span class="Error">:&quot;</span><span class="Special">g</span><span class="Error">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3182 </span><span class="Special">                \</span><span class="Constant">&quot;ong&quot;</span>:&quot;<span class="Statement">y</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ou&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">p</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3183 </span><span class="Special">                \</span><span class="Constant">&quot;en&quot;</span>:&quot;<span class="Statement">r</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;er&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">q</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ei&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">w</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;eng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">t</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">t</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3184 </span><span class="Special">                \</span><span class="Constant">&quot;ia&quot;</span>:&quot;<span class="Statement">b</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iu&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">n</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ie&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">m</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;in&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">l</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ing&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">q</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3185 </span><span class="Special">                \</span><span class="Constant">&quot;iao&quot;</span>:&quot;<span class="Statement">k</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ian&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">j</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">h</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iong&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">y</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3186 </span><span class="Special">                \</span><span class="Constant">&quot;un&quot;</span>:&quot;z<span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ua&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">b</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uo&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">o</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ue&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">x</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ui&quot;</span><span class="vimFuncBody">:&quot;</span><span class="vimIsCommand">v</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3187 </span><span class="Special">                \</span><span class="Constant">&quot;uai&quot;</span>:&quot;<span class="Statement">x</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uan&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">c</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">h</span><span class="vimFuncBody">&quot; } )</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3188 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:rule</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3189 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3190 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3191 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3192 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_shuangpin_purple</span><span class="Statement">(</span>rule<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3193 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3194 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="Statement">(</span>a:rule[<span class="Constant">0</span><span class="vimOperParen">],</span><span class="Special">{</span><span class="vimOperParen"> </span><span class="Constant">&quot;zh&quot;</span><span class="vimOperParen">:&quot;u&quot;,</span><span class="Constant">&quot;ch&quot;</span><span class="vimOperParen">:&quot;a&quot;,</span><span class="Constant">&quot;sh&quot;</span><span class="vimOperParen">:&quot;i&quot; </span><span class="Special">}</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3195 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">extend</span><span class="vimFuncBody">(</span><span class="Identifier">a:rule</span><span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">],{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3196 </span><span class="Special">                \</span><span class="Constant">&quot;an&quot;</span>:&quot;<span class="Statement">r</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ao&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">q</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ai&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">p</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ang&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">s</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3197 </span><span class="Special">                \</span><span class="Constant">&quot;ong&quot;</span>:&quot;<span class="Statement">h</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ou&quot;</span><span class="vimFuncBody">:&quot;</span>z<span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3198 </span><span class="Special">                \</span><span class="Constant">&quot;en&quot;</span>:&quot;<span class="Statement">w</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;er&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">j</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ei&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">k</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;eng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">t</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ng&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">t</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3199 </span><span class="Special">                \</span><span class="Constant">&quot;ia&quot;</span>:&quot;<span class="Statement">x</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iu&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">j</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ie&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">d</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;in&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">y</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ing&quot;</span><span class="vimFuncBody">:&quot;;&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3200 </span><span class="Special">                \</span><span class="Constant">&quot;iao&quot;</span>:&quot;<span class="Statement">b</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ian&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">f</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iang&quot;</span><span class="vimFuncBody">:&quot;</span>g<span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;iong&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">h</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3201 </span><span class="Special">                \</span><span class="Constant">&quot;un&quot;</span>:&quot;<span class="Statement">m</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ua&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">x</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uo&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">o</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ue&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">n</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;ui&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">n</span><span class="vimFuncBody">&quot;,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3202 </span><span class="Special">                \</span><span class="Constant">&quot;uai&quot;</span>:&quot;<span class="Statement">y</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uan&quot;</span><span class="vimFuncBody">:&quot;</span><span class="Statement">l</span><span class="vimFuncBody">&quot;,</span><span class="Constant">&quot;uang&quot;</span><span class="vimFuncBody">:&quot;</span>g<span class="vimFuncBody">&quot;} )</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3203 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">a:rule</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3204 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3205 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold18")'>| </a><span class="lnr">3206 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold19' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold19")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold19")'>- </a><span class="Folded">3207 +-- 14 lines: ====  VimIM Erbi Special    ====
</span><span class='fulltext'><span class="lnr">3207 </span><span class="Comment">&quot; ====  VimIM Erbi Special    ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3208 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3209 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3210 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3211 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_datafile_erbi</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3212 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3213 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">erbi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3214 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_punctuation_navigation<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3215 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_do_search<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3216 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>wubi_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3217 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3218 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3219 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold19")'>| </a><span class="lnr">3220 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold20' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold20")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold20")'>- </a><span class="Folded">3221 +-- 70 lines: ====  VimIM Wubi Special    ====
</span><span class='fulltext'><span class="lnr">3221 </span><span class="Comment">&quot; ====  VimIM Wubi Special    ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3222 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3223 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3224 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3225 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_datafile_wubi</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3226 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3227 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3228 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_static_input_style</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3229 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_wubi_non_stop<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3230 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3231 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3232 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3233 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3234 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3235 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_wubi</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3236 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3237 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3238 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_datafile_range<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3239 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3240 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3241 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3242 </span><span class="Comment">    &quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3243 </span><span class="Comment">    &quot; support wubi wildcard search</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3244 </span><span class="Comment">    &quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3245 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3246 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>keyboard,<span class="Constant">'z'</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span><span class="vimOperParen">s:erbi_flag</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3247 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzies<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3248 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">2</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">'zz'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3249 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzies<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>keyboard,<span class="Constant">'z'</span><span class="vimOperParen">,</span><span class="Constant">'.'</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3250 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3251 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzy<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>fuzzies<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3252 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>lines, <span class="Constant">'v:val =~ fuzzy'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3253 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>lines
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3254 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3255 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3256 </span><span class="Comment">    &quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3257 </span><span class="Comment">    &quot; support wubi non-stop typing</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3258 </span><span class="Comment">    &quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3259 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_wubi_non_stop</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3260 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3261 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">4</span><span class="vimFuncBody">*</span><span class="Statement">((</span>len<span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimOperParen">/</span><span class="Constant">4</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3262 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, start<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3263 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3264 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_wubi<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3265 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3266 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3267 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3268 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3269 </span>    <span class="Statement">if</span><span class="vimFuncBody">  </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3270 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_exact_match<span class="Statement">(</span>lines, keyboard, match_start<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3271 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3272 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3273 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3274 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3275 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3276 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_wubi_whole_match</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3277 </span><span class="Comment">&quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3278 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3279 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">!~#</span><span class="vimFuncBody"> </span><span class="Constant">'\l'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3280 </span><span class="Special">    \</span><span class="Statement">||</span> !<span class="Identifier">empty</span><span class="Statement">((</span>a:keyboard<span class="Statement">)</span><span class="vimOperParen">%</span><span class="Constant">4</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3281 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3282 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3283 </span><span class="Comment">    &quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3284 </span><span class="Comment">    &quot; demo [wubi] trdeggwhssqu =&gt; i have a dream</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3285 </span><span class="Comment">    &quot; ------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3286 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>a:keyboard,<span class="Constant">'\(.\{4}\)\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3287 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboards
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3288 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3289 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold20")'>| </a><span class="lnr">3290 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold21' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold21")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold21")'>- </a><span class="Folded">3291 +--127 lines: ====  VimIM Sogou Cloud IM  ====
</span><span class='fulltext'><span class="lnr">3291 </span><span class="Comment">&quot; ====  VimIM Sogou Cloud IM  ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3292 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3293 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3294 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3295 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_plug_n_play_www_sogou</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3296 </span><span class="Comment">&quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3297 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_www_sogou</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3298 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3299 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3300 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:current_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3301 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">(</span>executable<span class="Statement">(</span><span class="Constant">'wget'</span><span class="Statement">)</span><span class="vimOperParen"> </span><span class="Statement">||</span><span class="vimOperParen"> executable</span><span class="Statement">(</span><span class="Constant">'curl'</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3302 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_www_sogou<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3303 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3304 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3305 </span><span class="Comment">    &quot; for Windows user who does not know how to set PATH</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3306 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">has</span><span class="Statement">(</span><span class="Constant">&quot;win32&quot;</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="Identifier">has</span><span class="Statement">(</span><span class="Constant">&quot;win32unix&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3307 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_www_sogou<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3308 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>wget<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">path</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;wget.exe&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3309 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">executable</span><span class="Statement">(</span>wget<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3310 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_www_sogou<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3311 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>www_executable<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">wget</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3312 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3313 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3314 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3315 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3316 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3317 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_www_sogou</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3318 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3319 </span><span class="Comment">    &quot; step 1: try plug &amp; play</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3320 </span><span class="Comment">    &quot; -----------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3321 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_plug_n_play_www_sogou<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3322 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_www_sogou<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> !</span><span class="Identifier">exists</span><span class="Statement">(</span><span class="Constant">'*system'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3323 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3324 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3325 </span><span class="Comment">    &quot; step 2: try to find wget</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3326 </span><span class="Comment">    &quot; ------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3327 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>wget<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3328 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">www_executable</span><span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">&quot;wget.exe&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3329 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>wget<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">www_executable</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3330 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">executable</span><span class="Statement">(</span><span class="Constant">'wget'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3331 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>wget<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;wget&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3332 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3333 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>wget<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3334 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>msg<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;wget is not available&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3335 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3336 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>wget_option<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot; -qO - --timeout 12 -t 4 &quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3337 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>www_executable<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">wget</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">wget_option</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3338 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3339 </span><span class="Comment">    &quot; step 3: try to find curl if no wget</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3340 </span><span class="Comment">    &quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3341 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:www_executable<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3342 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">executable</span><span class="Statement">(</span><span class="Constant">'curl'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3343 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>www_executable<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;curl -s &quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3344 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3345 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3346 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:www_executable<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3347 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_www_sogou<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3348 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3349 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3350 </span><span class="Comment">    &quot; step 4: make it ready for </span><span class="Constant">&quot;cloud&quot;</span><span class="Comment">.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3351 </span><span class="Comment">    &quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3352 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:pinyin_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3353 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pinyin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3354 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3355 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_static_input_style<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3356 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3357 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3358 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3359 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_get_sogou_cloud_im</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3360 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3361 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_www_sogou<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3362 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>s:www_executable<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3363 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>a:keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3364 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3365 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3366 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>sogou<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'<a href="http://web.pinyin.sogou.com/web_ime/get_ajax/">http://web.pinyin.sogou.com/web_ime/get_ajax/</a>'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3367 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>input<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>sogou<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'.key'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3368 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3369 </span><span class="Comment">    &quot; --------------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3370 </span><span class="Comment">    &quot; <a href="http://web.pinyin.sogou.com/web_ime/get_ajax/woyouyigemeng.key">http://web.pinyin.sogou.com/web_ime/get_ajax/woyouyigemeng.key</a></span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3371 </span><span class="Comment">    &quot; --------------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3372 </span>    <span class="Statement">try</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3373 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">system</span><span class="Statement">(</span>s:www_executable <span class="Statement">.</span><span class="vimOperParen"> input</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3374 </span>    <span class="Statement">catch</span><span class="vimFuncBody"> </span><span class="Constant">/.*/</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3375 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>msg<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'it looks like sogou has trouble with its cloud?'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3376 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3377 </span>    <span class="Statement">endtry</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3378 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>output<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3379 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3380 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3381 </span><span class="Comment">    &quot; --------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3382 </span><span class="Comment">    &quot; ime_query_res=&quot;%E6%88%91&quot;;ime_query_key=&quot;woyouyigemeng&quot;;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3383 </span><span class="Comment">    &quot; --------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3384 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>first<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>output, <span class="Constant">'&quot;'</span><span class="vimOperParen">, </span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3385 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>second<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>output, <span class="Constant">'&quot;'</span><span class="vimOperParen">, </span><span class="Constant">0</span><span class="vimOperParen">, </span><span class="Constant">2</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3386 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Statement">first</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span>second<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3387 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>output, first<span class="Statement">+</span><span class="Constant">1</span><span class="vimOperParen">, second</span><span class="Statement">-</span><span class="vimOperParen">first</span><span class="Statement">-</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3388 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>output<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>output, <span class="Constant">'%\(\x\x\)'</span><span class="vimOperParen">,</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3389 </span><span class="Special">                    \</span> <span class="Constant">'\=eval(''&quot;\x''.submatch(1).''&quot;'')'</span><span class="vimFuncBody">,</span><span class="Constant">'g</span><span class="vimFuncBody">')</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3390 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3391 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>output<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3392 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3393 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3394 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3395 </span><span class="Comment">    &quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3396 </span><span class="Comment">    &quot; output='我有一个梦：13      +</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3397 </span><span class="Comment">    &quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3398 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>item<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>output, <span class="Constant">'\t+'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3399 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>item_list<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>item, <span class="Constant">'：'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3400 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>item_list<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3401 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>item_list<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3402 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>english<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>a:keyboard, <span class="Constant">0</span><span class="vimOperParen">, item_list[</span><span class="Constant">1</span><span class="vimOperParen">]</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3403 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>new_item<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>english<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot; &quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">chinese</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3404 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>menu, new_item<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3405 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3406 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3407 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>menu<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3408 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3409 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3410 </span><span class="Comment">        &quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3411 </span><span class="Comment">        &quot; ['woyouyigemeng 我有一个梦']</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3412 </span><span class="Comment">        &quot; ----------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3413 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Statement">menu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3414 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3415 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3416 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold21")'>| </a><span class="lnr">3417 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold22' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold22")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold22")'>- </a><span class="Folded">3418 +--270 lines: ====  VimIM Do It Youself   ====
</span><span class='fulltext'><span class="lnr">3418 </span><span class="Comment">&quot; ====  VimIM Do It Youself   ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3419 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3420 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3421 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3422 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_debug</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3423 </span><span class="Comment">&quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3424 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_debug_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3425 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>debug_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">path</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;vimim.txt&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3426 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>global_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3427 </span><span class="Comment">    &quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3428 </span>    <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">empty</span><span class="Statement">(</span>global_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3429 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">filereadable</span><span class="Statement">(</span>global_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3430 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">global_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3431 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">filereadable</span><span class="Statement">(</span>debug_datafile<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3432 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_datafile<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">debug_datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3433 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_debug_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3434 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3435 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_debug_flag<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3436 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3437 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3438 </span><span class="Comment">    &quot; -------------------------------- debug</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3439 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_www_sogou<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">12</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3440 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_static_input_style<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3441 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_shuangpin_abc<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3442 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>pinyin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3443 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>english_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3444 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>four_corner_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3445 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_tab_for_one_key<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3446 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_diy_pinyin_4corner<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3447 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_menu_extra_text<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3448 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_reverse_pageup_pagedown<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3449 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_wildcard_search<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3450 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_unicode_lookup<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3451 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_number_as_navigation<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3452 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_custom_menu_color<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3453 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_dummy_shuangpin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3454 </span>    <span class="Statement">set</span> <span class="PreProc">completefunc</span>=VimI<span class="vimSet">M</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3455 </span><span class="Comment">    &quot; ---------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3456 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3457 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3458 </span><span class="Comment">&quot; -----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3459 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_diy_pinyin_4corner</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3460 </span><span class="Comment">&quot; -----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3461 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3462 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_diy_pinyin_4corner<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3463 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3464 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_diy_pinyin_4corner<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3465 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3466 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3467 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3468 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'a'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3469 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'s'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3470 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'d'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">3</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3471 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'f'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3472 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'g'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">5</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3473 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'h'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">6</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3474 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'j'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">7</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3475 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'k'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">8</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3476 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'l'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">9</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3477 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>digit_keyboards<span class="vimFuncBody">[</span><span class="Constant">'o'</span><span class="vimFuncBody">]</span><span class="Statement">=</span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3478 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3479 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3480 </span><span class="Comment">&quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3481 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_diy_lines_to_hash</span><span class="Statement">(</span>fuzzy_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3482 </span><span class="Comment">&quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3483 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:fuzzy_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3484 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3485 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3486 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_to_keyboard_hash<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Special">{}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3487 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>line<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">a:fuzzy_lines</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3488 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>words<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>line<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3489 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">get</span><span class="Statement">(</span>words,<span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3490 </span>        <span class="Statement">for</span><span class="vimFuncBody"> </span>word<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">words</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3491 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>word<span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3492 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_to_keyboard_hash<span class="vimFuncBody">[</span>word<span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Statement">menu</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3493 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3494 </span>        <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3495 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3496 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>chinese_to_keyboard_hash
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3497 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3498 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3499 </span><span class="Comment">&quot; -------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3500 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_diy_double_menu</span><span class="Statement">(</span>hash_0, hash_1, hash_2<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3501 </span><span class="Comment">&quot; -------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3502 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:hash_0<span class="Statement">)</span><span class="vimFuncBody">  |&quot; </span><span class="Special">{</span><span class="Constant">'马力'</span><span class="vimOperParen">:'mali</span><span class="Constant">'</span><span class="vimOperParen">,</span><span class="Constant">'名流'</span><span class="vimOperParen">:'mingliu</span><span class="Constant">'</span><span class="Special">}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3503 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>a:hash_1<span class="Statement">)</span><span class="vimFuncBody"> |&quot; </span><span class="Special">{</span><span class="Constant">'马'</span><span class="vimOperParen">:'</span><span class="Constant">7712</span><span class="vimOperParen">'</span><span class="Special">}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3504 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []       |&quot; </span><span class="Special">{</span><span class="Constant">'力'</span>:'<span class="Constant">4002</span><span class="vimOperParen">'</span><span class="Special">}</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3505 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3506 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>values<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3507 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>key<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="Identifier">keys</span><span class="Statement">(</span>a:hash_0<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3508 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char_first<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>key
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3509 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char_last<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>key
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3510 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>key<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3511 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>char_first<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>key, <span class="Constant">0</span><span class="vimOperParen">, s:multibyte</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3512 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>char_last<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>key, len<span class="Statement">(</span><span class="vimOperParen">key</span><span class="Statement">)-</span><span class="vimOperParen">s:multibyte</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3513 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3514 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:hash_2<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3515 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">has_key</span><span class="Statement">(</span>a:hash_1, char_first<span class="Statement">)</span><span class="vimFuncBody">           |&quot; </span>ml77
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3516 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu_vary<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:hash_0</span><span class="vimFuncBody">[</span>key<span class="vimFuncBody">]           |&quot; </span><span class="vimIsCommand">mali</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3517 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu_fix<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:hash_1</span><span class="vimFuncBody">[</span>char_first<span class="vimFuncBody">]    |&quot; </span><span class="Constant">7712</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3518 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>menu_fix<span class="Statement">.</span><span class="Constant">'　'</span><span class="Statement">.</span><span class="vimIsCommand">menu_vary</span><span class="vimFuncBody">      |&quot; </span><span class="Constant">7712</span><span class="vimFuncBody"> </span><span class="vimIsCommand">mali</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3519 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>values, menu<span class="Statement">.</span><span class="Constant">&quot; &quot;</span><span class="Statement">.</span><span class="vimOperParen">key</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3520 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">has_key</span><span class="Statement">(</span>a:hash_1, char_first<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3521 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">has_key</span><span class="Statement">(</span>a:hash_2, char_last<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3522 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu_vary<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:hash_0</span><span class="vimFuncBody">[</span>key<span class="vimFuncBody">]           |&quot; </span><span class="vimIsCommand">ml7740</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3523 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu_fix1<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:hash_1</span><span class="vimFuncBody">[</span>char_first<span class="vimFuncBody">]    |&quot; </span><span class="Constant">7712</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3524 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu_fix2<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:hash_2</span><span class="vimFuncBody">[</span>char_last<span class="vimFuncBody">]     |&quot; </span><span class="Constant">4002</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3525 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu_fix<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>menu_fix1<span class="Statement">.</span><span class="Constant">'　'</span><span class="Statement">.</span><span class="vimIsCommand">menu_fix2</span><span class="vimFuncBody"> |&quot; </span><span class="Constant">7712</span><span class="vimFuncBody"> </span><span class="Constant">4002</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3526 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>menu<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>menu_fix<span class="Statement">.</span><span class="Constant">'　'</span><span class="Statement">.</span><span class="vimIsCommand">menu_vary</span><span class="vimFuncBody">      |&quot; </span><span class="Constant">7712</span><span class="vimFuncBody"> </span><span class="Constant">4002</span><span class="vimFuncBody"> </span><span class="vimIsCommand">mali</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3527 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>values, menu<span class="Statement">.</span><span class="Constant">&quot; &quot;</span><span class="Statement">.</span><span class="vimOperParen">key</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3528 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3529 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3530 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Identifier">sort</span><span class="Statement">(</span>values<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3531 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3532 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3533 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3534 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_quick_fuzzy_search</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3535 </span><span class="Comment">&quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3536 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_datafile_range<span class="Statement">(</span>a:keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3537 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3538 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3539 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3540 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>has_digit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:keyboard, <span class="Constant">'^\d\+'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3541 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>has_digit<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3542 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;^&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody">  </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3543 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1001</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3544 </span><span class="Comment">            &quot; another choice: top-left &amp; bottom-right</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3545 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>char_first<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>a:keyboard, <span class="Constant">0</span><span class="vimOperParen">, </span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3546 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>char_last<span class="vimFuncBody">  </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>a:keyboard, len<span class="Statement">(</span><span class="vimOperParen">a:keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3547 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>patterns<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody">  </span>char_first<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;\d\d&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">char_last</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3548 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3549 </span>        <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>results, <span class="Constant">'v:val =~ patterns'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3550 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_fuzzy_search</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3551 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_fuzzy_match<span class="Statement">(</span>results, a:keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3552 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3553 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_i18n_read_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3554 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3555 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3556 </span><span class="Comment">&quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3557 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_wildcard_search</span><span class="Statement">(</span>keyboard, lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3558 </span><span class="Comment">&quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3559 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3560 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3561 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3562 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3563 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>wildcard_pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[*]&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3564 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>wildcard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>a:keyboard, wildcard_pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3565 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>wildcard<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3566 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>star<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>a:keyboard,<span class="Constant">'[*]'</span><span class="vimOperParen">,</span><span class="Constant">'.*'</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3567 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzy<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Statement">star</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3568 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">filter</span><span class="Statement">(</span>a:lines, <span class="Constant">'v:val =~ fuzzy'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3569 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3570 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3571 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3572 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3573 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3574 </span><span class="Statement">function</span>! <span class="Special">&lt;SID&gt;</span><span class="vimFunction">vimim_vCTRL6</span><span class="Statement">(</span>chinglish<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3575 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3576 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>a:chinglish<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3577 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3578 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3579 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:chinglish</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\p'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3580 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_reverse_lookup<span class="Statement">(</span>a:chinglish<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3581 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3582 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_translator<span class="Statement">(</span>a:chinglish<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3583 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3584 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3585 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3586 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_diy_whole_match</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3587 </span><span class="Comment">&quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3588 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3589 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_diy_pinyin_4corner<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3590 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3591 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3592 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3593 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3594 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3595 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3596 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>len<span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)</span><span class="vimOperParen">%</span><span class="Constant">5</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span><span class="vimOperParen">keyboard,</span><span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">1</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3597 </span><span class="Comment">        &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3598 </span><span class="Comment">        &quot; demo sssjjzdoloslosonfofo z5000w0040</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3599 </span><span class="Comment">        &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3600 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>keyboard, <span class="Constant">'\(.\{5}\)\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3601 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>len<span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)</span><span class="vimOperParen">%</span><span class="Constant">6</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span><span class="vimOperParen">keyboard,</span><span class="Constant">0</span><span class="vimOperParen">,</span><span class="Constant">2</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3602 </span><span class="Comment">        &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3603 </span><span class="Comment">        &quot; demo zw5000md0051 zwgooomdooga</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3604 </span><span class="Comment">        &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3605 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">split</span><span class="Statement">(</span>keyboard, <span class="Constant">'\(.\{6}\)\zs'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3606 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3607 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>keyboards<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3608 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3609 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3610 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3611 </span>    <span class="Statement">for</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">in</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboards</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3612 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard2<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_keyboard2number<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3613 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard2<span class="vimFuncBody"> </span><span class="Statement">==#</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3614 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, <span class="Constant">1</span><span class="Statement">+</span><span class="vimOperParen">len</span><span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)</span><span class="vimOperParen">/</span><span class="Constant">6</span><span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">'\l'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3615 </span>            <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3616 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3617 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">add</span><span class="Statement">(</span>results, keyboard2<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3618 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3619 </span>    <span class="Statement">endfor</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3620 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3621 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3622 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3623 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3624 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_diy_keyboard</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3625 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3626 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3627 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_diy_pinyin_4corner<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3628 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3629 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3630 </span><span class="Special">    \</span><span class="Statement">||</span> keyboard<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'[0-9a-z]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3631 </span><span class="Special">    \</span><span class="Statement">||</span> keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'[.]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3632 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3633 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3634 </span><span class="Comment">    &quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3635 </span><span class="Comment">    &quot; do diy couple input method (pinyin+4corner)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3636 </span><span class="Comment">    &quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3637 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_datafile<span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3638 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'^'</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'\&gt;'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3639 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3640 </span>    <span class="Statement">if</span><span class="vimFuncBody">  </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3641 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3642 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3643 </span><span class="Comment">    &quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3644 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>alpha<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>keyboard, <span class="Constant">'\a\+'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3645 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>digit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>keyboard, <span class="Constant">'\d\+'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3646 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>digit<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">||</span><span class="vimFuncBody"> </span><span class="vimIsCommand">alpha</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3647 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3648 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3649 </span><span class="Comment">    &quot; ----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3650 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>break_into_three<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span><span class="vimFuncBody"> |&quot;  </span>ml7140<span class="vimFuncBody"> </span><span class="Statement">=&gt;</span><span class="vimFuncBody"> [</span><span class="Constant">'ml'</span><span class="vimFuncBody">, </span><span class="Constant">'71'</span><span class="vimFuncBody">, </span><span class="Constant">'40'</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3651 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>alpha_string<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, <span class="Constant">0</span><span class="vimOperParen">, digit</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3652 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>digit_string<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, digit<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3653 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>alpha<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3654 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>alpha_string<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, alpha<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3655 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>digit_string<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, <span class="Constant">0</span><span class="vimOperParen">, alpha</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3656 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>alpha_string<span class="Statement">)==</span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3657 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>digit_string<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, digit, <span class="Constant">2</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3658 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>break_into_three<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard, digit<span class="Statement">+</span><span class="Constant">2</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3659 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>alpha_string<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3660 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">len</span><span class="Statement">(</span>split<span class="Statement">(</span><span class="vimOperParen">digit_string,</span><span class="Constant">'\zs'</span><span class="Statement">))</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3661 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> digit_string<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'[1-4]'</span><span class="vimFuncBody"> |&quot; </span><span class="Statement">if</span><span class="vimFuncBody"> </span><span class="vimIsCommand">ma3</span><span class="vimFuncBody">, </span><span class="vimIsCommand">pinyin</span><span class="vimFuncBody"> </span><span class="vimIsCommand">tone</span><span class="vimFuncBody"> </span><span class="Constant">1</span><span class="vimFuncBody">,</span><span class="Constant">2</span><span class="vimFuncBody">,</span><span class="Constant">3</span><span class="vimFuncBody">,</span><span class="Constant">4</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3662 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3663 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3664 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span>alpha_string<span class="vimFuncBody">, </span><span class="vimIsCommand">digit_string</span><span class="vimFuncBody">, </span><span class="vimIsCommand">break_into_three</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3665 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>keyboards
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3666 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3667 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3668 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3669 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_diy_results</span><span class="Statement">(</span>keyboards<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3670 </span><span class="Comment">&quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3671 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboards</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3672 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_diy_pinyin_4corner<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3673 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Identifier">empty</span><span class="Statement">(</span>keyboards<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3674 </span><span class="Special">    \</span><span class="Statement">||</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3675 </span>        <span class="Statement">return</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3676 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3677 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzy_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_quick_fuzzy_search<span class="Statement">(</span>get<span class="Statement">(</span><span class="vimOperParen">keyboards,</span><span class="Constant">0</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3678 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>hash_0<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_lines_to_hash<span class="Statement">(</span>fuzzy_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3679 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzy_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_quick_fuzzy_search<span class="Statement">(</span>get<span class="Statement">(</span><span class="vimOperParen">keyboards,</span><span class="Constant">1</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3680 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>hash_1<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_lines_to_hash<span class="Statement">(</span>fuzzy_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3681 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>fuzzy_lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_quick_fuzzy_search<span class="Statement">(</span>get<span class="Statement">(</span><span class="vimOperParen">keyboards,</span><span class="Constant">2</span><span class="Statement">))</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3682 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>hash_2<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_lines_to_hash<span class="Statement">(</span>fuzzy_lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3683 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_double_menu<span class="Statement">(</span>hash_0, hash_1, hash_2<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3684 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>results
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3685 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3686 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold22")'>| </a><span class="lnr">3687 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold23' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold23")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold23")'>- </a><span class="Folded">3688 +--358 lines: ====  VimIM Core Engine     ====
</span><span class='fulltext'><span class="lnr">3688 </span><span class="Comment">&quot; ====  VimIM Core Engine     ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3689 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3690 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3691 </span><span class="Statement">set</span> <span class="PreProc">completeopt</span>=menuon<span class="vimSet">e</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3692 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3693 </span><span class="Statement">function</span>! VimIM<span class="Statement">(</span>start, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3694 </span><span class="Comment">&quot; ------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3695 </span><span class="Statement">if</span> <span class="Identifier">a:start</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3696 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3697 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>current_positions<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getpos</span><span class="Statement">(</span><span class="Constant">&quot;.&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3698 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>start_column<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_positions<span class="vimFuncBody">[</span><span class="Constant">2</span><span class="vimFuncBody">]</span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3699 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>start_row<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_positions<span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3700 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">getline</span><span class="Statement">(</span>start_row<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3701 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody">[</span><span class="vimIsCommand">start_column</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3702 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3703 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:chinese_input_mode<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3704 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> char_before<span class="vimFuncBody"> </span><span class="Statement">==#</span><span class="vimFuncBody"> </span><span class="Constant">'.'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3705 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>current_line, <span class="Constant">'\w\+\s\+\p\+\.$'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3706 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3707 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_sentence_input<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3708 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>match_start
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3709 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3710 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3711 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3712 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3713 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_seamless_english_input</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3714 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">len</span><span class="Statement">(</span>s:seamless_positions<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3715 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>seamless_bufnum<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">seamless_positions</span><span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3716 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>seamless_lnum<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">seamless_positions</span><span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3717 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>seamless_off<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">seamless_positions</span><span class="vimFuncBody">[</span><span class="Constant">3</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3718 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>seamless_bufnum<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="vimIsCommand">current_positions</span><span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3719 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> seamless_lnum<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="vimIsCommand">current_positions</span><span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3720 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> seamless_off<span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="vimIsCommand">current_positions</span><span class="vimFuncBody">[</span><span class="Constant">3</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3721 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>seamless_column<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">seamless_positions</span><span class="vimFuncBody">[</span><span class="Constant">2</span><span class="vimFuncBody">]</span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3722 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>len<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>start_column<span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="vimIsCommand">seamless_column</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3723 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>snip<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>current_line, seamless_column, len<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3724 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>snip<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\W'</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>snip<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3725 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>start_column_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">seamless_column</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3726 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>start_row_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">seamless_lnum</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3727 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>space<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3728 </span>                <span class="Statement">return</span><span class="vimFuncBody"> </span>seamless_column
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3729 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3730 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3731 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3732 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3733 </span>    <span class="Statement">while</span><span class="vimFuncBody"> </span>start_column<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">char_before</span><span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">valid_key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3734 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>start_column<span class="vimFuncBody"> </span><span class="Statement">-=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3735 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>char_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_line<span class="vimFuncBody">[</span><span class="vimIsCommand">start_column</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3736 </span>    <span class="Statement">endwhile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3737 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3738 </span><span class="Comment">    &quot; utf-8 datafile update: get user's previous selection</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3739 </span><span class="Comment">    &quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3740 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_save_input_history_frequency</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3741 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> start_row<span class="vimFuncBody"> </span><span class="Statement">&gt;=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">start_row_before</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3742 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_chinese_before<span class="Statement">(</span>start_row, start_column<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3743 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">char2nr</span><span class="Statement">(</span>chinese<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">127</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span><span class="vimOperParen">get</span><span class="Statement">(</span><span class="vimOperParen">s:keyboards,</span><span class="Constant">0</span><span class="Statement">))</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3744 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboards<span class="vimFuncBody">[</span><span class="Constant">1</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">chinese</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3745 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_counts<span class="vimFuncBody"> </span><span class="Statement">+=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3746 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3747 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3748 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3749 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>start_row_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">start_row</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3750 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>start_column_before<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">start_column</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3751 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>current_positions<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">current_positions</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3752 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>len<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>current_positions<span class="vimFuncBody">[</span><span class="Constant">2</span><span class="vimFuncBody">]</span><span class="Statement">-</span><span class="Constant">1</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="vimFuncBody"> </span><span class="vimIsCommand">start_column</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3753 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_leading_zero<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>current_line,start_column,len<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3754 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3755 </span>    <span class="Statement">return</span><span class="vimFuncBody"> </span>start_column
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3756 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3757 </span><span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3758 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3759 </span><span class="Comment">    &quot; support one-key-correction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3760 </span><span class="Comment">    &quot;</span> <span class="PreProc">OneKey:</span><span class="Comment"> (d)elete in popup || ChineseMode: &lt;BS&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3761 </span><span class="Comment">    &quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3762 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">trash_code_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3763 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>trash_code_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3764 </span>        <span class="Statement">return</span><span class="vimFuncBody"> [</span><span class="Constant">&quot; &quot;</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3765 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3766 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3767 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_debug_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3768 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>g<span class="vimFuncBody">:</span>keyboard_s<span class="Statement">=</span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">keyboard_leading_zero</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3769 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>g<span class="vimFuncBody">:</span>keyboard_a<span class="Statement">=</span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3770 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3771 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3772 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3773 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3774 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">str2nr</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">!=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3775 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">keyboard_leading_zero</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3776 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3777 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3778 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'\p'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3779 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">''</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3780 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3781 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3782 </span><span class="Comment">    &quot; hunt real easter egg ... vim&lt;C-\&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3783 </span><span class="Comment">    &quot; ---------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3784 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~#</span><span class="vimFuncBody"> </span><span class="Constant">&quot;vim&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3785 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_easter_egg<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3786 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3787 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3788 </span><span class="Comment">    &quot; support direct internal code (unicode/gb/big5) input</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3789 </span><span class="Comment">    &quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3790 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_internal_code_input</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3791 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>unicodes<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_internal_code<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3792 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>unicodes<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3793 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>unicode_menu_display_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3794 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>unicodes<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3795 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3796 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3797 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3798 </span><span class="Comment">    &quot; magic 'i': English number =&gt; Chinese number</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3799 </span><span class="Comment">    &quot; -------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3800 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3801 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">a:keyboard</span><span class="vimFuncBody"> </span><span class="Statement">=~?</span><span class="vimFuncBody"> </span><span class="Constant">'^i'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3802 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3803 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>itoday_inow<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_date_time<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3804 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>itoday_inow<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3805 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>itoday_inow
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3806 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3807 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>chinese_numbers<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_chinese_number<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3808 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>chinese_numbers<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3809 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span><span class="Identifier">map</span><span class="Statement">(</span>chinese_numbers, <span class="Constant">'keyboard .&quot; &quot;. v:val'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3810 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>chinese_numbers<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3811 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3812 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3813 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3814 </span><span class="Comment">    &quot; support 5 major ShuangPin with various rules</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3815 </span><span class="Comment">    &quot; --------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3816 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">pinyin_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3817 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:shuangpin_in_quanpin<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3818 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>msg<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">'enter shuangpin for the first time'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3819 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>s:shuangpin_in_quanpin, keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3820 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3821 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3822 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3823 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3824 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">shuangpin_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3825 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard2<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_shuangpin_transform<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3826 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard2<span class="vimFuncBody"> </span><span class="Statement">!=#</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3827 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>keyboard2
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3828 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3829 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>shuangpin_in_quanpin<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3830 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_leading_zero<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3831 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3832 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3833 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3834 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3835 </span><span class="Comment">    &quot; VimIM </span><span class="Constant">&quot;modeless&quot;</span><span class="Comment"> whole sentence input: 【我有一個夢】</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3836 </span><span class="Comment">    &quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3837 </span><span class="Comment">    &quot;</span>    <span class="PreProc">English Input Method:</span><span class="Comment">  i have a dream.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3838 </span><span class="Comment">    &quot;</span>    <span class="PreProc">PinYin Input Method:</span><span class="Comment">   wo you yige meng.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3839 </span><span class="Comment">    &quot;</span>    <span class="PreProc">Wubi Input Method:</span><span class="Comment">     trde ggwh ssqu.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3840 </span><span class="Comment">    &quot;</span>    <span class="PreProc">Cangjie Input Method:</span><span class="Comment">  hqi kb m ol ddni.</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3841 </span><span class="Comment">    &quot; ----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3842 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3843 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_sentence_input</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3844 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">3</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3845 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'\s'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3846 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_sentence_input<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3847 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>keyboard,<span class="Constant">'\s'</span><span class="vimOperParen">,</span><span class="Constant">'.'</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3848 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">strpart</span><span class="Statement">(</span>keyboard,<span class="Constant">0</span><span class="vimOperParen">,len</span><span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)-</span><span class="Constant">1</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3849 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_leading_zero<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3850 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3851 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3852 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3853 </span><span class="Comment">    &quot; cloud-dependent whole sentence input: woyouyigemeng</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3854 </span><span class="Comment">    &quot; ---------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3855 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">2</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span><span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'[.]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3856 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_www_sogou<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3857 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>msg<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;who care about cloud?&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3858 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">'\d\d\d\d'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3859 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>msg<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;We play 4 corner by ourselves without Cloud.&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3860 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_www_sogou</span><span class="vimFuncBody"> </span><span class="Statement">&lt;=</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3861 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboard_leading_zero<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3862 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_get_sogou_cloud_im<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3863 </span>            <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>results<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3864 </span>                <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_pair_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3865 </span>                <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3866 </span>            <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3867 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3868 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3869 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3870 </span><span class="Comment">    &quot; initialize omni completion function</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3871 </span><span class="Comment">    &quot; -----------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3872 </span>    <span class="Statement">let</span><span class="vimFuncBody"> &amp;</span>pumheight<span class="Statement">=</span><span class="Constant">9</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3873 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>insert_without_popup_flag<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3874 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>vimim_sentence_input<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3875 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3876 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3877 </span><span class="Comment">    &quot; [erbi] the first ,./;' is punctuation</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3878 </span><span class="Comment">    &quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3879 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">erbi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3880 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">len</span><span class="Statement">(</span>keyboard<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=~</span><span class="vimFuncBody"> </span><span class="Constant">&quot;[,./;']&quot;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3881 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">has_key</span><span class="Statement">(</span>s:punctuations_all, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3882 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>value<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">punctuations_all</span><span class="vimFuncBody">[</span><span class="vimIsCommand">keyboard</span><span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3883 </span>        <span class="Statement">return</span><span class="vimFuncBody"> [</span>value<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3884 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3885 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3886 </span><span class="Comment">    &quot; Now, reset and build valid keyboard characters</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3887 </span><span class="Comment">    &quot; ----------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3888 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3889 </span><span class="Special">    \</span><span class="Statement">||</span> keyboard<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">valid_key</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3890 </span><span class="Special">    \</span><span class="Statement">||</span> <span class="Statement">(</span>len<span class="Statement">(</span><span class="vimOperParen">keyboard</span><span class="Statement">)&lt;</span><span class="Constant">2</span><span class="vimOperParen"> </span><span class="Statement">&amp;&amp;</span><span class="vimOperParen"> keyboard </span><span class="Statement">=~</span><span class="vimOperParen"> </span><span class="Constant">&quot;[.*]&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3891 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3892 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3893 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3894 </span><span class="Comment">    &quot; support wubi non-stop input</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3895 </span><span class="Comment">    &quot; ---------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3896 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">wubi_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3897 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_wubi<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3898 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>results<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3899 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_pair_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3900 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3901 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3902 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3903 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3904 </span><span class="Comment">    &quot; datafile update: modify data in memory based on past usage</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3905 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3906 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_save_input_history_frequency</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3907 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_new_order_in_memory<span class="Statement">(</span>s:keyboards<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3908 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3909 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_load_datafile<span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3910 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3911 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_update_datafile<span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3912 </span>            <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_save_input_history<span class="Statement">(</span>lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3913 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3914 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3915 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3916 </span><span class="Comment">    &quot; now only play with portion of datafile of interest</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3917 </span><span class="Comment">    &quot; --------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3918 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>lines<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_datafile_range<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3919 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3920 </span><span class="Comment">    &quot; first process private data, if existed</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3921 </span><span class="Comment">    &quot; --------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3922 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">privates_flag</span><span class="vimFuncBody"> </span><span class="Statement">==</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3923 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">len</span><span class="Statement">(</span>s:privates_datafile<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3924 </span><span class="Special">    \</span><span class="Statement">&amp;&amp;</span> keyboard<span class="vimFuncBody"> </span><span class="Statement">!~</span><span class="vimFuncBody"> </span><span class="Constant">'[.?*]'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3925 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_search_vimim_privates<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3926 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>results<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3927 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>private_matches<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">results</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3928 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3929 </span>     <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3930 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3931 </span><span class="Comment">    &quot; return nothing if no single datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3932 </span><span class="Comment">    &quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3933 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>lines<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span><span class="vimOperParen">s:private_matches</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3934 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3935 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3936 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3937 </span><span class="Comment">    &quot; do wildcard search: explicit fuzzy search</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3938 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3939 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_wildcard_search</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3940 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_wildcard_search<span class="Statement">(</span>keyboard, lines<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3941 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>results<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3942 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_pair_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3943 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3944 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3945 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3946 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3947 </span><span class="Comment">    &quot; escape literal dot if Array/Phonetic/Erbi</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3948 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3949 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">current_datafile_has_dot</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3950 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">substitute</span><span class="Statement">(</span>keyboard,<span class="Constant">'\.'</span><span class="vimOperParen">,</span><span class="Constant">'\\.'</span><span class="vimOperParen">,</span><span class="Constant">'g'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3951 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3952 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3953 </span><span class="Comment">    &quot; now it is time to do regular expression matching</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3954 </span><span class="Comment">    &quot; ------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3955 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;</span><span class="Constant">\\</span><span class="Constant">C&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;^&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3956 </span>    <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3957 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3958 </span><span class="Comment">    &quot; to support auto_spell, if needed</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3959 </span><span class="Comment">    &quot; --------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3960 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3961 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_auto_spell<span class="Statement">(</span>lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3962 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3963 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3964 </span><span class="Comment">    &quot; assume it is hex unicode if no match for 4 corner</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3965 </span><span class="Comment">    &quot; -------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3966 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3967 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_hex_unicode<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3968 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>results<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3969 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3970 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3971 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3972 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3973 </span><span class="Comment">    &quot; word matching algorithm for Chinese word segmentation</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3974 </span><span class="Comment">    &quot; -----------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3975 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3976 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard2<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_keyboard_analysis<span class="Statement">(</span>lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3977 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>keyboard2<span class="vimFuncBody"> </span><span class="Statement">!=#</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3978 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>keyboard2
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3979 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>pattern<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Constant">&quot;</span><span class="Constant">\\</span><span class="Constant">C&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">&quot;^&quot;</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span>keyboard
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3980 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>lines, pattern<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3981 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3982 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3983 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3984 </span><span class="Comment">    &quot; try </span><span class="Constant">&quot;do it yourself&quot;</span><span class="Comment"> couple input method: pinyin+4corner</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3985 </span><span class="Comment">    &quot; --------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3986 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_diy_pinyin_4corner</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3987 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboard2<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_keyboard2number<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3988 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>keyboards<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_keyboard<span class="Statement">(</span>keyboard2<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3989 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>mixtures<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_diy_results<span class="Statement">(</span>keyboards<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3990 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>mixtures<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3991 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>mixtures<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3992 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3993 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3994 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3995 </span><span class="Comment">    &quot; do exact match search on sorted datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3996 </span><span class="Comment">    &quot; ----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3997 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3998 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> []</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">3999 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>has_digit<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="Identifier">match</span><span class="Statement">(</span>keyboard, <span class="Constant">'\d\+'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4000 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>has_digit<span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Statement">-</span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4001 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> s<span class="vimFuncBody">:</span><span class="vimIsCommand">four_corner_flag</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4002 </span><span class="Special">        \</span><span class="Statement">&amp;&amp;</span> <span class="Identifier">len</span><span class="Statement">(</span>keyboards<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">1</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4003 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_quick_fuzzy_search<span class="Statement">(</span>keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4004 </span>        <span class="Statement">else</span><span class="vimFuncBody"> |&quot; [</span><span class="Statement">normal</span>] do fine tunning exact match
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4005 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span>keyboards<span class="vimFuncBody">[</span><span class="Constant">0</span><span class="vimFuncBody">] </span><span class="Statement">=</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4006 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_exact_match<span class="Statement">(</span>lines,keyboard,match_start<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4007 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4008 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_pair_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4009 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4010 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4011 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4012 </span><span class="Comment">    &quot; do fuzzy search: implicit wildcard search</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4013 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4014 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="vimIsCommand">s</span><span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_fuzzy_search</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4015 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_fuzzy_match<span class="Statement">(</span>lines, keyboard<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4016 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>results<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4017 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_pair_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4018 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4019 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4020 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4021 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4022 </span><span class="Comment">    &quot; only return matches from private datafile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4023 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4024 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">len</span><span class="Statement">(</span>s:private_matches<span class="Statement">)</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4025 </span>        <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>s:vimim_pair_list<span class="Statement">(</span>[]<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4026 </span>        <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4027 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4028 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4029 </span><span class="Comment">    &quot; support seamless English input for OneKey</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4030 </span><span class="Comment">    &quot; -----------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4031 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>match_start<span class="vimFuncBody"> </span><span class="Statement">&lt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4032 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:chinese_input_mode<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4033 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>narcissism<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> </span>keyboard<span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">' '</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="vimIsCommand">keyboard</span><span class="vimFuncBody"> </span><span class="Statement">.</span><span class="vimFuncBody"> </span><span class="Constant">'　'</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4034 </span>            <span class="Statement">let</span><span class="vimFuncBody"> </span>results<span class="vimFuncBody"> </span><span class="Statement">=</span><span class="vimFuncBody"> [</span>narcissism<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4035 </span>            <span class="Statement">return</span><span class="vimFuncBody"> </span>s:vimim_popupmenu_list<span class="Statement">(</span>results<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4036 </span>        <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4037 </span>            <span class="Statement">sil</span><span class="vimFuncBody">!</span><span class="Statement">call</span><span class="vimFuncBody"> </span>g:vimim_set_seamless<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4038 </span>            <span class="Statement">return</span><span class="vimFuncBody"> [</span>keyboard<span class="vimFuncBody">]</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4039 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4040 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4041 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4042 </span><span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4043 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4044 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold23")'>| </a><span class="lnr">4045 </span><span class="Comment">&quot; ================================ }}}</span>
</span></span><span id='fold24' class='closed-fold'><a class='toggle-open FoldColumn' href='javascript:toggleFold("fold24")'>+ </a><a class='toggle-closed FoldColumn' href='javascript:toggleFold("fold24")'>- </a><span class="Folded">4046 +-- 76 lines: ====  VimIM Core Drive      ====
</span><span class='fulltext'><span class="lnr">4046 </span><span class="Comment">&quot; ====  VimIM Core Drive      ==== {{{</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4047 </span><span class="Comment">&quot; ====================================</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4048 </span><span class="Comment">&quot; profile start /tmp/vimim.profile</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4049 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4050 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4051 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_initialize_mapping</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4052 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4053 </span>    <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;&lt;</span><span class="Special">expr</span><span class="Special">&gt;&lt;</span><span class="Special">Plug</span><span class="Special">&gt;</span>VimimOneKey <span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span><span class="vimMapRhs">vimim_onekey()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4054 </span>    <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;&lt;</span><span class="Special">expr</span><span class="Special">&gt;&lt;</span><span class="Special">Plug</span><span class="Special">&gt;</span>VimimChineseToggle <span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span><span class="vimMapRhs">vimim_toggle()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4055 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4056 </span>    <span class="Statement">call</span><span class="vimFuncBody"> </span>s:vimim_one_key_mapping_on<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4057 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4058 </span>    <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">hasmapto</span><span class="Statement">(</span><span class="Constant">'&lt;C-^&gt;'</span>, <span class="Constant">'v'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4059 </span>        <span class="Statement">xnoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">C-^</span><span class="Special">&gt;</span> y:'&gt;put=<span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span><span class="vimMapRhs">vimim_vCTRL6(@0)</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4060 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4061 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4062 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_save_new_entry</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> !</span><span class="Identifier">hasmapto</span><span class="Statement">(</span><span class="Constant">'&lt;C-\&gt;'</span>, <span class="Constant">'v'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4063 </span>        <span class="Statement">xnoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">C-</span><span class="Special">\&gt;</span> :y<span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span><span class="vimMapRhs">:call </span><span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span><span class="vimMapRhs">vimim_save(@0)</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4064 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4065 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4066 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4067 </span>        <span class="Statement">imap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">C-^</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">Plug</span><span class="Special">&gt;</span><span class="vimMapRhs">VimimChineseToggle</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4068 </span>    <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_one_key</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4069 </span>        <span class="Statement">imap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">C-^</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">Plug</span><span class="Special">&gt;</span><span class="vimMapRhs">VimimOneKey</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4070 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4071 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4072 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_ctrl_space_as_ctrl_6</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span><span class="vimFuncBody"> </span><span class="Statement">&amp;&amp;</span><span class="vimFuncBody"> </span><span class="Identifier">has</span><span class="Statement">(</span><span class="Constant">&quot;gui_running&quot;</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4073 </span>        <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_chinese_input_mode</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4074 </span>            <span class="Statement">imap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">C-Space</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">Plug</span><span class="Special">&gt;</span><span class="vimMapRhs">VimimChineseToggle</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4075 </span>        <span class="Statement">elseif</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_one_key</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4076 </span>            <span class="Statement">imap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">C-Space</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">Plug</span><span class="Special">&gt;</span><span class="vimMapRhs">VimimOneKey</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4077 </span>        <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4078 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4079 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4080 </span>    <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="Special">&lt;</span><span class="Special">BS</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">C-R</span><span class="Special">&gt;</span><span class="vimMapRhs">=</span><span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span><span class="vimMapRhs">vimim_smart_backspace()</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4081 </span><span class="Special">                        \</span>&lt;C-R&gt;=&lt;SID&gt;vimim_ctrl_x_ctrl_u_bs()&lt;CR&gt;
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4082 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4083 </span>    <span class="Statement">if</span><span class="vimFuncBody"> !</span><span class="Identifier">hasmapto</span><span class="Statement">(</span><span class="Constant">'&lt;C-H&gt;'</span>, <span class="Constant">'i'</span><span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4084 </span>        <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="Special">&lt;</span><span class="Special">C-H</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">C-R</span><span class="Special">&gt;</span><span class="vimMapRhs">=</span><span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span><span class="vimMapRhs">vimim_smart_ctrl_h()</span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4085 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4086 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4087 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span>s<span class="vimFuncBody">:</span><span class="vimIsCommand">vimim_english_input_on_enter</span><span class="vimFuncBody"> </span><span class="Statement">&gt;</span><span class="vimFuncBody"> </span><span class="Constant">0</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4088 </span>        <span class="Statement">inoremap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;&lt;</span><span class="Special">expr</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">CR</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">SID</span><span class="Special">&gt;</span><span class="vimMapRhs">smart_enter()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4089 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4090 </span><span class="Comment">    &quot; ----------------------------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4091 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4092 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4093 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4094 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_one_key_mapping_on</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4095 </span><span class="Comment">&quot; ------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4096 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_one_key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4097 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4098 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4099 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_tab_for_one_key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4100 </span>        <span class="Statement">imap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">C-</span><span class="Special">\&gt;</span> <span class="Special">&lt;</span><span class="Special">Plug</span><span class="Special">&gt;</span><span class="vimMapRhs">VimimOneKey</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4101 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4102 </span>        <span class="Statement">imap</span><span class="Special">&lt;</span><span class="Special">silent</span><span class="Special">&gt;</span><span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">Tab</span><span class="Special">&gt;</span> <span class="Special">&lt;</span><span class="Special">Plug</span><span class="Special">&gt;</span><span class="vimMapRhs">VimimOneKey</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4103 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4104 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4105 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4106 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4107 </span><span class="Statement">function</span>! <span class="Special">s:</span><span class="vimFunction">vimim_one_key_mapping_off</span><span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4108 </span><span class="Comment">&quot; -------------------------------------</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4109 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_one_key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4110 </span>        <span class="Statement">return</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4111 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4112 </span>    <span class="Statement">if</span><span class="vimFuncBody"> </span><span class="Identifier">empty</span><span class="Statement">(</span>s:vimim_tab_for_one_key<span class="Statement">)</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4113 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span>iunmap<span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">C-</span><span class="Special">\&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4114 </span>    <span class="Statement">else</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4115 </span>        <span class="Statement">sil</span><span class="vimFuncBody">!</span>iunmap<span class="vimFuncBody"> </span><span class="Special">&lt;</span><span class="Special">Tab</span><span class="Special">&gt;</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4116 </span>    <span class="Statement">endif</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4117 </span><span class="Statement">endfunction</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4118 </span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4119 </span><span class="Statement">silent</span>!<span class="Statement">call</span><span class=""> </span>s:vimim_initialization<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4120 </span><span class="Statement">silent</span>!<span class="Statement">call</span><span class=""> </span>s:vimim_initialize_mapping<span class="Statement">()</span>
<a class='FoldColumn' href='javascript:toggleFold("fold24")'>| </a><span class="lnr">4121 </span><span class="Comment">&quot; ====================================== }}}</span>
</span></span></pre>
</body>
</html>
